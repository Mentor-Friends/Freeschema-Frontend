var e={1735:(e,t,n)=>{n.d(t,{J:()=>s});var o,i=n(2830),r=n(3278),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class s{static incrementConcept(e){try{e&&(this.conceptsData[e]=(this.conceptsData[e]||0)+1)}catch(e){console.error("Failed on increment concept")}}static incrementConnection(e){try{e&&(this.connectionsData[e]=(this.connectionsData[e]||0)+1)}catch(e){console.error("Failed on increment connection")}}static getTopConcepts(e){return Object.entries(this.conceptsData).map((([e,t])=>[parseInt(e),t])).sort(((e,t)=>t[1]-e[1])).slice(0,e)}static getTopConnections(e){return Object.entries(this.connectionsData).map((([e,t])=>[parseInt(e),t])).sort(((e,t)=>t[1]-e[1])).slice(0,e)}static saveDataToLocalStorage(){const e={concepts:this.conceptsData,connections:this.connectionsData};null===localStorage||void 0===localStorage||localStorage.setItem(this.accessData,JSON.stringify(e))}static loadDataFromLocalStorage(){const e=null===localStorage||void 0===localStorage?void 0:localStorage.getItem(this.accessData);if(e){const t=JSON.parse(e);this.conceptsData=t.concepts||{},this.connectionsData=t.connections||{}}}static sendToServer(){return c(this,void 0,void 0,(function*(){try{yield this.syncToServer()}catch(e){console.error("Failed to process Access Tracker Sync with Server")}}))}static syncToServer(){return c(this,void 0,void 0,(function*(){try{if(!Object.keys(this.conceptsData).length&&!Object.keys(this.connectionsData).length)return;const e=r.b.BearerAccessToken;if(!e)return;const t=this.conceptsData&&Object.keys(this.conceptsData).length>0?this.conceptsData:{},n=this.connectionsData&&Object.keys(this.connectionsData).length>0?this.connectionsData:{},o=yield fetch(i.BaseUrl.PostPrefetchConceptConnections(),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({concepts:t,connections:n})});if(!o.ok)throw new Error("Failed to sync data to the server.");yield o.json(),this.conceptsData={},this.connectionsData={},this.setNextSyncTime()}catch(e){console.error("Sync error:",e)}}))}static setNextSyncTime(){this.nextSyncTime=Date.now()+this.SYNC_INTERVAL_MS}static startAutoSync(){setInterval((()=>{const e=Date.now();this.nextSyncTime&&e>=this.nextSyncTime&&this.syncNow().catch(console.error)}),6e4)}static syncNow(){return c(this,void 0,void 0,(function*(){try{this.activateStatus?yield this.syncToServer():console.warn("Access Tracker inactive.")}catch(e){console.error("Error on sync access tracker")}}))}static GetSuggestedConcepts(e){return c(this,void 0,void 0,(function*(){try{const t=r.b.BearerAccessToken,n=new URL(i.BaseUrl.GetSuggestedConcepts());void 0!==e&&n.searchParams.append("top",e.toString());const o=yield fetch(n.toString(),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!o.ok){const e=yield o.text();throw new Error(`Failed to load concepts: ${o.status} ${o.statusText}. Details: ${e}`)}const c=(yield o.json())||[];return yield this.addConceptToBinaryTree(c.data),c}catch(e){throw e instanceof Error?(console.error("Error fetching suggested concepts:",e.message),new Error("Unable to fetch suggested concepts. Please try again later.")):(console.error("An unexpected error occurred:",e),new Error("An unexpected error occurred while fetching suggested concepts."))}}))}static GetSuggestedConnections(e){return c(this,void 0,void 0,(function*(){try{const t=r.b.BearerAccessToken,n=new URL(i.BaseUrl.GetSuggestedConnections());void 0!==e&&n.searchParams.append("top",e.toString());const o=yield fetch(n.toString(),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!o.ok){const e=yield o.text();throw new Error(`Failed to load connections: ${o.status} ${o.statusText}. Details: ${e}`)}const c=(yield o.json())||[];return yield this.addConnectionToBinaryTree(c.data),c}catch(e){throw e instanceof Error?(console.error("Error fetching suggested Connections:",e.message),new Error("Unable to fetch suggested connections. Please try again later.")):(console.error("An unexpected error occurred:",e),new Error("An unexpected error occurred while fetching suggested Connections."))}}))}static addConceptToBinaryTree(e){return c(this,void 0,void 0,(function*(){try{e.forEach((e=>{i.ConceptsData.AddConcept(e)}))}catch(e){console.error("Error on adding Concepts Data into tree")}}))}static addConnectionToBinaryTree(e){return c(this,void 0,void 0,(function*(){try{e.forEach((e=>{i.ConnectionData.AddConnection(e)}))}catch(e){console.error("Error on adding Connections Data into tree")}}))}}o=s,s.conceptsData={},s.connectionsData={},s.SYNC_INTERVAL_MS=12e4,s.nextSyncTime=Date.now(),s.activateStatus=!1,s.accessData="Access Data",o.startAutoSync()},1167:(e,t,n)=>{n.d(t,{Y:()=>a});var o=n(9581),i=n(3518),r=n(2830),c=n(1863),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e){return s(this,void 0,void 0,(function*(){const t=r.Logger.logfunction("CreateTheConceptApi",e);let n=(0,r.CreateDefaultConcept)();try{var s=(0,i.Xr)();const a=yield fetch(o.B.CreateTheConceptUrl(),{method:"POST",headers:s,body:JSON.stringify(e)});if(!a.ok)throw(0,c.ry)(a),new Error(`Error! status: ${a.status}`);return n=yield a.json(),r.Logger.logUpdate(t),n}catch(e){e instanceof Error?console.log("Create the concept api error message: ",e.message):console.log("Create the concept api unexpected error: ",e),(0,c.Mb)(e,o.B.CreateTheConceptUrl()),(0,c.ey)(t,"CreateTheConceptApi",e)}}))}},2:(e,t,n)=>{n.d(t,{s:()=>d});var o=n(8286),i=n(9581),r=n(1412),c=n(3518),s=n(1863),a=n(2830),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e){var t=arguments;return l(this,void 0,void 0,(function*(){const n=a.Logger.logfunction("GetAllConnectionsOfComposition",t);var i=[];if(0==(i=yield o.d.GetConnectionsOfConcept(e)).length)i=yield u(e);else{var c=yield u(e);(0,r.e)(c,i),i=c}return a.Logger.logUpdate(n),i}))}function u(e){var t=arguments;return l(this,void 0,void 0,(function*(){const n=a.Logger.logfunction("GetAllConnectionsOfCompositionOnline",t);var r=[];try{(0,c.Xr)("application/json");const t=new Headers,d=new FormData;d.append("composition_id",e.toString());const u=yield fetch(i.B.GetAllConnectionsOfCompositionUrl(),{method:"POST",headers:t,body:d});if(console.log("this is getting connection from online",i.B.GetAllConnectionsOfCompositionUrl(),e),!u.ok)throw(0,s.ry)(u),new Error(`Error! status: ${u.status}`);const h=yield u.json();for(var l=0;l<h.length;l++)o.d.AddConnection(h[l]),r.push(h[l]);return a.Logger.logUpdate(n),r}catch(e){e instanceof Error?console.log("Get all connection of composition error : ",e.message):console.log("Get all connection of composition error : ",e),(0,s.Mb)(e,i.B.GetAllConnectionsOfCompositionUrl()),(0,s.ey)(n,"GetAllConnectionsOfCompositionOnline",e)}}))}},8642:(e,t,n)=>{n.d(t,{Y:()=>h});var o=n(8286),i=n(9581),r=n(4364),c=n(5284),s=n(1412),a=n(3518),l=n(1863),d=n(2830),u=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function h(){var e=arguments;return u(this,arguments,void 0,(function*(t=[]){const n=d.Logger.logfunction("GetAllConnectionsOfCompositionBulk",e);if(d.serviceWorker){n.serviceWorker=!0;try{const e=yield(0,d.sendMessage)("GetAllConnectionsOfCompositionBulk",{composition_ids:t});return d.Logger.logUpdate(n),e.data}catch(e){console.error("GetAllConnectionsOfCompositionBulk sw error: ",e),(0,l.ey)(n,"GetAllConnectionsOfCompositionBulk",e),(0,d.handleServiceWorkerException)(e)}}var h=[];if(t.length<=0)return h;var p=yield(0,c.B)(t),f=yield function(){var e=arguments;return u(this,arguments,void 0,(function*(t=[]){const n=d.Logger.logfunction("GetAllConnectionsOfCompositionOnline",e);var r=[];try{var c=(0,a.Xr)();const e=yield fetch(i.B.GetAllConnectionsOfCompositionBulkUrl(),{method:"POST",headers:c,body:JSON.stringify(t)});if(e.ok){const t=yield e.json();for(var s=0;s<t.length;s++)o.d.AddConnection(t[s]),r.push(t[s])}else console.log("Get all connections of composition bulk error message: ","Cannot get response"),(0,l.ry)(e);return d.Logger.logUpdate(n),r}catch(e){e instanceof Error?console.log("Get all connections of composition bulk error message: ",e.message):console.log("Get all connections of composition bulk unexpected error: ",e),(0,l.Mb)(e,i.B.GetAllConnectionsOfCompositionBulkUrl()),(0,l.ey)(n,"GetAllConnectionsOfCompositionOnline",e)}}))}(t);return h=f,(0,s.e)(h,p),yield(0,r.s)(h),d.Logger.logUpdate(n),h}))}},2803:(e,t,n)=>{n.d(t,{x:()=>a});var o=n(8286),i=n(9581),r=n(1863),c=n(2830),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e,t,n){var a=arguments;return s(this,void 0,void 0,(function*(){const s=c.Logger.logfunction("GetCompositionConnectionsBetweenTwoConcepts",a);var l=[];try{if(c.serviceWorker){s.serviceWorker=!0;try{const o=yield(0,c.sendMessage)("GetCompositionConnectionsBetweenTwoConcepts",{ofConceptId:e,toConcept:t,mainKey:n});return c.Logger.logUpdate(s),o.data}catch(e){console.error("GetCompositionConnectionsBetweenTwoConcepts sw error: ",e),(0,r.ey)(s,"GetCompositionConnectionsBetweenTwoConcepts",e),(0,c.handleServiceWorkerException)(e)}}var d=new FormData;d.append("ofConceptId",e.toString()),d.append("mainKey",n.toString()),d.append("toConceptId",t.toString());const a=yield fetch(i.B.GetCompositionConnectionBetweenTwoConceptsUrl(),{method:"POST",body:d,redirect:"follow"});if(a.ok){const e=yield a.json();for(var u=0;u<e.length;u++)o.d.AddConnection(e[u]),l.push(e[u]);c.Logger.logUpdate(s)}else console.log("Get composition connection between two concepts",a.status),(0,r.ry)(a)}catch(e){e instanceof Error?console.log("Get composition connection between two concepts error message: ",e.message):console.log("Get composition connection between two concepts unexpected error: ",e),(0,r.Mb)(e,i.B.GetCompositionConnectionBetweenTwoConceptsUrl()),(0,r.ey)(s,"GetCompositionConnectionsBetweenTwoConcepts",e)}return l}))}},7139:(e,t,n)=>{n.d(t,{r:()=>l});var o=n(9639),i=n(9581),r=n(3518),c=n(2830),s=n(1863),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e){var t=arguments;return a(this,void 0,void 0,(function*(){const n=c.Logger.logfunction("GetConcept",t);try{if(c.serviceWorker){n.serviceWorker=!0;try{const t=yield(0,c.sendMessage)("GetConcept",{id:e});return c.Logger.logUpdate(n),t.data}catch(e){console.error("GetConcept sw error: ",e),(0,s.ey)(n,"GetConcept",e),(0,c.handleServiceWorkerException)(e)}}let t=(0,c.CreateDefaultConcept)();if(0==e||null==e||null==e)return t;var a=yield o.I.GetConcept(e);let l=o.I.GetNpc(e);if(0!=a.id||l)return c.Logger.logUpdate(n),a;{(0,r.Xr)(),console.log("this is the url",i.B.GetConceptUrl());const a=new FormData;a.append("id",e.toString());const l=yield fetch(i.B.GetConceptUrl(),{method:"POST",body:a});return l.ok?(t=yield l.json(),t.id>0?o.I.AddConcept(t):o.I.AddNpc(e)):(console.log("Get the concept error",l.status),(0,s.ry)(l)),c.Logger.logUpdate(n),t}}catch(e){e instanceof Error?console.log("Get the concept error message: ",e.message):console.log("Get the concept unexpected error: ",e),(0,s.Mb)(e,i.B.GetConceptUrl()),(0,s.ey)(n,"GetConcept",e)}}))}},1239:(e,t,n)=>{n.d(t,{I:()=>d,r:()=>l});var o=n(9639),i=n(9581),r=n(3518),c=n(1863),s=n(2830),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e){return a(this,void 0,void 0,(function*(){const t=s.Logger.logfunction("GetConceptBulk",[e.length]);let n=[],a=((new Date).getTime(),performance.now()),l=Array.from(new Set(e));try{if(s.serviceWorker){t.serviceWorker=!0;try{const n=yield(0,s.sendMessage)("GetConceptBulk",{passedConcepts:e});return s.Logger.logUpdate(t),n.data}catch(e){console.error("GetConceptBulk sw error: ",e),(0,c.ey)(t,"GetConceptBulk",e),(0,s.handleServiceWorkerException)(e)}}if(l.length>0){let d=[];for(let e=0;e<l.length;e++)0==(yield o.I.GetConcept(l[e])).id&&d.push(l[e]);if(0==d.length)return s.Logger.logfunction(t),n;{let l=(0,r.Xr)();const u=yield fetch(i.B.GetConceptBulkUrl(),{method:"POST",headers:l,body:JSON.stringify(d)});if(u.ok){if(n=yield u.json(),n.length>0)for(let e=0;e<n.length;e++){let t=n[e];o.I.AddConcept(t)}console.log("added the concepts"),s.Logger.logUpdate(t)}else console.log("Get Concept Bulk error",u.status),s.Logger.logError(a,"unknown","read","unknown",void 0,u.status,u,"GetConceptBulk",[e],"unknown",void 0),(0,c.ry)(u)}}}catch(n){n instanceof Error?console.log("Get Concept Bulk  error message: ",n.message):console.log("Get Concept Bulk  unexpected error: ",n),s.Logger.logError(a,"unknown","read","unknown",void 0,500,n,"GetConceptBulk",[e],"unknown",void 0),(0,c.Mb)(n,i.B.GetConceptBulkUrl()),(0,c.ey)(t,"GetConceptBulk",n)}return n}))}function d(e){return a(this,void 0,void 0,(function*(){const t=[];if(e.length>0){const n={"Content-Type":"application/json"};try{const r=yield fetch(i.B.GetConceptBulkUrl(),{method:"POST",headers:n,body:JSON.stringify(e)});if(r.ok){const e=yield r.json();if(e.length>0)for(let n=0;n<e.length;n++){const i=e[n];t.push(i),o.I.AddConcept(i)}}else console.log("bulk concept getter api error: ",r.status),(0,c.ry)(r)}catch(e){e instanceof Error?console.log("bulk concept getter api error: ",e.message):console.log("bulk concept getter api error: ",e),(0,c.Mb)(e,i.B.GetConceptBulkUrl())}}return t}))}},4402:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(9639),i=n(9581),r=n(3518),c=n(1863),s=n(2830),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e,t){var n=arguments;return a(this,void 0,void 0,(function*(){const a=s.Logger.logfunction("GetConceptByCharacterAndType",n);try{if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetConceptByCharacterAndType",{characterValue:e,typeId:t})).data}catch(e){console.error("GetConceptByCharacterAndType sw error: ",e),(0,s.handleServiceWorkerException)(e)}let n=yield o.I.GetConceptByCharacterAndTypeLocal(e,t);if(null==n||0==n.id){var l={character_value:`${e}`,type_id:t},d=JSON.stringify(l),u=(0,r.Xr)();const s=yield fetch(i.B.GetConceptByCharacterAndTypeUrl(),{method:"POST",headers:u,body:d});s.ok?(n=yield s.json(),o.I.AddConcept(n)):((0,c.ry)(s),console.log("This is the concept by type and character error",s.status))}return s.Logger.logUpdate(a),n}catch(e){e instanceof Error?console.log(" This is the concept by type and character error message: ",e.message):console.log(" This is the concept by type and character unexpected error: ",e),(0,c.Mb)(e,i.B.GetConceptByCharacterAndTypeUrl()),(0,c.ey)(a,"GetConceptByCharacterAndType",e)}}))}},8146:(e,t,n)=>{n.d(t,{Y:()=>a});var o=n(9639),i=n(9581),r=n(2830),c=n(1863),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e){var t=arguments;return s(this,void 0,void 0,(function*(){const n=r.Logger.logfunction("GetConceptByCharacterValue",t);let s=(0,r.CreateDefaultConcept)();try{const t=new FormData;t.append("character_value",e);const a=yield fetch(i.B.GetConceptByCharacterValueUrl(),{method:"POST",body:t});a.ok?(s=yield a.json(),s.id>0&&o.I.AddConcept(s),r.Logger.logUpdate(n)):((0,c.ry)(a),console.log("Error in Getting concept by character value Error",a.status))}catch(e){e instanceof Error?console.log("Error in Getting concept by character value error message: ",e):console.log("Error in Getting concept by character value unexpected error: ",e),(0,c.Mb)(e,i.B.GetConceptByCharacterValueUrl()),(0,c.ey)(n,"GetConceptByCharacterValue",e)}return s}))}},7467:(e,t,n)=>{n.d(t,{j:()=>d});var o=n(8286),i=n(9581),r=n(4364),c=n(3518),s=n(1863),a=n(2830),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(){return l(this,arguments,void 0,(function*(e=[]){const t=a.Logger.logfunction("GetConnectionBulk",e.length);let n=[];try{if(a.serviceWorker){t.serviceWorker=!0;try{const n=yield(0,a.sendMessage)("GetConnectionBulk",{connectionIds:e});return a.Logger.logUpdate(t),n.data}catch(e){console.error("GetConnectionBulk sw error: ",e),(0,s.ey)(t,"GetConnectionBulk",e),(0,a.handleServiceWorkerException)(e)}}if(e.length>0){let r=[];for(let t=0;t<e.length;t++){let i=yield o.d.GetConnection(e[t]);0==i.id?r.push(e[t]):n.push(i)}if(0==r.length)return a.Logger.logUpdate(t),n;{let e=(0,c.Xr)();const l=yield fetch(i.B.GetConnectionBulkUrl(),{method:"POST",headers:e,body:JSON.stringify(r)});if(l.ok){const e=yield l.json();if(e.length>0)for(let t=0;t<e.length;t++){let i=e[t];n.push(i),o.d.AddConnection(i)}}else(0,s.ey)(t,"GetConnectionBulk",l.status),(0,s.ry)(l),console.log("Get Connection Bulk error",l.status);a.Logger.logUpdate(t)}}}catch(e){e instanceof Error?console.log("Get Connection Bulk error message: ",e):console.log("Get Connection Bulk unexpected error: ",e),(0,s.ey)(t,"GetConnectionBulk",e),(0,s.Mb)(e,i.B.GetConnectionBulkUrl())}return yield(0,r.s)(n),n}))}},2832:(e,t,n)=>{n.d(t,{j:()=>a});var o=n(2830),i=n(9581),r=n(1863),c=n(3518),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e){var t=arguments;return s(this,arguments,void 0,(function*(e,n=""){const s=o.Logger.logfunction("SearchLinkMultipleApi",t);let a=performance.now();var l=(0,c.ab)("application/json",n);const d=i.B.SearchLinkMultipleAllApiUrl(),u=JSON.stringify(e);try{const t=yield fetch(d,{method:"POST",headers:l,body:u});if(t.ok){let e=yield t.json();return o.Logger.logUpdate(s),e}return(0,r.ry)(t),console.log("This is the searching multiple error",t.status),o.Logger.logError(a,"unknown","search","unknown",void 0,t.status,t,"SearchLinkMultipleApi",[e,n],"unknown",void 0),[]}catch(t){console.log("This is the searching multiple error",t),o.Logger.logError(a,"unknown","search","unknown",void 0,500,t,"SearchLinkMultipleApi",[e,n],"unknown",void 0),(0,r.Mb)(t,d),(0,r.ey)(s,"SearchLinkMultipleApi",t)}}))}},3130:(e,t,n)=>{n.d(t,{BG:()=>a,SL:()=>l,XZ:()=>s,ZJ:()=>r,iw:()=>c,y0:()=>i,yv:()=>o});const o=1,i=2,r=3,c=4,s=5,a=6,l=7},9635:(e,t,n)=>{n.d(t,{x:()=>o});const o=new BroadcastChannel("Freeschema_mftsccs_browser_channel")},9581:(e,t,n)=>{n.d(t,{B:()=>o});class o{static setRandomizer(e){console.log("set randomizer",e),this.BASE_RANDOMIZER=e}static getRandomizer(){return this.BASE_RANDOMIZER}static GetConceptUrl(){return this.BASE_URL+"/api/getConcept"}static GetConnectionUrl(){return this.BASE_URL+"/api/get-connection-by-id"}static GetConceptBulkUrl(){return this.BASE_URL+"/api/get_concept_bulk"}static GetConnectionBulkUrl(){return this.BASE_URL+"/api/get_connection_bulk"}static GetAllConceptsOfUserUrl(){return this.BASE_URL+"/api/get_all_concepts_of_user"}static GetAllConnectionsOfUserUrl(){return this.BASE_URL+"/api/get_all_connections_of_user"}static GetAllConnectionsOfCompositionUrl(){return this.BASE_URL+"/api/get_all_connections_of_composition"}static GetAllConnectionsOfCompositionBulkUrl(){return this.BASE_URL+"/api/get_all_connections_of_composition_bulk"}static GetConceptByCharacterValueUrl(){return this.BASE_URL+"/api/get_concept_by_character_value"}static GetConceptByCharacterAndTypeUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_type"}static GetConceptByCharacterAndCategoryUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_category"}static GetConceptByCharacterAndCategoryDirectUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_category_direct"}static GetCharacterByCharacterUrl(){return this.BASE_URL+"/api/get_character_by_character"}static GetAllConceptsByTypeUrl(){return this.BASE_URL+"/api/get_all_concepts_by_type"}static GetAllConnectionsOfConceptUrl(){return this.BASE_URL+"/api/get-link-connections"}static GetAllAiData(){return this.BASE_URL+"/api/get-preloaded-concepts"}static PostPrefetchConceptConnections(){return this.NODE_URL+"/api/v1/access-tracker/sync-access-tracker"}static GetSuggestedConcepts(){return this.NODE_URL+"/api/v1/access-tracker/list-concepts-file"}static GetSuggestedConnections(){return this.NODE_URL+"/api/v1/access-tracker/list-connections-file"}static PostLogger(){return this.LOG_SERVER+"/api/logger"}static GetAllPrefetchConnectionsUrl(){return this.BASE_URL+"/api/get_all_connections_of_user?inpage=500"}static GetAllLinkerConnectionOfConceptUrl(){return this.BASE_URL+"/api/get-all-linkers-from-concept"}static GetAllLinkerConnectionToConceptUrl(){return this.BASE_URL+"/api/get-all-linkers-to-concept"}static DeleteConceptUrl(){return this.BASE_URL+"/api/delete_concept"}static DeleteUserUrl(){return this.BASE_URL+"/api/deleteuser"}static RecursiveSearchUrl(){return this.BASE_URL+"/api/recursivesearch-concept-connection"}static SearchLinkMultipleAllApiUrl(){return this.BASE_URL+"/api/Connection/search-link-multiple-all-ccs"}static MakeTheNameInBackendUrl(){return this.BASE_URL+"/api/make-name-from-frontend"}static SearchAllTypeWithLinker(e=!0){return e?this.BASE_URL+"/api/search-all-with-linker-ccs":this.BASE_URL+"/api-search-compositions-internal-clean-ccs"}static LoginUrl(){return this.BASE_URL+"/api/auth/login"}static SignupUrl(){return this.BASE_URL+"/api/auth/signup"}static GetCompositionConnectionBetweenTwoConceptsUrl(){return this.BASE_URL+"/api/get-composition-connection-between-two-concepts"}static SearchCompositionsUrl(){return this.BASE_URL+"/api/search-compositions"}static SearchLinkMultipleAll(){return this.BASE_URL+"/api/Connection/search-link-multiple-all"}static CreateSessionId(){return this.BASE_URL+"/api/create-session-id-remote"}static CreateSessionVisitUrl(){return this.BASE_URL+"/api/create-remote-session-visit"}static ViewInternalDataUrl(){return this.BASE_URL+"/api/view-api-internal-data-ccs-id-bulk"}static SearchInternalWithAuthenticatedCcsUrl(){return this.BASE_URL+"/api/search-composition-internal-authenticated-ccs"}static SearchInternalWithCcsUrl(){return this.BASE_URL+"/api-search-compositions-internal-clean-ccs"}static CreateGhostConceptApiUrl(){return o.NODE_URL+"/api/v1/local-concepts"}static CreateGhostConnectionApiUrl(){return o.NODE_URL+"/api/v1/local-connections"}static GetRealConceptById(){return o.NODE_URL+"/api/v1/local-concepts-translate"}static GetReservedIdUrl(){return this.BASE_URL+"/api/get_reserved_ids"}static GetReservedConnectionIdUrl(){return this.BASE_URL+"/api/get_reserved_connection_ids"}static CreateTheTextDataUrl(){return this.BASE_URL+"/api/create_text_data"}static CreateTheCharacterDataUrl(){return this.BASE_URL+"/api/create_character_data"}static CreateTheConceptUrl(){return this.BASE_URL+"/api/create_the_concept"}static CreateTheConnectionUrl(){return this.BASE_URL+"/api/create_the_connection"}static CreateTheConnectionNewUrl(){return this.BASE_URL+"/api/create_the_connection_new"}static MakeTheTypeConceptUrl(){return this.BASE_URL+"/api/make_the_type_concept"}static DeleteTheConnectionUrl(){return this.BASE_URL+"/api/delete_connection"}static FreeschemaQueryUrl(){return this.BASE_URL+"/api/freeschema-query"}static uploadImageUrl(){return this.BASE_URL+"/api/Image/UploadImage"}static uploadFileUrl(){return this.BASE_URL+"/api/Image/UploadFile"}static sendMail(){return this.BASE_URL+"/api/sendmail"}static sendBulkMail(){return this.BASE_URL+"/api/sendmail/bulk"}static getWidgetData(){return this.BASE_URL+"/api/get-widget"}}o.BASE_URL="https://localhost:7053/",o.AI_URL="https://ai.freeschema.com",o.MQTT_URL="192.168.1.249",o.NODE_URL="http://localhost:5001",o.LOG_SERVER="https://logdev.freeschema.com",o.BASE_APPLICATION="",o.FLAGS={logApplication:!1,logPackage:!1,accessTracker:!1,isTest:!1},o.BASE_RANDOMIZER=999},6963:(e,t,n)=>{n.d(t,{f:()=>c});var o=n(205),i=n(6731),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class c{static waitForDataToLoad(){return r(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(o.B.isCharacterLoaded)return e("done");setTimeout(c.checkFlag,1e3,e)}static addNodeToTree(e){return r(this,void 0,void 0,(function*(){return null==this.characterRoot?(this.characterRoot=e,this.characterRoot):(this.characterRoot=this.characterRoot.addCharacterNode(e,this.characterRoot,this.characterRoot.height),this.characterRoot)}))}static removeNodeByCharacter(e,t){return r(this,void 0,void 0,(function*(){this.characterRoot&&this.characterRoot.removeNodeWithVariants(this.characterRoot,e,t)}))}static countNumberOfNodes(){return this.characterRoot?this.characterRoot.countNodeBelow(this.characterRoot):0}static addConceptToTree(e){if(""!=e.characterValue){var t=new i.b(e.characterValue,e,null,null);this.addNodeToTree(t)}}static getNodeFromTree(e){return this.characterRoot?this.characterRoot.getCharacterFromNode(e,this.characterRoot):this.characterRoot}static getNodeFromTreeUpdated(e){return this.characterRoot?this.characterRoot.getCharacterFromNode(e,this.characterRoot):this.characterRoot}static getCharacterAndTypeFromTree(e,t){return r(this,void 0,void 0,(function*(){return this.characterRoot?this.characterRoot.getFromNodeWithCharacterAndType(e,t,this.characterRoot):this.characterRoot}))}static getCharacterAndCategoryFromTree(e,t){return r(this,void 0,void 0,(function*(){return this.characterRoot?this.characterRoot.getFromNodeWithCharacterAndCategory(e,t,this.characterRoot):this.characterRoot}))}static removeConceptCharacter(e){this.characterRoot&&(this.characterRoot=this.characterRoot.removeNode(this.characterRoot,e))}}c.characterRoot=null},2202:(e,t,n)=>{n.d(t,{W:()=>a});var o=n(6963),i=n(6731),r=n(205),c=n(2830),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class a{static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static waitForDataToLoad(){return s(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(r.B.isDataLoaded)return e("done");setTimeout(a.checkFlag,1e3,e)}static addConceptToTree(e){let t=new i.b(e.id,e,null,null),n=new i.b(e.characterValue,e,null,null);o.f.addNodeToTree(n),this.addNodeToTree(t)}static getNodeFromTree(e){return s(this,void 0,void 0,(function*(){return this.root?this.root.getFromNode(e,this.root):null}))}static removeNodeFromTree(e){return s(this,void 0,void 0,(function*(){if(this.root){let t=new Event(`${e}`);console.log("this is the fired event after delete",t),(0,c.dispatchIdEvent)(e),this.root=this.root.removeNode(this.root,e)}}))}static getConceptListFromIds(e,t,n){return s(this,void 0,void 0,(function*(){this.root&&this.root.checkIfIdsInNode(this.root,e,t,n)}))}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}a.root=null},5457:(e,t,n)=>{n.d(t,{c:()=>a});var o=n(2830),i=n(7282),r=n(205);class c{constructor(e,t){this.value=[],this.height=1,this.key=e,this.value.push(t),this.leftNode=null,this.rightNode=null,this.currentNode=null}addType(e,t,n){var o,i,r,s;if(null==e)return new c(t,n);if(t<e.key)e.leftNode=this.addType(e.leftNode,t,n);else{if(!(t>e.key))return e.value.push(n),e;e.rightNode=this.addType(e.rightNode,t,n)}e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1;const a=this.getBalanceFactor(e);return a>1&&t<(null===(o=e.leftNode)||void 0===o?void 0:o.key)?this.rightRotate(e):a<-1&&t>(null===(i=e.rightNode)||void 0===i?void 0:i.key)?this.leftRotate(e):a>1&&t>(null===(r=e.leftNode)||void 0===r?void 0:r.key)?(e.leftNode=this.leftRotate(e.leftNode),this.rightRotate(e)):a<-1&&t<(null===(s=e.rightNode)||void 0===s?void 0:s.key)?(e.rightNode=this.rightRotate(e.rightNode),this.leftRotate(e)):e}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){return t?e==t.key?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}removeNodeWithVariants(e,t,n){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNodeWithVariants(e.leftNode,t,n),e;if(e.key<t)return e.rightNode=this.removeNodeWithVariants(e.rightNode,t,n),e;if(e.value.length>0)for(let t=0;t<e.value.length;t++)if(n==e.value[t])return e.value.splice(t,1),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.currentNode=t.currentNode,e.rightNode=this.removeNodeWithVariants(e.rightNode,t.key,n),e}}countNodeBelow(e){return null==e?0:1+this.countNodeBelow(e.leftNode)+this.countNodeBelow(e.rightNode)}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}var s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class a{static addType(e){return s(this,void 0,void 0,(function*(){return null==this.root?(this.root=e,new CustomEvent(`${e.key}`,{detail:e.value[0]}),(0,o.dispatchIdEvent)(e.key,{detail:e.value[0]}),this.root):(new CustomEvent(`${e.key}`,{detail:e.value[0]}),(0,o.dispatchIdEvent)(e.key,{detail:e.value[0]}),this.root=this.root.addType(this.root,e.key,e.value[0]),this.root)}))}static addConceptToTree(e){if(0!=e.typeId){let t=new c(e.typeId,e.id);this.addType(t)}}static removeTypeConcept(e,t){this.root&&(this.root=this.root.removeNodeWithVariants(this.root,e,t))}static getNodeFromTreeNew(e){return this.root?this.root.getFromNode(e,this.root):this.root}static getTypeVariantsFromTreeNew(e){return s(this,void 0,void 0,(function*(){let t=this.getNodeFromTreeNew(e),n=[],i=[];if(t){n=t.value;for(let e=0;e<n.length;e++){let t=!1;for(let o=0;o<i.length;o++)i[o].id==n[e]&&(t=!0);t||i.push(yield(0,o.GetTheConcept)(n[e]))}}return i}))}static waitForDataToLoad(){return s(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(r.B.isTypeLoaded)return e("done");setTimeout(a.checkFlag,1e3,e)}static getTypeVariantsFromTreeWithUserIdNew(e,t){return s(this,void 0,void 0,(function*(){let n=[],o=yield this.getTypeVariantsFromTreeNew(e);console.log("these are all the concepts",o);for(let e=0;e<o.length;e++)o[e].userId==t&&n.push(o[e]);return n}))}static getTypeVariantsWithCharacterValueNew(e,t){return s(this,void 0,void 0,(function*(){let n=yield this.getTypeVariantsFromTreeNew(t);console.log("this is all the concepts for character",n);let o=(0,i.o)();for(let t=0;t<n.length;t++)n[t].characterValue==e&&(o=n[t]);return o}))}static countNumberOfNodes(){return this.typeRoot?this.typeRoot.countNodeBelow(this.typeRoot):0}}a.typeRoot=null,a.root=null},2615:(e,t,n)=>{n.d(t,{j:()=>i});var o=n(2830);class i{constructor(e,t,n,i,r,c,s,a=!1,l,d,u){this.count=0,this.typeCharacter="",this.isComposition=!1,this.isTemp=!1,this.isSynced=!1,this.applicationId=o.BaseUrl.getRandomizer(),this.x=0,this.y=0,this.id=e,this.userId=t,this.typeId=n,this.ghostId=e,this.categoryId=i,this.referentId=r,this.characterValue=`${c}`,this.accessId=s,this.typeCharacter=u,this.type=null,this.isNew=a,this.entryTimeStamp=l,this.updatedTimeStamp=d}getType(){console.log(this.typeId)}}},9639:(e,t,n)=>{n.d(t,{I:()=>d});var o=n(3655),i=n(2202),r=n(6963),c=n(5457),s=n(7282),a=n(2830),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class d{constructor(){this.name="conceptsArray"}static CheckContains(e){for(var t=!1,n=0;n<this.conceptsArray.length;n++)this.conceptsArray[n].id==e.id&&(t=!0);return t}static AddNpc(e){this.NPC.includes(e)||(this.NPC.length>10&&(this.NPC=[]),this.NPC.push(e))}static GetNpc(e){return!!this.NPC.includes(e)}static AddConceptToStorage(e){e.id>0&&(0,o.kH)("concept",e)}static GetConceptBulkData(e,t,n){return l(this,void 0,void 0,(function*(){yield i.W.getConceptListFromIds(e,t,n)}))}static AddConcept(e){if(a.serviceWorker)try{(0,a.sendMessage)("ConceptsData__AddConcept",{concept:e})}catch(e){console.error("Concept Data, Add Concpet sw error: ",e),(0,a.handleServiceWorkerException)(e)}e.id>0&&(i.W.addConceptToTree(e),c.c.addConceptToTree(e))}static AddConceptToMemory(e){e.id>0&&(i.W.addConceptToTree(e),c.c.addConceptToTree(e))}static AddConceptTemporary(e){var t=this.CheckContains(e);this.conceptDictionary[e.id]=e,t&&this.RemoveConcept(e),this.conceptsArray.push(e)}static RemoveConcept(e){for(var t=0;t<this.conceptsArray.length;t++)this.conceptsArray[t].id==e.id&&this.conceptsArray.splice(t,1);(0,o.wh)("concept",e.id)}static GetConcept(e){return l(this,void 0,void 0,(function*(){if(a.serviceWorker)try{return(yield(0,a.sendMessage)("ConceptsData__GetConcept",{id:e})).data}catch(e){console.error("Concept Data, Get Concpet sw error: ",e),(0,a.handleServiceWorkerException)(e)}if(0==e||null==e||null==e)return(0,s.o)();var t=(0,s.o)(),n=yield i.W.getNodeFromTree(e);if(null==n?void 0:n.value){var o=n.value;o&&(t=o)}return t}))}static GetConceptByCharacter(e){return l(this,void 0,void 0,(function*(){var t=(0,s.o)(),n=r.f.getNodeFromTree(e);return n&&(t=n.value),t}))}static GetConceptByCharacterUpdated(e){return l(this,void 0,void 0,(function*(){var t=(0,s.o)(),n=r.f.getNodeFromTree(e);return n&&(t=n.value),t}))}static GetConceptByCharacterAndTypeLocal(e,t){return l(this,void 0,void 0,(function*(){return(0,s.o)(),yield c.c.getTypeVariantsWithCharacterValueNew(e,t)}))}static GetConceptByCharacterAndCategoryLocal(e,t){return l(this,void 0,void 0,(function*(){var n=(0,s.o)(),o=yield r.f.getCharacterAndCategoryFromTree(e,t);return o&&(n=o.value),n}))}static GetConceptsByTypeId(e){let t=[];for(var n=0;n<this.conceptsArray.length;n++)this.conceptsArray[n].typeId==e&&t.push(this.conceptsArray[n]);return t}static GetConceptsByTypeIdAndUser(e,t){var n=arguments;return l(this,void 0,void 0,(function*(){if(a.Logger.logfunction("ConceptsData.GetConceptsByTypeIdAndUser",n),a.serviceWorker)try{return(yield(0,a.sendMessage)("ConceptsData__GetConceptsByTypeIdAndUser",{typeId:e,userId:t})).data}catch(e){console.error("Concept Data, Get Concpet sw error:",e),(0,a.handleServiceWorkerException)(e)}let o=[];return o=yield c.c.getTypeVariantsFromTreeWithUserIdNew(e,t),o}))}static GetBinaryCharacterTree(){return r.f.characterRoot}getName(){return this.name}}d.conceptsArray=[],d.NPC=[],d.conceptDictionary=[]},2155:(e,t,n)=>{n.d(t,{N:()=>r});var o=n(7282),i=n(9581);class r{constructor(e=0,t,n,r,c,s,a){this.count=0,this.isTemp=!1,this.toUpdate=!1,this.applicationId=i.B.getRandomizer(),this.type=(0,o.o)(),this.ofConcept=(0,o.o)(),this.toConcept=(0,o.o)(),this.id=e,this.ofTheConceptId=t,this.toTheConceptId=n,this.userId=r,this.typeId=c,this.ghostId=e,this.orderId=s,this.accessId=a,this.entryTimeStamp=new Date,this.terminationDateTime=new Date,this.localSyncTime=new Date,this.typeCharacter=""}}},5239:(e,t,n)=>{n.d(t,{O:()=>s});var o=n(205),i=n(2830);class r{constructor(e,t,n,o){this.leftNode=null,this.rightNode=null,this.variants=[],this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o,this.currentNode=null}addCurrentNode(e,t){return null==t?t=e:(e.value.typeId!=t.value.typeId&&(t.currentNode=this.addCurrentNode(e,t.currentNode)),t)}addCurrentNodeType(e,t){if(null==t)return e;let n=!1;e.value.id==t.value.id&&(n=!0);for(let o=0;o<t.variants.length;o++)t.variants[o].value.id==e.value.id&&(n=!0);return n||t.variants.push(e),t}getMax(e,t){return e>t?e:t}addNode(e,t,n){if(null==t)return e;let o=t.leftNode,i=t.rightNode;if(e.key<t.key)t.leftNode=this.addNode(e,o,n);else{if(!(e.key>t.key))return t;t.rightNode=this.addNode(e,i,n)}t.height=1+this.getMax(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(this.getBalanceFactor(t.leftNode)>=0)return this.rightRotate(t);if(this.getBalanceFactor(t.leftNode)<0)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(this.getBalanceFactor(t.rightNode)<=0)return this.leftRotate(t);if(this.getBalanceFactor(t.rightNode)>0)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}addTypeNode(e,t,n){if(0!=e.value.typeId){if(null==t)return e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addTypeNode(e,o,n);else{if(!(t.key<e.key))return t.key==e.key&&0!=t.key&&t.addCurrentNodeType(e,t),t;t.rightNode=this.addTypeNode(e,i,n)}t.height=1+this.getMax(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key){return this.rightRotate(t)}if(e.key>t.leftNode.key){return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key){return this.leftRotate(t)}if(e.key<t.rightNode.key){return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}}}return t}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=this.getMax(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=this.getMax(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}throw console.log("this is the error in right rotation",e,t),new Error("Cannot perform right rotation: left node is null.")}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=this.getMax(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=this.getMax(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}throw console.log("this is the error in left rotation",e,t),new Error("Cannot perform left rotation: right node is null.")}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){try{if(t)return e==t.key?(t.value.count?t.value.count++:t.value.count=1,t):e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t}catch(n){console.log("this is the exception",e,t,null==t?void 0:t.leftNode,null==t?void 0:t.rightNode)}return t}getCharacterFromNode(e,t){return t?e==t.key?t:e<t.key?this.getCharacterFromNode(e,t.leftNode):e>t.key?this.getCharacterFromNode(e,t.rightNode):t:t}checkIfIdsInNode(e,t,n,o){if(e){if(t.includes(e.key)){n.push(e.value);let o=t.indexOf(e.key);t.splice(o,1)}e.leftNode&&this.checkIfIdsInNode(e.leftNode,t,n,o),e.rightNode&&this.checkIfIdsInNode(e.rightNode,t,n,o)}}traverse(e){let t=0;return e&&(t+=1,(null==e?void 0:e.leftNode)&&(t+=this.traverse(e.leftNode)),e.rightNode&&(t+=this.traverse(e.rightNode))),t}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(new Event(`${e.value.ofTheConceptId}`),(0,i.dispatchIdEvent)(e.value.ofTheConceptId),null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.variants=t.variants,e.currentNode=t.currentNode,e.rightNode=this.removeNode(e.rightNode,t.key),e}}removeNodeWithVariants(e,t,n){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNodeWithVariants(e.leftNode,t,n),e;if(e.key<t)return e.rightNode=this.removeNodeWithVariants(e.rightNode,t,n),e;if(e.variants.length>0)if(e.value.id==n){let t=e.variants[0];if(t)return e.value=t.value,e.key=t.key,e.currentNode=t.currentNode,e.variants.splice(0,1),e}else for(let t=0;t<e.variants.length;t++)if(n==e.variants[t].value.id)return e.variants.splice(t,1),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.variants=t.variants,e.currentNode=t.currentNode,e.rightNode=this.removeNodeWithVariants(e.rightNode,t.key,n),e}}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}var c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class s{static addNodeToTree(e){try{if(null==this.connectionroot)return this.connectionroot=e,this.connectionroot;this.connectionroot=this.connectionroot.addNode(e,this.connectionroot,this.connectionroot.height)}catch(e){throw console.log("This is the error in making the tree",e),e}}static addConnectionToTree(e){let t=new r(e.id,e,null,null);this.addNodeToTree(t)}static traverse(){var e;return null===(e=this.connectionroot)||void 0===e?void 0:e.traverse(this.connectionroot)}static waitForDataToLoad(){return c(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(o.B.isConnectionLoaded)return e("done");setTimeout(s.checkFlag,1e3,e)}static removeNodeFromTree(e){return c(this,void 0,void 0,(function*(){this.connectionroot&&(this.connectionroot=this.connectionroot.removeNode(this.connectionroot,e))}))}static getNodeFromTree(e){return c(this,void 0,void 0,(function*(){try{return this.connectionroot?this.connectionroot.getFromNode(e,this.connectionroot):this.connectionroot}catch(t){console.log("this is the getNodeFromTree",e,this.connectionroot)}}))}static getConnectionListFromIds(e,t,n){return c(this,void 0,void 0,(function*(){this.connectionroot&&this.connectionroot.checkIfIdsInNode(this.connectionroot,e,t,n)}))}}s.connectionroot=null},991:(e,t,n)=>{n.d(t,{H:()=>s});var o=n(2830),i=n(3996);class r extends i.i{constructor(e,t,n,o){super(e,t,n,o),this.key="",this.value=[],this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o}addNode(e,t,n){if(null==t)return e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return t;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(this.getBalanceFactor(t.leftNode)>=0)return this.rightRotate(t);if(this.getBalanceFactor(t.leftNode)<0)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(this.getBalanceFactor(t.rightNode)<=0)return this.leftRotate(t);if(this.getBalanceFactor(t.rightNode)>0)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}}var c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class s{static CreateCompositionKey(e,t){return e}static GetConnectionByOfTheConceptAndTypeId(e,t){let n=this.CreateCompositionKey(e,t);if(this.node){let e=this.node.getFromNode(n,this.node);if(e)return e.value}return null}static addConnection(e){if(e.id>0){let t=this.CreateCompositionKey(e.ofTheConceptId,e.typeId);if(this.node){let n=this.node.getFromNode(t,this.node);if(n){let t=null==n?void 0:n.value;0==t.length&&(n.value=[]),t.includes(e.id)||t.push(e.id)}else{let n=[];n.push(e.id);let o=new r(t,n,null,null);this.addNodeToTree(o)}}else{let n=[];n.push(e.id);let o=new r(t,n,null,null);this.addNodeToTree(o)}new Event(`${t}`)}else console.log("cannot insert key id with  n 0 to the connection tree",e)}static addNodeToTree(e){return c(this,void 0,void 0,(function*(){return null==this.node?(this.node=e,(0,o.dispatchIdEvent)(e.key),this.node):(this.node=this.node.addNode(e,this.node,this.node.height),this.node)}))}static removeNodeFromTree(e){return c(this,void 0,void 0,(function*(){this.node&&(this.node=this.node.removeNode(this.node,e))}))}}s.node=null},3996:(e,t,n)=>{n.d(t,{i:()=>o});class o{constructor(e,t,n,o){this.key="",this.value=[],this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o}getFromNode(e,t){return t?e==t.key?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.variants=t.variants,e.currentNode=t.currentNode,e.rightNode=this.removeNode(e.rightNode,t.key),e}}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}},8286:(e,t,n)=>{n.d(t,{d:()=>f});var o=n(1735),i=n(2830),r=n(3655),c=n(1863),s=n(2155),a=n(5239),l=n(991),d=n(3996);class u extends d.i{constructor(e,t,n,o){super(e,t,n,o),this.key="",this.value=[],this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o}addNode(e,t,n){if(null==t)return e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return t;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}}class h{static CreateCompositionKey(e){return e}static addNodeToTree(e){return t=this,n=void 0,i=function*(){return null==this.connectionTypeRoot?(this.connectionTypeRoot=e,this.connectionTypeRoot):(this.connectionTypeRoot=this.connectionTypeRoot.addNode(e,this.connectionTypeRoot,this.connectionTypeRoot.height),this.connectionTypeRoot)},new((o=void 0)||(o=Promise))((function(e,r){function c(e){try{a(i.next(e))}catch(e){r(e)}}function s(e){try{a(i.throw(e))}catch(e){r(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(c,s)}a((i=i.apply(t,n||[])).next())}));var t,n,o,i}static addConnectionToTree(e){if(e.id>0){let t=this.CreateCompositionKey(e.typeId);if(this.connectionTypeRoot){let n=this.connectionTypeRoot.getFromNode(t,this.connectionTypeRoot);if(n){let t=null==n?void 0:n.value;0==t.length&&(n.value=[]),t.includes(e.id)||t.push(e.id)}else{let n=[];n.push(e.id);let o=new u(t,n,null,null);this.addNodeToTree(o)}}else{let n=[];n.push(e.id);let o=new u(t,n,null,null);this.addNodeToTree(o)}}else console.log("cannot insert key id with  n 0 to the connection tree",e)}static GetConnectionByOfTheConceptAndTypeId(e,t){let n=this.CreateCompositionKey(t);if(this.connectionTypeRoot){let e=this.connectionTypeRoot.getFromNode(n,this.connectionTypeRoot);if(e)return e.value}return null}}h.connectionTypeRoot=null;var p=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class f{constructor(){this.name="Connection Array"}static CheckContains(e){let t=!1;for(let n=0;n<this.connectionArray.length;n++)this.connectionArray[n].id==e.id&&(t=!0);return t}static AddConnectionToStorage(e){(0,r.kH)("connection",e)}static AddConnection(e){try{a.O.addConnectionToTree(e),h.addConnectionToTree(e),l.H.addConnection(e)}catch(e){throw console.log("this is the error in making the connection"),e}}static AddConnectionToMemory(e){e.isTemp||(a.O.addConnectionToTree(e),h.addConnectionToTree(e),l.H.addConnection(e))}static AddToDictionary(e){this.connectionDictionary[e.id]=e}static RemoveConnection(e){0!=e.id&&((0,r.wh)("connection",e.id),a.O.removeNodeFromTree(e.id),l.H.removeNodeFromTree(e.id))}static GetConnectionTypeOfTree(){l.H.node}static GetConnectionByOfTheConceptAndType(e,t){return p(this,void 0,void 0,(function*(){try{if(i.serviceWorker)try{return(yield(0,i.sendMessage)("ConnectionData__GetConnectionByOfTheConceptAndType",{ofTheConceptId:e,typeId:t})).data}catch(e){console.error("GetConnectionByOfTheConceptAndType sw error: ",e),(0,i.handleServiceWorkerException)(e)}return l.H.GetConnectionByOfTheConceptAndTypeId(e,t)||[]}catch(e){return console.log("this is the error in GetConnectionByOfTheConceptAndType",e),[]}}))}static GetConnectionByOfType(e,t){const n=i.Logger.logfunction("ConnectionData.GetConnectionByOfType",arguments);let o=h.GetConnectionByOfTheConceptAndTypeId(e,t);return o?(i.Logger.logUpdate(n),o):(i.Logger.logUpdate(n),[])}static GetConnectionTree(){return a.O.connectionroot}static GetConnectionTypeTree(){return h.connectionTypeRoot}static GetConnectionBulkData(e,t,n){return p(this,void 0,void 0,(function*(){yield a.O.getConnectionListFromIds(e,t,n)}))}static GetConnection(e){return p(this,void 0,void 0,(function*(){o.J.incrementConnection(e);let t=new s.N(0,0,0,0,0,0,0);try{if(i.serviceWorker)try{return(yield(0,i.sendMessage)("ConnectionData__GetConnection",{id:e})).data}catch(e){console.error("GetConnection sw error: ",e),(0,i.handleServiceWorkerException)(e)}let n=yield a.O.getNodeFromTree(e);if(null==n?void 0:n.value){let e=n.value;e&&(t=e)}return t}catch(e){return console.log("this is the error in GetConnection",e),t}}))}static GetConnectionsOfCompositionLocal(e){var t=arguments;return p(this,void 0,void 0,(function*(){const n=i.Logger.logfunction("ConnectionData.GetConnectionsOfCompositionLocal",t);let o=[];try{if(i.serviceWorker){n.serviceWorker=!0;try{const t=yield(0,i.sendMessage)("ConnectionData__GetConnectionsOfCompositionLocal",{id:e});return i.Logger.logUpdate(n),t.data}catch(e){console.error("GetConnectionsOfCompositionLocal sw error: ",e),(0,c.ey)(n,"GetConnectionsOfCompositionLocal",e),(0,i.handleServiceWorkerException)(e)}}let t=[];t=f.GetConnectionByOfType(e,e);for(let e=0;e<t.length;e++){let r=yield a.O.getNodeFromTree(t[e]);r&&o.push(r.value),i.Logger.logUpdate(n)}}catch(t){console.log("this is the error GetConnectionsOfCompositionLocal",e,o),(0,c.ey)(n,"ConnectionData.GetConnectionsOfCompositionLocal",t)}return o}))}static GetConnectionsOfConcept(e){return p(this,void 0,void 0,(function*(){let t=[],n=[];try{if(i.serviceWorker)try{return(yield(0,i.sendMessage)("ConnectionData__GetConnectionsOfConcept",{id:e})).data}catch(e){console.error("GetConnectionsOfConcept sw error: ",e),(0,i.handleServiceWorkerException)(e)}t=yield f.GetConnectionByOfTheConceptAndType(e,e);for(let e=0;e<t.length;e++){let o=yield a.O.getNodeFromTree(t[e]);o&&n.push(o.value)}return n}catch(e){return console.log("this is the error in GetConnectionsOfConcept",e),n}}))}getName(){return this.name}}f.connectionArray=[],f.connectionDictionary=[]},205:(e,t,n)=>{n.d(t,{B:()=>o});class o{}o.isTypeLoaded=!1,o.isCharacterLoaded=!1,o.isDataLoaded=!1,o.isLocalDataLoaded=!1,o.isLocalCharacterLoaded=!1,o.isLocalTypeLoaded=!1,o.isConnectionLoaded=!1,o.isConnectionTypeLoaded=!1,o.isLocalConnectionLoaded=!1},2515:(e,t,n)=>{n.d(t,{x:()=>o});class o{constructor(e,t,n,o){this.variants=[],this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o,this.currentNode=null}addCurrentNode(e,t){return null==t?t=e:(e.value.typeId!=t.value.typeId&&(t.currentNode=this.addCurrentNode(e,t.currentNode)),t)}addCurrentNodeType(e,t){if(null==t)return e;var n=!1;for(let o=0;o<t.variants.length;o++)t.variants[o].value.id==e.value.id&&(n=!0);return n||t.variants.push(e),t}addNode(e,t,n){if(null==t)return e;var o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return t;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}addCharacterNode(e,t,n){if(""!=e.value.characterValue){if(null==t)return e;var o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addCharacterNode(e,o,n);else{if(!(t.key<e.key))return t.key==e.key&&""!=t.key&&t.value.id!=e.value.id&&t.addCurrentNodeType(e,t),t;t.rightNode=this.addCharacterNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}}return t}addTypeNode(e,t,n){if(0!=e.value.typeId){if(null==t)return e;var o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addTypeNode(e,o,n);else{if(!(t.key<e.key))return t.key==e.key&&0!=t.key&&t.value.id!=e.value.id&&t.addCurrentNodeType(e,t),t;t.rightNode=this.addTypeNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}}return t}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){return t?e==t.key?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}updateNodeSyncStatus(e,t,n){if(n){if(e==n.key){let e=n.value;return e.isSynced=t,n.value=e,n}return e<n.key?this.updateNodeSyncStatus(e,t,n.leftNode):e>n.key?this.updateNodeSyncStatus(e,t,n.rightNode):n}return n}getCharacterFromNode(e,t){return t?e==t.key?t:e<t.key?this.getCharacterFromNode(e,t.leftNode):e>t.key?this.getCharacterFromNode(e,t.rightNode):t:t}getFromNodeWithCharacterAndType(e,t,n){if(e=`${e}`,n){if(e==n.key){if(e==n.value.characterValue&&t==n.value.typeId)return n;for(let e=0;e<n.variants.length;e++)if(n.variants[e].value.typeId==t)return n.variants[e]}else{if(e<n.key)return this.getFromNodeWithCharacterAndType(e,t,n.leftNode);if(e>n.key)return this.getFromNodeWithCharacterAndType(e,t,n.rightNode)}return null}return n}getFromNodeWithCharacterAndCategory(e,t,n){if(e=`${e}`,n){if(e==n.key){if(e==n.value.characterValue&&t==n.value.categoryId)return n;for(let e=0;e<n.variants.length;e++)if(n.variants[e].value.categoryId==t)return n.variants[e]}else{if(e<n.key)return this.getFromNodeWithCharacterAndCategory(e,t,n.leftNode);if(e>n.key)return this.getFromNodeWithCharacterAndCategory(e,t,n.rightNode)}return null}return n}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}var n=this.inOrderSuccessor(e.rightNode);return e.value=n.value,e.key=n.key,e.variants=n.variants,e.currentNode=n.currentNode,e.rightNode=this.removeNode(e.rightNode,n.key),e}removeNodeWithVariants(e,t,n){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNodeWithVariants(e.leftNode,t,n),e;if(e.key<t)return e.rightNode=this.removeNodeWithVariants(e.rightNode,t,n),e;if(e.variants.length>0)if(e.value.id==n){var o=e.variants[0];if(o)return e.value=o.value,e.key=o.key,e.currentNode=o.currentNode,e.variants.splice(0,1),e}else for(let t=0;t<e.variants.length;t++)if(n==e.variants[t].value.id)return e.variants.splice(t,1),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}var i=this.inOrderSuccessor(e.rightNode);return e.value=i.value,e.key=i.key,e.variants=i.variants,e.currentNode=i.currentNode,e.rightNode=this.removeNodeWithVariants(e.rightNode,i.key,n),e}countNodeBelow(e){return null==e?0:1+this.countNodeBelow(e.leftNode)+this.countNodeBelow(e.rightNode)}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}},9736:(e,t,n)=>{n.d(t,{v:()=>C});var o=n(205),i=n(2515),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class c{static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static addConceptToTree(e){var t=new i.x(e.id,e,null,null);new i.x(e.characterValue,e,null,null),this.addNodeToTree(t)}static waitForDataToLoad(){return r(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(o.B.isLocalDataLoaded)return e("done");setTimeout(c.checkFlag,1e3,e)}static getNodeFromTree(e){return r(this,void 0,void 0,(function*(){return this.root?this.root.getFromNode(e,this.root):null}))}static getCharacterAndTypeFromTree(e,t){return this.root?this.root.getFromNodeWithCharacterAndType(e,t,this.root):this.root}static updateSyncStatus(e){return this.root?this.root.updateNodeSyncStatus(e,!0,this.root):this.root}static removeNodeFromTree(e){return r(this,void 0,void 0,(function*(){this.root&&(this.root=this.root.removeNode(this.root,e))}))}}c.root=null;var s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class a{static waitForDataToLoad(){return s(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(o.B.isLocalCharacterLoaded)return e("done");setTimeout(a.checkFlag,1e3,e)}static addNodeToTree(e){return s(this,void 0,void 0,(function*(){return null==this.LocalCharacterRoot?(this.LocalCharacterRoot=e,this.LocalCharacterRoot):(this.LocalCharacterRoot=this.LocalCharacterRoot.addCharacterNode(e,this.LocalCharacterRoot,this.LocalCharacterRoot.height),this.LocalCharacterRoot)}))}static addConceptToTree(e){if(""!=e.characterValue){var t=new i.x(e.characterValue,e,null,null);this.addNodeToTree(t)}}static getNodeFromTree(e){return this.LocalCharacterRoot?this.LocalCharacterRoot.getCharacterFromNode(e,this.LocalCharacterRoot):this.LocalCharacterRoot}static getCharacterAndTypeFromTree(e,t){return s(this,void 0,void 0,(function*(){return this.LocalCharacterRoot?this.LocalCharacterRoot.getFromNodeWithCharacterAndType(e,t,this.LocalCharacterRoot):this.LocalCharacterRoot}))}static getCharacterAndCategoryFromTree(e,t){return s(this,void 0,void 0,(function*(){return this.LocalCharacterRoot?this.LocalCharacterRoot.getFromNodeWithCharacterAndCategory(e,t,this.LocalCharacterRoot):this.LocalCharacterRoot}))}static removeConceptType(e,t){this.LocalCharacterRoot&&(this.LocalCharacterRoot=this.LocalCharacterRoot.removeNodeWithVariants(this.LocalCharacterRoot,e,t))}}a.LocalCharacterRoot=null;var l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class d{static addNodeToTree(e){return l(this,void 0,void 0,(function*(){return null==this.LocalTypeRoot?(this.LocalTypeRoot=e,this.LocalTypeRoot):(this.LocalTypeRoot=this.LocalTypeRoot.addTypeNode(e,this.LocalTypeRoot,this.LocalTypeRoot.height),this.LocalTypeRoot)}))}static addConceptToTree(e){if(0!=e.typeId){var t=new i.x(e.typeId,e,null,null);this.addNodeToTree(t)}}static removeConceptType(e,t){this.LocalTypeRoot&&(this.LocalTypeRoot=this.LocalTypeRoot.removeNodeWithVariants(this.LocalTypeRoot,e,t))}static getNodeFromTree(e){return this.LocalTypeRoot?this.LocalTypeRoot.getFromNode(e,this.LocalTypeRoot):this.LocalTypeRoot}static getTypeVariantsFromTree(e){var t=this.getNodeFromTree(e),n=[];if(t){n.push(null==t?void 0:t.value);for(let e=0;e<t.variants.length;e++)n.push(t.variants[e].value);return n}}static waitForDataToLoad(){return l(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(o.B.isLocalTypeLoaded)return e("done");setTimeout(d.checkFlag,1e3,e)}static getTypeVariantsFromTreeWithUserId(e,t){return l(this,void 0,void 0,(function*(){var n=[],o=this.getNodeFromTree(e);if(o){console.log("this is the node to type",o),o.value.userId!=t&&999!=o.value.userId||n.push(null==o?void 0:o.value);for(let e=0;e<o.variants.length;e++)o.variants[e].value.userId!=t&&999!=o.value.userId||n.push(o.variants[e].value)}return n}))}}d.LocalTypeRoot=null;var u=n(6416),h=n(9639),p=n(7820),f=n(4864),y=n(628),v=n(2830),g=n(3278),m=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class C{constructor(){this.name="conceptsArray"}static AddConcept(e){0!=e.id&&(c.addConceptToTree(e),a.addConceptToTree(e),d.addConceptToTree(e),this.localconceptsArray.push(e))}static AddPermanentConcept(e){0!=e.id&&(c.removeNodeFromTree(e.ghostId),a.removeConceptType(e.characterValue,e.ghostId),d.removeConceptType(e.typeId,e.ghostId),p.G.addConceptToTree(e),h.I.AddConcept(e),(0,v.AddGhostConcept)(e,e.userId,g.b.sessionId))}static RemoveConcept(e){return m(this,void 0,void 0,(function*(){try{0!=e.id&&(c.removeNodeFromTree(e.ghostId),a.removeConceptType(e.characterValue,e.ghostId),d.removeConceptType(e.typeId,e.ghostId))}catch(e){throw e}}))}static RemoveConceptById(e){return m(this,void 0,void 0,(function*(){try{let t=yield C.GetConcept(e);0!=t.id&&(c.removeNodeFromTree(e),a.removeConceptType(t.characterValue,t.ghostId),d.removeConceptType(t.typeId,t.ghostId),y.H.RemoveConcept(t))}catch(e){throw e}}))}static AddConceptToMemory(e){0!=e.id&&(c.addConceptToTree(e),a.addConceptToTree(e),d.addConceptToTree(e))}static GetConcept(e){return m(this,void 0,void 0,(function*(){var t=(0,u.u)(),n=yield c.getNodeFromTree(e);if(null==n?void 0:n.value){var o=n.value;o&&(t=o)}return t}))}static UpdateConceptSyncStatus(e){return m(this,void 0,void 0,(function*(){c.updateSyncStatus(e)}))}static GetConceptByGhostId(e){return m(this,void 0,void 0,(function*(){var t=(0,u.u)(),n=yield p.G.getNodeFromTree(e);if(null==n?void 0:n.value){var o=n.value;o&&(t=o)}return t}))}static GetConceptByCharacter(e){return m(this,void 0,void 0,(function*(){var t=(0,u.u)(),n=a.getNodeFromTree(e);return n&&(t=n.value),t}))}static GetConceptByCharacterAndTypeLocal(e,t){return m(this,void 0,void 0,(function*(){var n=(0,u.u)(),o=yield a.getCharacterAndTypeFromTree(e,t);return o&&(n=o.value),n}))}static GetConceptByCharacterAndCategoryLocal(e,t){return m(this,void 0,void 0,(function*(){var n=(0,u.u)(),o=yield a.getCharacterAndCategoryFromTree(e,t);return o&&(n=o.value),n}))}static GetConceptsByTypeId(e){let t=[];for(var n=0;n<this.localconceptsArray.length;n++)this.localconceptsArray[n].typeId==e&&t.push(this.localconceptsArray[n]);return t}static GetConceptsByTypeIdAndUser(e,t){return m(this,void 0,void 0,(function*(){let n=[];return n=yield d.getTypeVariantsFromTreeWithUserId(e,t),n}))}static ClearData(){return m(this,void 0,void 0,(function*(){this.localconceptsArray=[],f.G.connectionArray=[]}))}getName(){return this.name}}C.localconceptsArray=[]},4864:(e,t,n)=>{n.d(t,{G:()=>a});var o=n(2155),i=n(8286),r=n(205),c=n(628),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class a{constructor(){this.name="Connection Array"}static CheckContains(e){for(var t=!1,n=0;n<this.connectionArray.length;n++)this.connectionArray[n].id==e.id&&(t=!0);return t}static AddConnection(e){this.CheckContains(e)&&this.RemoveConnection(e),e.id,this.connectionArray.push(e)}static AddConnectionToMemory(e){this.CheckContains(e)&&this.RemoveConnection(e),this.connectionArray.push(e)}static AddToDictionary(e){this.connectionDictionary[e.id]=e}static RemoveConnection(e){for(var t=0;t<this.connectionArray.length;t++)this.connectionArray[t].id==e.id&&this.connectionArray.splice(t,1);e.id}static RemoveConnectionById(e){for(var t=0;t<this.connectionArray.length;t++)this.connectionArray[t].id==e&&this.connectionArray.splice(t,1);c.H.RemoveConnectionById(e)}static AddPermanentConnection(e){e.id>0&&i.d.AddConnection(function(e){let t=new o.N(0,0,0,0,0,0,0);return t.ofTheConceptId=e.ofTheConceptId,t.toTheConceptId=e.toTheConceptId,t.typeId=e.typeId,t.orderId=e.orderId,t.id=e.id,t}(e))}static GetConnection(e){var t;t=null;for(var n=0;n<this.connectionArray.length;n++)this.connectionArray[n].id==e&&(t=this.connectionArray[n]);return t}static waitForDataToLoad(){return s(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(r.B.isLocalConnectionLoaded)return e("done");setTimeout(a.checkFlag,1e3,e)}static GetConnectionsOfCompositionLocal(e){return s(this,void 0,void 0,(function*(){var t=[];try{for(var n=0;n<this.connectionArray.length;n++)this.connectionArray[n].typeId==e&&t.push(this.connectionArray[n]);return t}catch(e){return t}}))}static GetConnectionOfCompositionAndTypeLocal(e,t){return s(this,void 0,void 0,(function*(){var n=[];try{for(var o=0;o<this.connectionArray.length;o++)this.connectionArray[o].typeId==e&&this.connectionArray[o].ofTheConceptId==t&&n.push(this.connectionArray[o]);return n}catch(e){return n}}))}getName(){return this.name}}a.connectionArray=[],a.connectionDictionary=[]},7820:(e,t,n)=>{n.d(t,{G:()=>c});var o=n(205),i=n(2515),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class c{static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static addConceptToTree(e){var t=new i.x(e.ghostId,e,null,null);this.addNodeToTree(t)}static waitForDataToLoad(){return r(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(o.B.isLocalDataLoaded)return e("done");setTimeout(c.checkFlag,1e3,e)}static getNodeFromTree(e){return r(this,void 0,void 0,(function*(){return this.root?this.root.getFromNode(e,this.root):null}))}static removeNodeFromTree(e){return r(this,void 0,void 0,(function*(){this.root&&(this.root=this.root.removeNode(this.root,e))}))}}c.root=null},5257:(e,t,n)=>{n.d(t,{R:()=>c});var o=n(9003),i=n(3075),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class c{static AddConceptId(e){this.localId=e.value,(0,o.kH)("localid",e)}static getConceptId(){return r(this,void 0,void 0,(function*(){try{if(this.localId){if(this.ReservedLocalId.length<5){yield(0,i.EO)().then((()=>{let e=this.localId;for(let t=1;t<10;t++){let n=this.localId-t;this.ReservedLocalId.push(n),e=n}this.AddConceptId({id:0,value:e})})).catch((e=>(console.log(" getid: cannot get the id from indexdb"),-Math.floor(1e8*Math.random()))));let e=this.ReservedLocalId[0];return this.ReservedLocalId.shift(),e}{let e=this.ReservedLocalId[0];return this.ReservedLocalId.shift(),e}}return yield(0,i.EO)().then((()=>{let e=this.localId;for(let t=1;t<10;t++){let n=this.localId-t;this.ReservedLocalId.push(n),e=n}this.AddConceptId({id:0,value:e})})),this.getConceptId()}catch(e){return console.log(" getid: this is the eror in concept",e),-Math.floor(1e8*Math.random())}}))}static AddConnectionId(e){this.localConnectionId=e.value}static getConnectionId(){return r(this,void 0,void 0,(function*(){try{if(this.localConnectionId){if(this.ReservedConnectionId.length<5){yield(0,i.xd)().then((()=>{let e=this.localConnectionId;for(let t=1;t<10;t++){let n=this.localConnectionId-t;this.ReservedConnectionId.push(n),e=n}})).catch((e=>(console.log("this is the new event",e),-Math.floor(1e8*Math.random()))));let e=this.ReservedConnectionId[0];return this.ReservedConnectionId.shift(),e}{let e=this.ReservedConnectionId[0];return this.ReservedConnectionId.shift(),e}}return yield(0,i.xd)().then((()=>{let e=this.localConnectionId;for(let t=1;t<10;t++){let n=this.localConnectionId-t;this.ReservedConnectionId.push(n),e=n}this.AddConnectionId({id:1,value:e})})),this.getConnectionId()}catch(e){return-Math.floor(1e8*Math.random())}}))}}c.ReservedLocalId=[],c.ReservedConnectionId=[]},628:(e,t,n)=>{n.d(t,{H:()=>y});var o=n(9581),i=n(3278),r=n(2830),c=n(1863),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const a=(e,t)=>s(void 0,void 0,void 0,(function*(){let n={concepts:[],connections:[]};try{const r=new Headers;let s={concepts:e,connections:t};r.set("Content-Type","application/json"),r.set("Authorization","Bearer "+i.b.BearerAccessToken),r.set("Accept","application/json"),r.set("Randomizer",o.B.getRandomizer().toString());const a=yield fetch(o.B.CreateGhostConceptApiUrl(),{method:"POST",headers:r,body:JSON.stringify(s)});if(!a.ok)throw(0,c.ry)(a),new Error(`Error! status: ${a.status}`);const l=yield a.json();return n.concepts=l.concepts,n.connections=l.connections,n}catch(e){throw e instanceof Error?console.log("Create the concept api error message: ",e.message):console.log("Create the concept api unexpected error: ",e),e}}));function l(e,t){const n=[];for(let o=0;o<e.length;o+=t){const i=e.slice(o,o+t);n.push(i)}return n}const d=(...e)=>s(void 0,[...e],void 0,(function*(e=[]){return yield Promise.all(e.map((e=>{let t=JSON.parse(JSON.stringify(e));return delete t.type,delete t.ofConcept,delete t.toConcept,t})))}));var u=n(9003),h=n(9736),p=n(4864),f=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class y{static CheckContains(e){for(var t=!1,n=0;n<this.conceptsSyncArray.length;n++)this.conceptsSyncArray[n].id==e.id&&(t=!0);return t}static SyncDataDelete(e){for(var t=0;t<this.conceptsSyncArray.length;t++)e==this.conceptsSyncArray[t].id&&this.conceptsSyncArray.splice(t,1);for(t=0;t<this.connectionSyncArray.length;t++)this.connectionSyncArray[t].ofTheConceptId!=e&&this.connectionSyncArray[t].toTheConceptId!=e&&this.connectionSyncArray[t].typeId!=e||this.connectionSyncArray.splice(t,1)}static CheckContainsConnection(e){for(var t=!1,n=0;n<this.connectionSyncArray.length;n++)this.connectionSyncArray[n].id==e.id&&(t=!0);return t}static AddConcept(e){try{let t=!1;0!=y.CheckIfTheConceptIdExists(e.id,this.conceptsSyncArray).id&&(t=!0),t||this.conceptsSyncArray.push(e)}catch(e){throw e}}static RemoveConcept(e){for(var t=0;t<this.conceptsSyncArray.length;t++)this.conceptsSyncArray[t].id==e.id&&this.conceptsSyncArray.splice(t,1)}static SyncDataOnline(e,t){return f(this,void 0,void 0,(function*(){let n=performance.now();try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("LocalSyncData__SyncDataOnline",{transactionId:e})).data}catch(e){console.error("LocalSyncData__SyncDataOnline sw error: ",e),(0,r.handleServiceWorkerException)(e)}let n=[],o=[];if(e&&this.transactionCollections.some((t=>t.id==e))){const t=this.transactionCollections.find((t=>t.id==e));if(this.transactionCollections=this.transactionCollections.filter((t=>t.id!=e)),this.transactionCollections=this.transactionCollections.filter((e=>new Date(e.createdDate).getTime()>(new Date).getTime()-6048e5)),!t)return;n=t.data.concepts.slice(),o=t.data.connections.slice()}else Array.isArray(null==t?void 0:t.concepts)&&Array.isArray(null==t?void 0:t.connections)?(n=t.concepts.filter((e=>this.conceptsSyncArray.some((t=>e.id==t.id||e.ghostId==t.ghostId)))).slice(),o=t.connections.filter((e=>this.connectionSyncArray.some((t=>e.id==t.id||e.ghostId==t.ghostId)))).slice(),this.conceptsSyncArray=this.conceptsSyncArray.filter((e=>!t.concepts.some((t=>e.id==t.id||e.ghostId==t.ghostId)))),this.connectionSyncArray=this.connectionSyncArray.filter((e=>!t.connections.some((t=>e.id==t.id||e.ghostId==t.ghostId))))):(console.warn("Syncing this way has been Depreceted in service worker."),console.info("Only if serive worker is not running"),n=this.conceptsSyncArray.slice()||[],o=this.connectionSyncArray.slice()||[]);this.connectionSyncArray=[],this.conceptsSyncArray=[];let i=[];for(let e=0;e<n.length;e++)i.push(n[e]),yield h.v.UpdateConceptSyncStatus(n[e].id);yield this.UpdateConceptListToIncludeRelatedConcepts(o,i);let u=yield function(e,t){return s(this,void 0,void 0,(function*(){const n=r.Logger.logfunction("CreateTheGhostConceptApi",[e.length,t.length]);try{const o=1e3;let i={concepts:[],connections:[]};const c=yield d(e),s=yield d(t);if(e.length+t.length<=2*o){const e=yield a(c,s);return Array.isArray(null==e?void 0:e.concepts)&&(i.concepts=[...i.concepts,...e.concepts]),Array.isArray(null==e?void 0:e.connections)&&(i.connections=[...i.connections,...e.connections]),r.Logger.logUpdate(n),i}const u=l(c,o),h=l(s,o),p=[],f=[];for(let e=0;e<u.length;e++){const t=u[e];p.push(a(t,[]))}const y=yield Promise.all(p);for(let e=0;e<y.length;e++){const t=y[e];Array.isArray(null==t?void 0:t.concepts)&&(i.concepts=[...i.concepts,...t.concepts]),Array.isArray(null==t?void 0:t.connections)&&(i.connections=[...i.connections,...t.connections])}for(let e=0;e<h.length;e++){const t=h[e];f.push(a([],t))}const v=yield Promise.all(f);for(let e=0;e<v.length;e++){const t=v[e];Array.isArray(null==t?void 0:t.concepts)&&(i.concepts=[...i.concepts,...t.concepts]),Array.isArray(null==t?void 0:t.connections)&&(i.connections=[...i.connections,...t.connections])}return r.Logger.logUpdate(n),i}catch(e){throw console.log(e),(0,c.ey)(n,"CreateTheGhostConceptApi",e),e}}))}(i,o),f=u.concepts,y=u.connections;for(let e=0;e<f.length;e++)h.v.AddPermanentConcept(f[e]);for(let e=0;e<y.length;e++)p.G.AddPermanentConnection(y[e]);return n}catch(e){throw r.Logger.logError(n,"unknown",void 0,"unknown",void 0,500,e,"SyncDataOnline",[],"unknown",void 0),e}}))}static ConvertGhostIdsInConnections(e){var t,n,o;for(let i=0;i<e.length;i++){let r=e[i].ofTheConceptId,c=e[i].toTheConceptId,s=e[i].typeId,a=null!==(t=y.ghostIdMap.get(r))&&void 0!==t?t:r,l=null!==(n=y.ghostIdMap.get(c))&&void 0!==n?n:c,d=null!==(o=y.ghostIdMap.get(s))&&void 0!==o?o:s;e[i].ofTheConceptId=a,e[i].toTheConceptId=l,e[i].typeId=d}}static UpdateConceptListToIncludeRelatedConcepts(e,t){return f(this,void 0,void 0,(function*(){for(let n=0;n<e.length;n++){let o=e[n].ofTheConceptId,i=e[n].toTheConceptId,r=e[n].typeId;if(o<0){let i=this.CheckIfTheConceptIdExists(o,t);0==i.id&&(i=yield h.v.GetConceptByGhostId(o),0!=i.id?i.id!=i.ghostId&&(e[n].ofTheConceptId=i.id):(i=yield h.v.GetConcept(o),this.AddConceptIfDoesNotExist(i,t)))}if(i<0){let o=this.CheckIfTheConceptIdExists(i,t);0==o.id&&(o=yield h.v.GetConceptByGhostId(i),0!=o.id?o.id!=o.ghostId&&(e[n].toTheConceptId=o.id):(o=yield h.v.GetConcept(i),this.AddConceptIfDoesNotExist(o,t)))}if(r<0){let o=this.CheckIfTheConceptIdExists(r,t);0==o.id&&(o=yield h.v.GetConceptByGhostId(r),0!=o.id?o.id!=o.ghostId&&(e[n].typeId=o.id):(o=yield h.v.GetConcept(r),this.AddConceptIfDoesNotExist(o,t)))}}}))}static AddConceptIfDoesNotExist(e,t=[]){let n=!1;for(let o=0;o<t.length;o++)e.ghostId==t[o].ghostId&&(n=!0);n||t.push(e)}static CheckIfTheConceptIdExists(e,t=[]){let n=(0,r.CreateDefaultLConcept)();for(let o=0;o<t.length;o++)e!=t[o].ghostId&&e!=t[o].id||(n=t[o]);return n}static AddConnection(e){this.connectionSyncArray.push(e)}static RemoveConnection(e){for(var t=0;t<this.connectionSyncArray.length;t++)this.connectionSyncArray[t].id==e.id&&this.connectionSyncArray.splice(t,1)}static RemoveConnectionById(e){for(var t=0;t<this.connectionSyncArray.length;t++)this.connectionSyncArray[t].id==e&&this.connectionSyncArray.splice(t,1)}static syncDataLocalDb(){return f(this,void 0,void 0,(function*(){if(this.conceptsSyncArray.length>0){for(let e=0;e<this.conceptsSyncArray.length;e++)(0,u.kH)("localconcept",this.conceptsSyncArray[e]);this.conceptsSyncArray=[]}if(this.connectionSyncArray.length>0){for(let e=0;e<this.connectionSyncArray.length;e++)(0,u.kH)("localconnection",this.connectionSyncArray[e]);this.connectionSyncArray=[]}return"done"}))}static initializeTransaction(e){return f(this,void 0,void 0,(function*(){try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("LocalSyncData__initializeTransaction",{transactionId:e})).data}catch(e){console.error("LocalSyncData__initializeTransaction sw error: ",e),(0,r.handleServiceWorkerException)(e)}if(this.transactionCollections.some((t=>t.id==e)))return;this.transactionCollections.push({id:e,data:{concepts:[],connections:[]},createdDate:(new Date).toISOString()})}catch(e){console.log("error in initializeTransaction",e)}}))}static markTransactionActions(e,t){return f(this,void 0,void 0,(function*(){try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("LocalSyncData__markTransactionActions",{transactionId:e,actions:t})).data}catch(e){console.error("LocalSyncData__markTransactionActions sw error: ",e),(0,r.handleServiceWorkerException)(e)}this.transactionCollections=this.transactionCollections.map((n=>n.id==e?Object.assign(Object.assign({},n),{data:JSON.parse(JSON.stringify(t))}):n)),this.conceptsSyncArray=this.conceptsSyncArray.filter((e=>!t.concepts.some((t=>t.id==e.id||t.ghostId==e.id)))),this.connectionSyncArray=this.connectionSyncArray.filter((e=>!t.connections.some((t=>t.id==e.id||t.ghostId==e.id))))}catch(e){console.log("error in markTransactionActions",e)}}))}static rollbackTransaction(e,t){return f(this,void 0,void 0,(function*(){try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("LocalSyncData__rollbackTransaction",{transactionId:e,actions:t})).data}catch(e){console.error("LocalSyncData__rollbackTransaction sw error: ",e),(0,r.handleServiceWorkerException)(e)}if(this.transactionCollections.some((t=>t.id==e)))return;this.transactionCollections=this.transactionCollections.filter((t=>t.id!=e))}catch(e){console.log("LocalSyncData, roll",e)}}))}}y.conceptsSyncArray=[],y.connectionSyncArray=[],y.ghostIdMap=new Map,y.transactionCollections=[]},6731:(e,t,n)=>{n.d(t,{b:()=>o});class o{constructor(e,t,n,o){this.variants=[],this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o,this.currentNode=null}addCurrentNode(e,t){return null==t?t=e:(e.value.typeId!=t.value.typeId&&(t.currentNode=this.addCurrentNode(e,t.currentNode)),t)}addCurrentNodeType(e,t){if(null==t)return e;let n=!1;for(let o=0;o<t.variants.length;o++)t.variants[o].value.id==e.value.id&&(n=!0);return n||t.variants.push(e),t}addNode(e,t,n){if(null==t)return e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return t;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}checkIfIdsInNode(e,t,n,o){if(e){if(t.includes(e.key)){n.push(e.value);let o=t.indexOf(e.key);t.splice(o,1)}e.leftNode&&this.checkIfIdsInNode(e.leftNode,t,n,o),e.rightNode&&this.checkIfIdsInNode(e.rightNode,t,n,o)}}addCharacterNode(e,t,n){if(""!=e.value.characterValue){if(null==t)return e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addCharacterNode(e,o,n);else{if(!(t.key<e.key))return t.key==e.key&&""!=t.key&&t.value.id!=e.value.id&&t.addCurrentNodeType(e,t),t;t.rightNode=this.addCharacterNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key){return this.rightRotate(t)}if(e.key>t.leftNode.key){return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key){return this.leftRotate(t)}if(e.key<t.rightNode.key){return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}}}return t}addTypeNode(e,t,n){if(0!=e.value.typeId){if(null==t)return console.log("adding the type node to the tree",e),e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addTypeNode(e,o,n);else{if(!(t.key<e.key))return console.log("adding the type node to the tree down",e),t.key==e.key&&0!=t.key&&t.value.id!=e.value.id&&t.addCurrentNodeType(e,t),console.log("adding the type node to the tree last",t),t;t.rightNode=this.addTypeNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key){return this.rightRotate(t)}if(e.key>t.leftNode.key){return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key){return this.leftRotate(t)}if(e.key<t.rightNode.key){return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}}}return t}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){return t?e==t.key?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}getCharacterFromNode(e,t){return t?e==t.key?t:e<t.key?this.getCharacterFromNode(e,t.leftNode):e>t.key?this.getCharacterFromNode(e,t.rightNode):t:t}getCharacterFromNodeUpdated(e,t){var n;return t?e==t.key||51==(null===(n=t.value)||void 0===n?void 0:n.typeId)?t:e<t.key?this.getCharacterFromNode(e,t.leftNode):e>t.key?this.getCharacterFromNode(e,t.rightNode):t:t}getFromNodeWithCharacterAndType(e,t,n){if(e=`${e}`,n){if(e==n.key){if(e==n.value.characterValue&&t==n.value.typeId)return n;for(let e=0;e<n.variants.length;e++)if(n.variants[e].value.typeId==t)return n.variants[e]}else{if(e<n.key)return this.getFromNodeWithCharacterAndType(e,t,n.leftNode);if(e>n.key)return this.getFromNodeWithCharacterAndType(e,t,n.rightNode)}return null}return n}getFromNodeWithCharacterAndCategory(e,t,n){if(e=`${e}`,n){if(e==n.key){if(e==n.value.characterValue&&t==n.value.categoryId)return n;for(let e=0;e<n.variants.length;e++)if(n.variants[e].value.categoryId==t)return n.variants[e]}else{if(e<n.key)return this.getFromNodeWithCharacterAndCategory(e,t,n.leftNode);if(e>n.key)return this.getFromNodeWithCharacterAndCategory(e,t,n.rightNode)}return null}return n}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.variants=t.variants,e.currentNode=t.currentNode,e.rightNode=this.removeNode(e.rightNode,t.key),e}}removeNodeWithVariants(e,t,n){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNodeWithVariants(e.leftNode,t,n),e;if(e.key<t)return e.rightNode=this.removeNodeWithVariants(e.rightNode,t,n),e;if(e.variants.length>0)if(e.value.id==n){let t=e.variants[0];if(t)return e.value=t.value,e.key=t.key,e.currentNode=t.currentNode,e.variants.splice(0,1),e}else for(let t=0;t<e.variants.length;t++)if(n==e.variants[t].value.id)return e.variants.splice(t,1),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.variants=t.variants,e.currentNode=t.currentNode,e.rightNode=this.removeNodeWithVariants(e.rightNode,t.key,n),e}}countNodeBelow(e){return null==e?0:1+this.countNodeBelow(e.leftNode)+this.countNodeBelow(e.rightNode)}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}},5976:(e,t,n)=>{n.d(t,{p:()=>l,B:()=>a});var o=n(9581),i=n(3518),r=n(1863),c=n(2830),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class a{static getId(){return s(this,void 0,void 0,(function*(){this.ids.length<5&&(yield function(){var e,t,n,s,l=arguments;return e=this,t=void 0,s=function*(){const e=c.Logger.logfunction("GetReservedIds",l);try{let t=(0,i.Xr)("application/x-www-form-urlencoded");const n=yield fetch(o.B.GetReservedIdUrl(),{method:"GET",headers:t});if(!n.ok)throw(0,r.ry)(n),new Error(`Error! status: ${n.status}`);const s=yield n.json();for(let e=0;e<s.length;e++)a.AddId(s[e]);c.Logger.logUpdate(e)}catch(t){t instanceof Error?console.log("get reserved ids error message: ",t.message):console.log("get reserved ids  unexpected error: ",t),(0,r.Mb)(t,o.B.GetReservedIdUrl()),(0,r.ey)(e,"GetReservedIds",t)}},new((n=void 0)||(n=Promise))((function(o,i){function r(e){try{a(s.next(e))}catch(e){i(e)}}function c(e){try{a(s.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}a((s=s.apply(e,t||[])).next())}))}());var e=this.ids[0];return this.ids.shift(),e}))}static AddId(e){this.ids.includes(e)||this.ids.push(e)}}a.ids=[];class l{static getId(){return s(this,void 0,void 0,(function*(){this.connectionIds.length<5&&(yield function(){var e,t,n,s,a=arguments;return e=this,t=void 0,s=function*(){const e=c.Logger.logfunction("GetReservedConnectionIds",a);try{let t=(0,i.Xr)("application/x-www-form-urlencoded");const n=yield fetch(o.B.GetReservedConnectionIdUrl(),{method:"GET",headers:t});if(!n.ok)throw(0,r.ry)(n),new Error(`Error! status: ${n.status}`);const s=yield n.json();for(let e=0;e<s.length;e++)l.AddId(s[e]);c.Logger.logUpdate(e)}catch(t){t instanceof Error?console.log("get reserved connection ids error message: ",t.message):console.log("get reserved connection ids  unexpected error: ",t),(0,r.Mb)(t,o.B.GetReservedConnectionIdUrl()),(0,r.ey)(e,"GetReservedConnectionIds",t)}},new((n=void 0)||(n=Promise))((function(o,i){function r(e){try{a(s.next(e))}catch(e){i(e)}}function c(e){try{a(s.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}a((s=s.apply(e,t||[])).next())}))}());var e=this.connectionIds[0];return this.connectionIds.shift(),e}))}static AddId(e){this.connectionIds.includes(e)||this.connectionIds.push(e)}}l.connectionIds=[]},7273:(e,t,n)=>{n.d(t,{z:()=>i});var o=n(9581);class i{constructor(e,t,n,i){this.url=o.B.BASE_URL,this.message=e,this.ok=t,this.status=n,this.data=i}getMessage(){return this.message}setMessage(e){return this.message=e,this}getStatus(){return this.status}setStatus(e){return this.status=e,this}getData(){return this.data}setData(e){return this.data=e,this}getOk(){return this.ok}setOk(e){return this.ok=e,this}getUrl(){return this.url}setUrl(e){return this.url=e,this}}},3278:(e,t,n)=>{n.d(t,{b:()=>o});class o{}o.BearerAccessToken="",o.sessionId=998},2299:(e,t,n)=>{n.d(t,{B:()=>o});class o{constructor(e){this.id=1,this.isOnlineSync=!1,this.isOnlineSync=e}}},442:(e,t,n)=>{n.d(t,{Y:()=>u});var o=n(1167),i=n(2155),r=n(9581),c=n(3518),s=n(1863),a=n(9639),l=n(8286),d=n(2830);class u{static CheckContains(e){for(var t=!1,n=0;n<this.conceptsSyncArray.length;n++)this.conceptsSyncArray[n].id==e.id&&(t=!0);return t}static SyncDataDelete(e){for(var t=0;t<this.conceptsSyncArray.length;t++)e==this.conceptsSyncArray[t].id&&this.conceptsSyncArray.splice(t,1);for(t=0;t<this.connectionSyncArray.length;t++)this.connectionSyncArray[t].ofTheConceptId!=e&&this.connectionSyncArray[t].toTheConceptId!=e&&this.connectionSyncArray[t].typeId!=e||this.connectionSyncArray.splice(t,1)}static CheckContainsConnection(e){for(var t=!1,n=0;n<this.connectionSyncArray.length;n++)this.connectionSyncArray[n].id==e.id&&(t=!0);return t}static AddConcept(e){this.conceptsSyncArray.push(e)}static RemoveConcept(e){for(var t=0;t<this.conceptsSyncArray.length;t++)this.conceptsSyncArray[t].id==e.id&&this.conceptsSyncArray.splice(t,1)}static AddConnection(e){this.connectionSyncArray.push(e)}static RemoveConnection(e){for(var t=0;t<this.connectionSyncArray.length;t++)this.connectionSyncArray[t].id==e.id&&this.connectionSyncArray.splice(t,1)}static SyncDataOnline(){return e=this,t=void 0,u=function*(){if(d.serviceWorker)try{return(yield(0,d.sendMessage)("SyncData__SyncDataOnline",{})).data}catch(e){console.error("SyncData__SyncDataOnline sw error: ",e),(0,d.handleServiceWorkerException)(e)}for(let e=0;e<this.conceptsSyncArray.length;e++)a.I.AddConcept(this.conceptsSyncArray[e]);for(let e=0;e<this.connectionSyncArray.length;e++)l.d.AddConnection(this.connectionSyncArray[e]);if(this.conceptsSyncArray.length>0){let e=this.conceptsSyncArray.slice();this.conceptsSyncArray=[],(0,o.Y)(e)}if(this.connectionSyncArray.length>0){let e=this.connectionSyncArray.slice();this.connectionSyncArray=[],yield function(e){return t=this,n=void 0,a=function*(){let t=new i.N(0,0,0,0,0,0,0);try{var n=(0,c.Xr)(),o=JSON.stringify(e);const i=yield fetch(r.B.CreateTheConnectionUrl(),{method:"POST",headers:n,body:o});return i.ok?yield i.json():(console.log("Create the connection error message: ",i.status),(0,s.ry)(i)),t}catch(e){throw e instanceof Error?console.log("Create the connection error message: ",e.message):console.log(" Create the connection unexpected error: ",e),e}},new((o=void 0)||(o=Promise))((function(e,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function c(e){try{s(a.throw(e))}catch(e){i(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,c)}s((a=a.apply(t,n||[])).next())}));var t,n,o,a}(e)}return"done"},new((n=void 0)||(n=Promise))((function(o,i){function r(e){try{s(u.next(e))}catch(e){i(e)}}function c(e){try{s(u.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}s((u=u.apply(e,t||[])).next())}));var e,t,n,u}}u.conceptsSyncArray=[],u.connectionSyncArray=[]},9003:(e,t,n)=>{n.d(t,{S5:()=>l,kH:()=>u,qI:()=>a});var o=n(1863),i=n(2830),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};let c=10;class s{}function a(e){const t=i.Logger.logfunction("openDatabase",arguments);return new Promise((function(n,r){s.db&&(i.Logger.logUpdate(t),n(s.db));let l=i.BaseUrl.BASE_URL+"_FreeSchemaLocal"+i.BaseUrl.BASE_APPLICATION;const u=indexedDB.open(l,c);u.onupgradeneeded=e=>{var t=e.target.result,o="localconcept",r="localconnection",s="localid";console.log("this is the version upgrade",c),t.objectStoreNames.contains(o)&&t.deleteObjectStore(o),t.objectStoreNames.contains(r)&&t.deleteObjectStore(r),t.objectStoreNames.contains(s)&&t.deleteObjectStore(s),t.objectStoreNames.contains(o)||(t.createObjectStore(o,{keyPath:"id"}).transaction.oncomplete=e=>{}),t.objectStoreNames.contains(r)||(t.createObjectStore(r,{keyPath:"id"}).transaction.oncomplete=e=>{}),t.objectStoreNames.contains(s)||(t.createObjectStore(s,{keyPath:"id"}).transaction.oncomplete=e=>{d(s,{id:0,value:-100}),d(s,{id:1,value:-200}),d(s,{id:3,value:i.BaseUrl.getRandomizer()})}),n(t)},u.onerror=n=>{console.error("Why didn't you allow my web app to use IndexedDB?!",n),indexedDB.deleteDatabase(l),a(e),(0,o.ey)(t,"openDatabase",n),r(n)},u.onsuccess=function(e){var o=e.target;s.db=o.result,i.Logger.logUpdate(t),n(s.db)}}))}function l(e){var t=arguments;return r(this,void 0,void 0,(function*(){const n=i.Logger.logfunction("getObjectsFromLocalIndexDb",t);return new Promise((function(t,r){a(e).then((o=>{var r=[],c=o.transaction(e,"readwrite").objectStore(e).getAll();c.onsuccess=()=>{const e=c.result;for(var o=0;o<e.length;o++)r.push(e[o]);i.Logger.logUpdate(n),t(r)}})).catch((e=>{let t={status:400,ok:!1,message:"Cannot get objects from database because you cannot open the Local database",data:e};(0,o.ey)(n,"getObjectsFromLocalIndexDb",t),r(t)}))}))}))}function d(e,t){const n=i.Logger.logfunction("storeToDatabase",[e,"localindexdb"]);return new Promise((function(r,c){a(e).then((s=>{const a=s.transaction(e,"readwrite").objectStore(e).add(t);a.onsuccess=e=>{i.Logger.logUpdate(n),r(t)},a.onerror=i=>{let r={status:400,ok:!1,message:"Cannot store to the Local database "+e,data:i,body:t};(0,o.ey)(n,"storeToDatabase",r),c(r)}})).catch((e=>{let t={status:400,ok:!1,message:"Cannot store to database because you cannot open the Local database",data:e};(0,o.ey)(n,"storeToDatabase",t),c(t)}))}))}function u(e,t){const n=i.Logger.logfunction("UpdateToDatabase",arguments);return new Promise((function(r,c){a(e).then((s=>{const a=s.transaction(e,"readwrite").objectStore(e).put(t);a.onsuccess=e=>{i.Logger.logUpdate(n),r(t)},a.onerror=i=>{let r={status:400,ok:!1,message:"Cannot Update to the Local database"+e,data:i,body:t};(0,o.ey)(n,"UpdateToDatabase",r),c(r)}})).catch((e=>{let t={status:400,ok:!1,message:"Cannot update to database because you cannot open the Local database",data:e};(0,o.ey)(n,"UpdateToDatabase",t),c(t)}))}))}},3655:(e,t,n)=>{n.d(t,{El:()=>h,b8:()=>u,kH:()=>d,qI:()=>l,wh:()=>p});var o=n(2299),i=n(9581),r=n(2830),c=n(1863);let s=10;class a{}function l(e){const t=r.Logger.logfunction("openDatabase",[e,"indexdb"]);return new Promise((function(n,o){a.db&&(r.Logger.logUpdate(t),n(a.db));let d=i.B.BASE_URL+"_FreeSchema"+i.B.BASE_APPLICATION;const u=indexedDB.open(d,s);console.log("this is the update version",s,u),u.onupgradeneeded=e=>{let o=e.target.result,i="concept",c="connection",a="settings";console.log("this is the version update for index",s),o.objectStoreNames.contains(i)&&o.deleteObjectStore(i),o.objectStoreNames.contains(c)&&o.deleteObjectStore(c),o.objectStoreNames.contains(a)&&o.deleteObjectStore(a),o.objectStoreNames.contains(i)||(o.createObjectStore(i,{keyPath:"id"}).transaction.oncomplete=e=>{}),o.objectStoreNames.contains(c)||(o.createObjectStore(c,{keyPath:"id"}).transaction.oncomplete=e=>{}),o.objectStoreNames.contains(a)||(o.createObjectStore(a,{keyPath:"id"}).transaction.oncomplete=e=>{}),r.Logger.logUpdate(t),n(o)},u.onerror=n=>{console.error("Why didn't you allow my web app to use IndexedDB?!",n),indexedDB.deleteDatabase(d),l(e),(0,c.ey)(t,"openDatabase",n),o(n)},u.onsuccess=function(e){let o=e.target;a.db=o.result,r.Logger.logUpdate(t),n(a.db)}}))}function d(e,t){const n=r.Logger.logfunction("UpdateToDatabase",[e,"indexdb"]);return new Promise((function(o,i){l(e).then((s=>{const a=s.transaction(e,"readwrite").objectStore(e).put(t);a.onsuccess=e=>{r.Logger.logUpdate(n),o(t)},a.onerror=o=>{let r={status:400,ok:!1,message:"Cannot Update to the database"+e,data:o,body:t};(0,c.ey)(n,"UpdateToDatabase",r),i(r)}})).catch((e=>{let t={status:400,ok:!1,message:"Cannot update to database because you cannot open the database",data:e};(0,c.ey)(n,"UpdateToDatabase",t),i(t)}))}))}function u(){const e=r.Logger.logfunction("GetLastSettingsFromDatabase",["indexdb"]);return new Promise((function(t,n){let i="settings";l(i).then((s=>{let a=s.transaction(i,"readwrite").objectStore(i).getAll();a.onsuccess=()=>{let n=new o.B(!1),i=a.result;for(let e=0;e<i.length;e++)n=i[e];r.Logger.logUpdate(e),t(n)},a.onerror=t=>{(0,c.ey)(e,"GetLastSettingsFromDatabase",t),n(t)}})).catch((t=>{let o={status:400,ok:!1,message:"Cannot get last object from database because you cannot open the database",data:t};(0,c.ey)(e,"GetLastSettingsFromDatabase",o),n(o)}))}))}function h(e){const t=r.Logger.logfunction("AiUpdateFlag",["indexdb"]);return new Promise((function(n,o){let i="settings";l(i).then((s=>{const a=s.transaction(i,"readwrite").objectStore(i).put(e);a.onsuccess=o=>{r.Logger.logUpdate(t),n(e)},a.onerror=n=>{let i={status:400,ok:!1,message:"Cannot update AI flag",data:n,body:e};(0,c.ey)(t,"AiUpdateFlag",i),o(i)}})).catch((e=>{let n={status:400,ok:!1,message:"Cannot update AI flag because you cannot open the database",data:e};(0,c.ey)(t,"AiUpdateFlag",n),o(n)}))}))}function p(e,t){const n=r.Logger.logfunction("removeFromDatabase",[e,"indexdb"]);return new Promise((function(o,i){l(e).then((s=>{const a=s.transaction(e,"readwrite").objectStore(e).delete(Number(t));a.onsuccess=function(e){r.Logger.logUpdate(n),o(t)},a.onerror=t=>{let o={status:400,ok:!1,message:"Cannot remove from the database"+e,data:t};(0,c.ey)(n,"removeFromDatabase",o),i(o)}})).catch((e=>{let o={status:400,ok:!1,message:"Cannot remove from the database because you cannot open the database",data:e,body:t};(0,c.ey)(n,"removeFromDatabase",o),i(o)}))}))}},4485:(e,t,n)=>{function o(e=[],t){var n,o;let i=[],r=null===(n=t.type)||void 0===n?void 0:n.characterValue;if((null==r?void 0:r.startsWith("the_"))||(r="the_"+r),Array.isArray(e))for(let n=0;n<e.length;n++){let c=null===(o=e[n].type)||void 0===o?void 0:o.characterValue;(null==c?void 0:c.startsWith("the_"))||(c="the_"+c),t.typeId!=e[n].typeId&&r!=c||i.push(e[n])}return i}function i(e=[],t){let n=[],o=t.typeCharacter;if((null==o?void 0:o.startsWith("the_"))||(o="the_"+o),Array.isArray(e))for(let i=0;i<e.length;i++){let r=e[i].typeCharacter;(null==r?void 0:r.startsWith("the_"))||(r="the_"+r),t.typeId!=e[i].typeId&&o!=r||n.push(e[i])}return n}function r(e=[],t){let n=[];if(Array.isArray(e)){const o=e.find((e=>e.toTheConceptId==t));o&&n.push(o);const i=e.find((e=>e.ofTheConceptId==t));i&&n.push(i)}return n}function c(e=[],t){let n=[];if(Array.isArray(e)){const o=e.find((e=>e.toTheConceptId==t));o&&n.push(o);const i=e.find((e=>e.ofTheConceptId==t));i&&n.push(i)}return n}n.d(t,{gt:()=>c,nm:()=>i,vo:()=>o,wS:()=>r}),n(2155),n(7282)},9934:(e,t,n)=>{function o(e,t){return-1===e.indexOf(t)&&e.push(t),e}n.d(t,{A:()=>o})},9700:(e,t,n)=>{n.d(t,{R:()=>d,V:()=>l});var o,i=n(2830),r=n(3278),c=n(1863),s=n(3518),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class l{static startAutoSync(){this.autoSyncInterval?console.warn("Auto-sync is already running."):(this.nextSyncTime=Date.now()+this.SYNC_INTERVAL_MS,setInterval((()=>{const e=Date.now();this.nextSyncTime&&e>=this.nextSyncTime&&(this.nextSyncTime=e+this.SYNC_INTERVAL_MS,this.sendPackageLogsToServer(),this.sendApplicationLogsToServer())}),3e4))}static stopAutoSync(){null!==this.autoSyncInterval&&(clearInterval(this.autoSyncInterval),this.autoSyncInterval=null,this.nextSyncTime=null)}static setLogLevel(e){this.logLevel=e}static shouldLog(e){return this.LOG_LEVELS.indexOf(e)>=this.LOG_LEVELS.indexOf(this.logLevel)}static formatLogData(e,t,n){if(!this.shouldLog(e))return;const o=Object.assign({timestamp:(new Date).toLocaleString(),level:e,message:t},n);return this.packageLogsData.push(o),"ERROR"==e&&(this.sendPackageLogsToServer(),this.sendApplicationLogsToServer()),o}static log(e,t,n){if(this.logPackageActivationStatus)try{this.formatLogData(e,t,n||null)}catch(e){console.error("Error on Logger Log : ",e)}}static logUpdate(e){var t;try{if(!this.logPackageActivationStatus)return;if(!e)return void console.error("logUpdate failed: logData is undefined");const n=Date.now();e.startTime=null!==(t=e.startTime)&&void 0!==t?t:n;const o=n-e.startTime;e.responseTime=`${o} ms`,1==!e.serviceWorker&&(e.serviceWorker=!1)}catch(t){(0,c.ey)(e,"Logger.logUpdate",t)}}static logfunction(e,...t){const n=Date.now();if(this.logPackageActivationStatus){let o=t;const c=i.BaseUrl.getRandomizer(),s=r.b.sessionId;let a={startTime:n,functionName:e,functionParameters:o,requestFrom:i.BaseUrl.BASE_APPLICATION,sessionId:s,applicationId:c};return this.formatLogData("INFO","function called",a)}}static logError(e,t,n,o,i,r,c,s,a,l,u){try{const h=d("SessionId"),p={startTime:e,userId:t,operationType:n,requestFrom:o,requestIP:i,responseStatus:r,responseTime:`${(performance.now()-e).toFixed(3)}ms`,responseSize:c?`${JSON.stringify(c).length}`:"0",sessionId:null==h?void 0:h.toString(),functionName:s,functionParameters:a,userAgent:l,conceptsUsed:u};this.formatLogData("ERROR",`Information logged for ${s}`,p)}catch(e){console.error("Error on logError")}}static logApplication(e,t,n){if(this.logApplicationActivationStatus)try{const o={timestamp:(new Date).toLocaleString(),type:e,message:t,data:n||null};this.applicationLogsData.push(o)}catch(e){console.error("Failed to log application activity:",e)}}static sendApplicationLogsToServer(){return a(this,void 0,void 0,(function*(){const e=this.applicationLogsData;try{if(0===e.length)return;this.applicationLogsData=[],r.b.BearerAccessToken;const t=50;let n=(0,s.Xr)(),o=0;for(;0!=e.length;){console.log(`${o}`," = Current length of the storedLogs  : ",e.length);const r=e.slice(0,t),c=yield fetch(i.BaseUrl.PostLogger(),{method:"POST",headers:n,body:JSON.stringify({logType:this.appLogs,logData:r})});c.ok||(yield c.text()),e.splice(0,t),o+=t,o++}}catch(e){}}))}static sendPackageLogsToServer(){return a(this,void 0,void 0,(function*(){const e=this.packageLogsData;try{if(0===e.length)return;this.packageLogsData=[];const t=300;let n=0;for(;0!=e.length;){console.log(`${n}`," = Current length of the storedLogs  : ",e.length);const o=e.slice(0,t);let r=(0,s.Xr)();const c=yield fetch(i.BaseUrl.PostLogger(),{method:"POST",headers:r,body:JSON.stringify({logType:this.mftsccsBrowser,logData:o})});if(!c.ok)return void(yield c.text());e.splice(0,t),n++}}catch(e){}}))}static saveLogToLocalStorage(e,t){try{if(void 0===typeof localStorage)return void console.warn("Local Storage type undefined");{const n=JSON.parse((null===localStorage||void 0===localStorage?void 0:localStorage.getItem(e))||"[]");n.push(t),null===localStorage||void 0===localStorage||localStorage.setItem(e,JSON.stringify(n))}}catch(e){console.error("Error on saving log in localstorage"),this.log("ERROR","Error while saving log in local storage")}}static clearLogsFromLocalStorage(e){void 0!==typeof localStorage?null===localStorage||void 0===localStorage||localStorage.removeItem(e):console.warn("localStorage is not available")}}function d(e){try{let t=e+"=",n=decodeURIComponent(document.cookie).split(";");for(let e=0;e<n.length;e++){let o=n[e];for(;" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return""}catch(e){return console.error("Error on getcookie"),""}}o=l,l.logLevel="INFO",l.packageLogsData=[],l.applicationLogsData=[],l.LOG_LEVELS=["DEBUG","INFO","WARNING","ERROR"],l.SYNC_INTERVAL_MS=6e4,l.nextSyncTime=null,l.appLogs="app",l.mftsccsBrowser="mftsccs",l.logApplicationActivationStatus=!1,l.logPackageActivationStatus=!1,l.autoSyncInterval=null,o.startAutoSync()},1412:(e,t,n)=>{function o(e=[],t=[]){}n.d(t,{e:()=>o})},5898:(e,t,n)=>{n.d(t,{w:()=>s,V:()=>a});var o=n(7139),i=n(2830);class r{constructor(){this.conceptId=0,this.connectionTypeId=0,this.connectionType="",this.count=0}}var c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(e=[]){let t=[];if(e.length>0)for(let n=0;n<e.length;n++){let o=l(e[n]);t.push(o)}return t}function a(e){var t=arguments;return c(this,void 0,void 0,(function*(){const n=i.Logger.logfunction("GetConnectionTypeForCount",t);let r={};for(let t=0;t<e.length;t++){let n=yield(0,o.r)(e[t].connectionTypeId);e[t].connectionType=n.characterValue,r[e[t].conceptId]=e[t]}return i.Logger.logUpdate(n),r}))}function l(e){const t=e.split("_");if(3===t.length){let e=new r;return e.conceptId=Number(t[0]),e.connectionTypeId=Number(t[1]),e.count=Number(t[2]),e}throw new Error("Input string must contain exactly three parts separated by underscores.")}},1863:(e,t,n)=>{n.d(t,{ER:()=>c,Mb:()=>s,ey:()=>a,ry:()=>r});var o=n(2830),i=n(7273);function r(e){if(o.Logger.log("ERROR",e.statusText,{code:e.status,data:e.statusText}),401==e.status||406==e.status){let t=new i.z(e.statusText,!1,e.status,"");throw t.setUrl(e.url),t}if(500==e.status){let t=new i.z(e.statusText,!1,e.status,"");throw t.setUrl(e.url),t}}function c(e,t={}){if(o.Logger.log("ERROR",t.statusText,{code:e.status,data:e.status}),401==e.status||406==e.status){let n=new i.z(t.statusText,!1,e.status,"");throw n.setUrl(e.url),n}if(500==e.status){let n=new i.z(t.statusText,!1,e.status,"");throw n.setUrl(e.url),n}}function s(e,t=""){if(o.Logger.log("ERROR",e.message,{code:e.status,data:e.stack}),e.status){let n=new i.z(e.message,!1,e.status,e.stack);throw n.setUrl(t),n}{let n=new i.z(e.message,!1,500,e.stack);throw n.setUrl(t),n}}function a(e,t,n){var o;try{if(!e)return void console.error(`Error in ${t}: logData is undefined`);const i=Date.now();e.startTime=null!==(o=e.startTime)&&void 0!==o?o:i,e.responseTime=i-e.startTime+" ms",e.level="ERROR",e.errorMessage=(null==n?void 0:n.message)||"Unknown error occurred",console.error(`Error in function ${t}:`,n)}catch(e){console.error("Failed to handle package function error:",e)}}},176:(e,t,n)=>{n.d(t,{F4:()=>c,P6:()=>a,dp:()=>s});var o=n(2155),i=n(7282),r=n(6416);function c(e){var t,n;const o=(0,r.u)();return o.id=e.id,o.ghostId=e.ghostId,o.userId=e.userId,o.accessId=e.accessId,o.categoryId=e.categoryId,o.characterValue=e.characterValue,o.entryTimeStamp=e.entryTimeStamp,o.typeId=e.typeId,o.type=e.type,o.isTemp=!1,o.typeCharacter=null!==(n=null===(t=null==e?void 0:e.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:"",o}function s(e){const t=(0,i.o)();return t.id=e.id,t.ghostId=e.ghostId,t.userId=e.userId,t.accessId=e.accessId,t.entryTimeStamp=e.entryTimeStamp,t.typeId=e.typeId,t.categoryId=e.categoryId,t}function a(e){const t=new o.N(0,0,0,0,0,0,0);return t.id=e.id,t.ghostId=e.ghostId,t.accessId=e.accessId,t.ofTheConceptId=e.ofTheConceptId,t.toTheConceptId=e.toTheConceptId,t.entryTimeStamp=e.entryTimeStamp,t.typeId=e.typeId,t.isTemp=!1,t}},5020:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(2830),i=n(9639),r=n(205),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(){return c(this,void 0,void 0,(function*(){try{let e=[];if(Array.isArray(e))for(let t=0;t<e.length;t++){let n=e[t];i.I.AddConceptToMemory(n)}r.B.isDataLoaded=!0,r.B.isCharacterLoaded=!0,r.B.isTypeLoaded=!0}catch(e){throw yield(0,o.DelayFunctionExecution)(2e3,s()),{message:"Cannot create Binary Tree Concept",ok:!1,status:400,data:e}}}))}},7282:(e,t,n)=>{n.d(t,{o:()=>i});var o=n(2615);function i(){let e=new Date,t=new Date;return new o.j(0,0,0,0,0,"0",0,!1,e,t,"0")}},1218:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(2830),i=n(7282),r=n(1666),c=n(8407),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e){return s(this,arguments,void 0,(function*(e,t=null,n=null,s=null,l=null,d=null,u=null){if(o.serviceWorker)try{return(yield(0,o.sendMessage)("CreateTheComposition",{json:e,ofTheConceptId:t,ofTheConceptUserId:n,mainKey:s,userId:l,accessId:d,sessionInformationId:u})).data}catch(e){console.error("CreateTheComposition sw error: ",e),(0,o.handleServiceWorkerException)(e)}let h=null!=l?l:999,p=null!=d?d:4,f=null!=u?u:999,y=null!=s?s:0,v=(0,i.o)();for(const o in e)if("string"!=typeof e[o]&&"number"!=typeof e[o])if(null==t&&null==n){let t=y,n=yield(0,c.A)(o,"",!0,h,p,f);v=n,t=n.id,y=n.id,yield a(e[o],n.id,n.userId,t,l,d,u)}else{let i=null!=t?t:999,s=null!=n?n:999,g=y,m=yield(0,c.A)(o,"",!0,h,p,f);v=m,yield(0,r.q)(i,s,m.id,g),yield a(e[o],m.id,m.userId,g,l,d,u)}else{let i=null!=t?t:999,s=null!=n?n:10267,a=y,l=yield(0,c.A)(o,e[o].toString(),!1,h,p,f);yield(0,r.q)(i,s,l.id,a)}return v}))}},2212:(e,t,n)=>{n.d(t,{Ay:()=>l,N:()=>d});var o=n(1167),i=n(2615),r=n(5976),c=n(442),s=n(2830),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e,t,n,o,s,l,d){return a(this,void 0,void 0,(function*(){let a=yield r.B.getId(),u=new Date,h=new Date,p=new i.j(a,t,o,n,s,e,l,!0,u,h,d);return p.isTemp=!1,c.Y.AddConcept(p),p}))}function d(e,t,n,c,l,d,u){return a(this,void 0,void 0,(function*(){let a=yield r.B.getId(),h=new Date,p=new Date,f=new i.j(a,t,c,n,l,e,d,!1,h,p,u);return s.ConceptsData.AddConcept(f),(0,o.Y)([f]),f}))}},1666:(e,t,n)=>{n.d(t,{q:()=>c});var o=n(2155),i=n(442),r=n(1863);function c(e,t,n,c){var s=t,a=new o.N(0,e,n,s,c,1,4);if(e==n)return a.ofTheConceptId=0,a.toTheConceptId=1,a;try{a.isTemp=!0,a.id=Math.floor(1e8*Math.random()),i.Y.AddConnection(a)}catch(e){(0,r.Mb)(e)}return a}},1838:(e,t,n)=>{n.d(t,{m:()=>u});var o=n(2830),i=n(9581),r=n(1863),c=n(3518),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},a=n(5239),l=n(4864),d=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function u(e){var t=arguments;return d(this,void 0,void 0,(function*(){const n=o.Logger.logfunction("DeleteConnectionById",t);if(o.serviceWorker)try{return(yield(0,o.sendMessage)("DeleteConnectionById",{id:e})).data}catch(e){console.error("DeleteConnectionById sw error: ",e),(0,o.handleServiceWorkerException)(e)}e>0?(yield function(e){var t=arguments;return s(this,void 0,void 0,(function*(){const n=o.Logger.logfunction("DeleteTheConnection",t);try{const t=new FormData;t.append("id",e.toString());let s=(0,c.BZ)();const a=yield fetch(i.B.DeleteTheConnectionUrl(),{method:"POST",headers:s,body:t,redirect:"follow"});o.Logger.logUpdate(n),a.ok||(console.log("Delete connection error status: ",a.status),(0,r.ry)(a))}catch(e){e instanceof Error?console.log("Delete connection error message: ",e.message):console.log("Delete connection unexpected error: ",e),(0,r.Mb)(e,i.B.DeleteTheConnectionUrl()),(0,r.ey)(n,"DeleteTheConnection",e)}}))}(e),a.O.removeNodeFromTree(e)):l.G.RemoveConnectionById(e),o.Logger.logUpdate(n)}))}},4364:(e,t,n)=>{n.d(t,{s:()=>c});var o=n(1239),i=n(2830),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function c(){return r(this,arguments,void 0,(function*(e=[]){const t=i.Logger.logfunction("FindConceptsFromConnections",[e.length]);let n=[];if(e.length>0){for(let t=0;t<e.length;t++)n.includes(e[t].ofTheConceptId)||n.push(e[t].ofTheConceptId),n.includes(e[t].toTheConceptId)||n.push(e[t].toTheConceptId),n.includes(e[t].typeId)||n.push(e[t].typeId);yield(0,o.r)(n)}i.Logger.logUpdate(t)}))}},5284:(e,t,n)=>{n.d(t,{B:()=>s});var o=n(2830),i=n(8286),r=n(1863),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(){return c(this,arguments,void 0,(function*(e=[]){const t=o.Logger.logfunction("FindConnectionsOfCompositionsBulkInMemory",[e.length]);let n=[];try{if(o.serviceWorker){t.serviceWorker=!0;try{const n=yield(0,o.sendMessage)("FindConnectionsOfCompositionsBulkInMemory",{composition_ids:e});return o.Logger.logUpdate(t),n.data}catch(e){console.error("FindConnectionsOfCompositionsBulkInMemory sw error: ",e),(0,r.ey)(t,"FindConnectionsOfCompositionsBulkInMemory",e),(0,o.handleServiceWorkerException)(e)}}for(let t=0;t<e.length;t++){let o=yield i.d.GetConnectionsOfConcept(e[t]);n.push(...o)}return o.Logger.logUpdate(t),n}catch(e){return console.error("FindConnectionsOfCompositionsBulkInMemory error: ",e),(0,r.ey)(t,"FindConnectionsOfCompositionsBulkInMemory",e),n}}))}},8939:(e,t,n)=>{n.d(t,{$N:()=>I,$V:()=>h,Ez:()=>w,JA:()=>C,Mb:()=>y,Nj:()=>f,PT:()=>T,RW:()=>m,XI:()=>g,ay:()=>u,hL:()=>d,kx:()=>v,re:()=>p,yz:()=>k,zN:()=>L});var o=n(7139),i=n(2),r=n(9639),c=n(8286),s=n(2830),a=n(1863),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e){return l(this,void 0,void 0,(function*(){let t={connectionList:[],compositionList:[]};try{if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetCompositionById",{id:e})).data}catch(e){console.error("GetCompositionById error sw: ",e),(0,s.handleServiceWorkerException)(e)}let n=yield(0,i.s)(e);t.connectionList=n;for(let e=0;e<t.connectionList.length;e++)t.compositionList.includes(t.connectionList[e].ofTheConceptId)||t.compositionList.push(t.connectionList[e].ofTheConceptId);return t}catch(e){return console.error("GetCompositionById error: ",e),t}}))}function u(e,t,n){return l(this,void 0,void 0,(function*(){var i,c;let s={},a=yield r.I.GetConcept(e);0==a.id&&null!=e&&null!=e&&(a=yield(0,o.r)(e));let l=yield L(e,t,n);return s[null!==(c=null===(i=null==a?void 0:a.type)||void 0===i?void 0:i.characterValue)&&void 0!==c?c:""]=l,s}))}function h(e,t,n){return l(this,void 0,void 0,(function*(){var i,c;let s={},a=yield r.I.GetConcept(e);0==a.id&&null!=e&&null!=e&&(a=yield(0,o.r)(e));let l=yield L(e,t,n);s[null!==(c=null===(i=null==a?void 0:a.type)||void 0===i?void 0:i.characterValue)&&void 0!==c?c:""]=l;let d={};return d.created_at=a.entryTimeStamp,d.data=s,d.id=e,d}))}function p(e,t,n){return l(this,void 0,void 0,(function*(){var i,c;let s={},a=yield r.I.GetConcept(e);0==a.id&&null!=e&&null!=e&&(a=yield(0,o.r)(e));let l=yield A(a,t,n);return s[null!==(c=null===(i=null==a?void 0:a.type)||void 0===i?void 0:i.characterValue)&&void 0!==c?c:""]=l,s}))}function f(e){return l(this,void 0,void 0,(function*(){var t,n;if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetComposition",{id:e})).data}catch(e){console.error("GetComposition error sw: ",e),(0,s.handleServiceWorkerException)(e)}let c=[],a={};c=yield(0,i.s)(e);let l=[];for(let e=0;e<c.length;e++)l.includes(c[e].ofTheConceptId)||l.push(c[e].ofTheConceptId);let d=yield r.I.GetConcept(e);0==d.id&&null!=e&&null!=e&&(d=yield(0,o.r)(e));let u=yield L(e,c,l);return a[null!==(n=null===(t=null==d?void 0:d.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:""]=u,a}))}function y(e){return l(this,void 0,void 0,(function*(){var t,n;let c=[],s={};c=yield(0,i.s)(e);let a=[];for(let e=0;e<c.length;e++)a.includes(c[e].ofTheConceptId)||a.push(c[e].ofTheConceptId);let l=yield r.I.GetConcept(e);0==l.id&&null!=e&&null!=e&&(l=yield(0,o.r)(e));let d=yield S(e,c,a);return s[null!==(n=null===(t=null==l?void 0:l.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:""]=d,s}))}function v(e){return l(this,void 0,void 0,(function*(){var t,n;if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetCompositionFromMemory",{id:e})).data}catch(e){console.error("GetCompositionFromMemory error sw: ",e),(0,s.handleServiceWorkerException)(e)}let i=[],a={};i=yield c.d.GetConnectionsOfCompositionLocal(e);let l=[];for(let e=0;e<i.length;e++)l.includes(i[e].ofTheConceptId)||l.push(i[e].ofTheConceptId);let d=yield r.I.GetConcept(e);0==d.id&&null!=e&&null!=e&&(d=yield(0,o.r)(e));let u=yield N(d,i,l);return a[null!==(n=null===(t=null==d?void 0:d.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:""]=u,a}))}function g(e){return l(this,void 0,void 0,(function*(){var t,n;if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetCompositionFromMemoryNormal",{id:e})).data}catch(e){console.error("GetCompositionFromMemoryNormal error sw: ",e),(0,s.handleServiceWorkerException)(e)}let i=[],a={};i=yield c.d.GetConnectionsOfCompositionLocal(e);let l=[];for(let e=0;e<i.length;e++)l.includes(i[e].ofTheConceptId)||l.push(i[e].ofTheConceptId);let d=yield r.I.GetConcept(e);0==d.id&&null!=e&&null!=e&&(d=yield(0,o.r)(e));let u=yield A(d,i,l);return a[null!==(n=null===(t=null==d?void 0:d.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:""]=u,a}))}function m(e){var t=arguments;return l(this,void 0,void 0,(function*(){var n,i;const l=s.Logger.logfunction("GetCompositionWithIdFromMemory",t);if(s.serviceWorker){l.serviceWorker=!0;try{const t=yield(0,s.sendMessage)("GetCompositionWithIdFromMemory",{id:e});return s.Logger.logUpdate(l),t.data}catch(e){console.error("GetCompositionWithIdFromMemory error sw: ",e),(0,a.ey)(l,"GetCompositionWithIdFromMemory",e),(0,s.handleServiceWorkerException)(e)}}let d={},u=[],h={};try{u=yield c.d.GetConnectionsOfCompositionLocal(e);let t=[];for(let e=0;e<u.length;e++)t.includes(u[e].ofTheConceptId)||t.push(u[e].ofTheConceptId);let s=yield r.I.GetConcept(e);0==s.id&&null!=e&&null!=e&&(s=yield(0,o.r)(e));let a=yield N(s,u,t);h[null!==(i=null===(n=null==s?void 0:s.type)||void 0===n?void 0:n.characterValue)&&void 0!==i?i:""]=a,d.created_at=s.entryTimeStamp,d.data=h,d.id=e}catch(t){console.log("this is the exception in GetCompositionWithIdFromMemory",e),(0,a.ey)(l,"GetCompositionWithIdFromMemory",t)}return s.Logger.logUpdate(l),d}))}function C(e,t){var n=arguments;return l(this,void 0,void 0,(function*(){var i,c;const l=s.Logger.logfunction("GetCompositionFromMemoryWithConnections",n);if(s.serviceWorker){l.serviceWorker=!0;try{const n=yield(0,s.sendMessage)("GetCompositionFromMemoryWithConnections",{id:e,connectionList:t});return s.Logger.logUpdate(l),n.data}catch(e){console.error("GetCompositionFromMemoryWithConnections error sw: ",e),(0,a.ey)(l,"GetCompositionFromMemoryWithConnections",e),(0,s.handleServiceWorkerException)(e)}}let d={},u=[];for(let e=0;e<t.length;e++)u.includes(t[e].ofTheConceptId)||u.push(t[e].ofTheConceptId);let h=yield r.I.GetConcept(e);0==h.id&&null!=e&&null!=e&&(h=yield(0,o.r)(e));let p=yield N(h,t,u);d[null!==(c=null===(i=null==h?void 0:h.type)||void 0===i?void 0:i.characterValue)&&void 0!==c?c:""]=p;let f={};return f.created_at=h.entryTimeStamp,f.data=d,f.id=e,s.Logger.logUpdate(l),f}))}function T(e,t){return l(this,void 0,void 0,(function*(){var n,i;const c=s.Logger.logfunction("GetCompositionWithIdFromMemoryFromConnection",[e]);if(s.serviceWorker){c.serviceWorker=!0;try{const t=yield(0,s.sendMessage)("GetCompositionWithIdFromMemory",{id:e});return s.Logger.logUpdate(c),t.data}catch(e){console.error("GetCompositionWithIdFromMemory error sw: ",e),(0,a.ey)(c,"GetCompositionWithIdFromMemoryFromConnection",e),(0,s.handleServiceWorkerException)(e)}}let l={},d=[];for(let e=0;e<t.length;e++)d.includes(t[e].ofTheConceptId)||d.push(t[e].ofTheConceptId);let u=yield r.I.GetConcept(e);0==u.id&&null!=e&&null!=e&&(u=yield(0,o.r)(e));let h=yield N(u,t,d);l[null!==(i=null===(n=null==u?void 0:u.type)||void 0===n?void 0:n.characterValue)&&void 0!==i?i:""]=h;let p={};return p.created_at=u.entryTimeStamp,p.data=l,p.id=e,s.Logger.logUpdate(c),p}))}function I(e){return l(this,void 0,void 0,(function*(){var t;if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetCompositionWithIdFromMemoryNew",{id:e})).data}catch(e){console.error("GetCompositionWithIdFromMemoryNew error sw: ",e),(0,s.handleServiceWorkerException)(e)}let n=[],i={};n=yield c.d.GetConnectionsOfCompositionLocal(e);let a=[];for(let e=0;e<n.length;e++)a.includes(n[e].ofTheConceptId)||a.push(n[e].ofTheConceptId);let d=yield r.I.GetConcept(e);0==d.id&&null!=e&&null!=e&&(console.log("this concept you cannot find ",e),d=yield(0,o.r)(e)),(new Date).getTime();let u=yield function(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,o=[]){var i,r,c,a,l,d,u,h;let p={},f=e.id,y=((new Date).getTime(),null!==(r=null===(i=null==e?void 0:e.type)||void 0===i?void 0:i.characterValue)&&void 0!==r?r:"");if(!n.includes(f)){let t=y;return{[t]:null==e?void 0:e.characterValue}}if(o.includes(f))return"";o.push(f);for(let e=0;e<t.length;e++){let n=yield(0,s.GetTheConcept)(t[e].ofTheConceptId),o=yield(0,s.GetTheConcept)(t[e].toTheConceptId);t[e].ofConcept=n,t[e].toConcept=o;let i=n.id,r="the_",l=(null!==(a=null===(c=null==o?void 0:o.type)||void 0===c?void 0:c.characterValue)&&void 0!==a?a:"").replace(r,"");null!=p[i]&&null!=p[i]||(p[i]={}),p[i][l]=o.characterValue}let v={};for(let e=0;e<t.length;e++){let n=t[e].ofConcept,o=t[e].toConcept,i=null!==(d=null===(l=null==n?void 0:n.type)||void 0===l?void 0:l.characterValue)&&void 0!==d?d:"",r="the_",c=(null!==(h=null===(u=null==o?void 0:o.type)||void 0===u?void 0:u.characterValue)&&void 0!==h?h:"").replace(r,"");null!=v[n.id]&&null!=v[n.id]||(v[n.id]={});let s=v[n.id];null!=s[i]&&null!=s[i]||(s[i]={}),null!=p[t[e].ofTheConceptId]&&null!=p[t[e].toTheConceptId]?s[i][c]=p[o.id]:s[i][c]=o.characterValue}return v[e.id]}))}(d,n,a);null===(t=null==d?void 0:d.type)||void 0===t||t.characterValue,i=u;let h={};return h.created_at=d.entryTimeStamp,h.data=i,h.id=e,h}))}function w(e){return l(this,void 0,void 0,(function*(){var t,n;if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetCompositionWithIdAndDateFromMemory",{id:e})).data}catch(e){console.error("GetCompositionWithIdAndDateFromMemory error sw: ",e),(0,s.handleServiceWorkerException)(e)}let i=[],a={};i=yield c.d.GetConnectionsOfCompositionLocal(e);let l=[];for(let e=0;e<i.length;e++)l.includes(i[e].ofTheConceptId)||l.push(i[e].ofTheConceptId);let d=yield r.I.GetConcept(e);0==d.id&&null!=e&&null!=e&&(d=yield(0,o.r)(e));let u=yield L(e,i,l);a[null!==(n=null===(t=null==d?void 0:d.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:""]=u;let h={};return h.data=a,h.id=e,h.created_at=d.entryTimeStamp,h}))}function k(e){var t=arguments;return l(this,void 0,void 0,(function*(){var n,c;const l=s.Logger.logfunction("GetCompositionWithId",t);if(s.serviceWorker){l.serviceWorker=!0;try{const t=yield(0,s.sendMessage)("GetCompositionWithId",{id:e});return s.Logger.logUpdate(l),t.data}catch(e){console.error("GetCompositionWithId error sw: ",e),(0,a.ey)(l,"GetCompositionWithId",e),(0,s.handleServiceWorkerException)(e)}}let d=[],u={};d=yield(0,i.s)(e);let h=[];for(let e=0;e<d.length;e++)h.includes(d[e].ofTheConceptId)||h.push(d[e].ofTheConceptId);let p=yield r.I.GetConcept(e);0==p.id&&null!=e&&null!=e&&(p=yield(0,o.r)(e));let f=yield L(e,d,h);u[null!==(c=null===(n=null==p?void 0:p.type)||void 0===n?void 0:n.characterValue)&&void 0!==c?c:""]=f;let y={};return y.data=u,y.id=e,s.Logger.logUpdate(l),y}))}function N(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,i=[]){var c,s,a;let l={},d=[],u=e.id;if(null===(c=null==e?void 0:e.type)||void 0===c?void 0:c.characterValue,!n.includes(u))return null==e?void 0:e.characterValue;if(i.includes(u))return"";i.push(u);for(let e=0;e<t.length;e++)if(t[e].ofTheConceptId==u)if(u!=t[e].toTheConceptId){let c=t[e].toTheConceptId,u=yield r.I.GetConcept(c);if(null!=u&&0!=u.id||null==c||null==c||(u=yield(0,o.r)(c)),0!=u.id&&null==(null==u?void 0:u.type)){let e=u.typeId,t=yield r.I.GetConcept(e);u.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,o.r)(e),u.type=t)}let h="the_",p=(null!==(a=null===(s=null==u?void 0:u.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"").replace(h,"");if(isNaN(Number(p))){if(p){const e=yield N(u,t,n,i);l[p]=e}}else{const e=yield N(u,t,n,i);d[p]=e,l=d}}else console.log("this is the faulty connection ",t[e]);return l}))}function A(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,i=[]){var c,a,l;const d=s.Logger.logfunction("recursiveFetchConceptNormal",[e]);(new Date).getTime();let u={},h=[],p=e.id;if(u.id=p,null===(c=null==e?void 0:e.type)||void 0===c?void 0:c.characterValue,!n.includes(p))return null==e?void 0:e.characterValue;if(i.includes(p))return"";i.push(p);for(let e=0;e<t.length;e++)if(t[e].ofTheConceptId==p)if(p!=t[e].toTheConceptId){let c=t[e].toTheConceptId,s=yield r.I.GetConcept(c);if(null!=s&&0!=s.id||null==c||null==c||(s=yield(0,o.r)(c)),0!=s.id&&null==(null==s?void 0:s.type)){let e=s.typeId,t=yield r.I.GetConcept(e);s.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,o.r)(e),s.type=t)}let d="the_",p=(null!==(l=null===(a=null==s?void 0:s.type)||void 0===a?void 0:a.characterValue)&&void 0!==l?l:"").replace(d,"");if(isNaN(Number(p))){if(p){const e=yield N(s,t,n,i);u[p]=e}}else{const e=yield N(s,t,n,i);h[p]=e,u=h}}else console.log("this is the faulty connection ",t[e]);return s.Logger.logUpdate(d),u}))}function L(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,i=[]){var c,s,a;let l={},d=[];if(0==e)return null;let u=yield r.I.GetConcept(e);if(null!=u&&0!=u.id||null==e||null==e||(u=yield(0,o.r)(e)),0!=u.id&&null==u.type){let e=u.typeId,t=yield r.I.GetConcept(e);u.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,o.r)(e),u.type=t)}if(null===(c=null==u?void 0:u.type)||void 0===c?void 0:c.characterValue,!n.includes(e))return null==u?void 0:u.characterValue;if(i.includes(e))return"";i.push(e);for(let c=0;c<t.length;c++)if((new Date).getTime(),t[c].ofTheConceptId==e)if(e!=t[c].toTheConceptId){let e=t[c].toTheConceptId,u=yield r.I.GetConcept(e);if(null!=u&&0!=u.id||null==e||null==e||(u=yield(0,o.r)(e)),0!=u.id&&null==(null==u?void 0:u.type)){let e=u.typeId,t=yield r.I.GetConcept(e);u.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,o.r)(e),u.type=t)}let h="the_",p=(null!==(a=null===(s=null==u?void 0:u.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"").replace(h,"");if(isNaN(Number(p))){if(p){const o=yield L(e,t,n,i);l[p]=o}}else{const o=yield L(e,t,n,i);d[p]=o,l=d}}else console.log("this is the faulty connection ",t[c]);return l}))}function S(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,i=[]){var c,s,a;let l={},d=[];if(0==e)return null;let u=yield r.I.GetConcept(e);if(null!=u&&0!=u.id||null==e||null==e||(u=yield(0,o.r)(e)),0!=u.id&&null==u.type){let e=u.typeId,t=yield r.I.GetConcept(e);u.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,o.r)(e),u.type=t)}if(null===(c=null==u?void 0:u.type)||void 0===c?void 0:c.characterValue,!n.includes(e))return null==u?void 0:u.characterValue;if(i.includes(e))return"";i.push(e),l.id=e;for(let i=0;i<t.length;i++)if(t[i].ofTheConceptId==e){let e=t[i].toTheConceptId,c=yield r.I.GetConcept(e);if(null!=c&&0!=c.id||null==e||null==e||(c=yield(0,o.r)(e)),c&&null==(null==c?void 0:c.type)){let e=c.typeId,t=yield r.I.GetConcept(e);c.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,o.r)(e),c.type=t)}let u="the_",h=(null!==(a=null===(s=null==c?void 0:c.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"").replace(u,"");if(isNaN(Number(h))){if(h){const o=yield S(e,t,n);l[h]=o}}else{const o=yield S(e,t,n);d[h]=o,l=d}}return l}))}},6687:(e,t,n)=>{n.d(t,{D:()=>I,MT:()=>T,Nt:()=>f,QL:()=>g,as:()=>y,cw:()=>u,dF:()=>d,hG:()=>v,km:()=>p,nr:()=>C,p8:()=>h,rv:()=>m});var o=n(8642),i=n(7467),r=n(2830),c=n(1863),s=n(5284),a=n(8939),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(){return l(this,arguments,void 0,(function*(e=[]){yield(0,o.Y)(e);let t=[];for(let n=0;n<e.length;n++){let o=yield(0,a.kx)(e[n]);t.push(o)}return t}))}function u(){return l(this,arguments,void 0,(function*(e=[]){yield(0,o.Y)(e);let t=[];for(let n=0;n<e.length;n++){let o=yield(0,a.RW)(e[n]);t.push(o)}return t}))}function h(){return l(this,arguments,void 0,(function*(e=[],t=[]){const n=r.Logger.logfunction("GetCompositionFromConnectionsWithDataId",[e]);if(r.serviceWorker){n.serviceWorker=!0;try{const o=yield(0,r.sendMessage)("GetCompositionFromConnectionsWithDataId",{conceptIds:e,connectionIds:t});return r.Logger.logUpdate(n),o.data}catch(e){console.error("GetCompositionFromConnectionsWithDataId error sw: ",e),(0,c.ey)(n,"GetCompositionFromConnectionsWithDataId",e),(0,r.handleServiceWorkerException)(e)}}let o=[];for(let t=0;t<e.length;t++){let n=yield(0,a.RW)(e[t]);o.push(n)}return r.Logger.logUpdate(n),o}))}function p(){var e=arguments;return l(this,arguments,void 0,(function*(t=[],n=[]){const o=r.Logger.logfunction("GetCompositionFromConnectionsWithDataIdFromConnections",e);if(r.serviceWorker){o.serviceWorker=!0;try{const e=yield(0,r.sendMessage)("GetCompositionFromConnectionsWithDataIdFromConnections",{conceptIds:t,connectionIds:n});return r.Logger.logUpdate(o),e.data}catch(e){console.error("GetCompositionFromConnectionsWithDataIdFromConnections error sw: ",e),(0,c.ey)(o,"GetCompositionFromConnectionsWithDataIdFromConnections",e),(0,r.handleServiceWorkerException)(e)}}let s=yield(0,i.j)(n),l=[];for(let e=0;e<t.length;e++){let n=yield(0,a.PT)(t[e],s);l.push(n)}return r.Logger.logUpdate(o),l}))}function f(){var e=arguments;return l(this,arguments,void 0,(function*(t=[],n=[]){const o=r.Logger.logfunction("GetCompositionFromConnectionsWithDataIdIndex",e);if(r.serviceWorker){o.serviceWorker=!0;try{const e=yield(0,r.sendMessage)("GetCompositionFromConnectionsWithDataIdIndex",{conceptIds:t,connectionIds:n});return r.Logger.logUpdate(o),e.data}catch(e){console.error("GetCompositionFromConnectionsWithDataIdIndex error sw: ",e),(0,c.ey)(o,"GetCompositionFromConnectionsWithDataIdIndex",e),(0,r.handleServiceWorkerException)(e)}}yield(0,i.j)(n),yield(0,s.B)(t);let l={};for(let e=0;e<t.length;e++){let n=yield(0,a.RW)(t[e]);l[t[e]]=n}return r.Logger.logUpdate(o),l}))}function y(){return l(this,arguments,void 0,(function*(e=[],t=[]){yield(0,i.j)(t),yield(0,s.B)(e);let n={};for(let t=0;t<e.length;t++){let o=yield(0,a.kx)(e[t]);n[e[t]]=o}return n}))}function v(){return l(this,arguments,void 0,(function*(e=[],t=[]){if(r.serviceWorker)try{return(yield(0,r.sendMessage)("GetCompositionFromConnectionsWithIndexFromConnections",{conceptIds:e,connectionIds:t})).data}catch(e){console.error("GetCompositionFromConnectionsWithIndexFromConnections error sw: ",e),(0,r.handleServiceWorkerException)(e)}let n=yield(0,i.j)(t),o=[];for(let t=0;t<e.length;t++){let i=yield(0,a.JA)(e[t],n);o[e[t]]=i}return o}))}function g(e){var t=arguments;return l(this,void 0,void 0,(function*(){const n=r.Logger.logfunction("GetConnectionDataPrefetch",t);if(r.serviceWorker){n.serviceWorker=!0;try{const t=yield(0,r.sendMessage)("GetConnectionDataPrefetch",{connectionIds:e});return r.Logger.logUpdate(n),t.data}catch(e){console.error("GetConnectionDataPrefetch error sw: ",e),(0,c.ey)(n,"GetConnectionDataPrefetch",e),(0,r.handleServiceWorkerException)(e)}}let o=[],s=[],a={};for(let t=0;t<e.length;t++){let n=yield r.ConnectionData.GetConnection(e[t]);0==n.id?o.push(e[t]):s.push(n)}for(let t=0;t<o.length;t++)a[e[t]]=!1;let l=[],d=yield(0,i.j)(o);s=[...s,...d];for(let e=0;e<s.length;e++)l.push(s[e].ofTheConceptId),l.push(s[e].toTheConceptId),l.push(s[e].typeId);return yield(0,r.GetConceptBulk)(l),r.Logger.logUpdate(n),s}))}function m(){var e=arguments;return l(this,arguments,void 0,(function*(t=[],n=[]){const o=r.Logger.logfunction("GetCompositionFromConnectionsWithDataIdInObject",e);yield(0,i.j)(n);let c={};for(let e=0;e<t.length;e++){let n=yield(0,a.RW)(t[e]);c[t[e]]=n}return r.Logger.logUpdate(o),c}))}function C(){return l(this,arguments,void 0,(function*(e=[],t=[]){yield(0,i.j)(t);let n={};for(let t=0;t<e.length;t++){let o=yield(0,a.$N)(e[t]);n[e[t]]=o}return n}))}function T(){return l(this,arguments,void 0,(function*(e=[],t=[]){yield(0,i.j)(t);let n={};for(let t=0;t<e.length;t++){let o=yield(0,a.kx)(e[t]);n[e[t]]=o}return n}))}function I(){return l(this,arguments,void 0,(function*(e=[],t=[]){yield(0,i.j)(t);let n={};for(let t=0;t<e.length;t++){let o=yield(0,a.XI)(e[t]);n[e[t]]=o,console.log("this is the normal data",e[t],o)}return n}))}},2013:(e,t,n)=>{n.d(t,{A:()=>a,w:()=>l});var o=n(8146),i=n(2830),r=n(9639),c=n(1863),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e){var t=arguments;return s(this,void 0,void 0,(function*(){const n=i.Logger.logfunction("GetConceptByCharacter",t);if(i.serviceWorker){n.serviceWorker=!0;try{const t=yield(0,i.sendMessage)("GetConceptByCharacter",{characterValue:e});return i.Logger.logUpdate(n),t.data}catch(e){console.error("GetConceptByCharacter sw error: ",e),(0,c.ey)(n,"GetConceptByCharacter",e),(0,i.handleServiceWorkerException)(e)}}let s=yield r.I.GetConceptByCharacter(e),a=`${e}`;return null!=s&&0!=(null==s?void 0:s.id)||!a||(yield(0,o.Y)(e),s=yield r.I.GetConceptByCharacterAndTypeLocal(e,51),0==s.id&&(s=yield r.I.GetConceptByCharacter(e))),i.Logger.logUpdate(n),s}))}function l(e){var t=arguments;return s(this,void 0,void 0,(function*(){const n=i.Logger.logfunction("GetConceptByCharacterUpdated",t);if(i.serviceWorker){n.serviceWorker=!0;try{const t=yield(0,i.sendMessage)("GetConceptByCharacterUpdated",{characterValue:e});return i.Logger.logUpdate(n),t.data}catch(e){console.error("GetConceptByCharacterUpdated error sw: ",e),(0,c.ey)(n,"GetConceptByCharacterUpdated",e),(0,i.handleServiceWorkerException)(e)}}let s=yield r.I.GetConceptByCharacter(e),a=`${e}`;return null!=s&&0!=(null==s?void 0:s.id)||!a||(yield(0,o.Y)(e),s=yield r.I.GetConceptByCharacter(e)),i.Logger.logUpdate(n),s}))}},7887:(e,t,n)=>{n.d(t,{a:()=>c,p:()=>s});var o=n(8286),i=n(4864),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function c(){return r(this,void 0,void 0,(function*(){try{let e=[];if(Array.isArray(e))for(let t=0;t<e.length;t++)o.d.AddConnectionToMemory(e[t])}catch(e){throw{message:"Cannot create Connection Binary Tree Concept",ok:!1,status:400,data:e}}}))}function s(){return r(this,void 0,void 0,(function*(){try{let e=[];if(Array.isArray(e))for(let t=0;t<e.length;t++)i.G.AddConnectionToMemory(e[t])}catch(e){throw{message:"Cannot create Local Connection Binary Tree Concept",ok:!1,status:400,data:e}}}))}},7876:(e,t,n)=>{n.d(t,{A:()=>d});var o=n(1735),i=n(7139),r=n(2830),c=n(9639),s=n(3278),a=n(7282),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e){return l(this,arguments,void 0,(function*(e,t=999){let n=performance.now();if(o.J.activateStatus)try{o.J.incrementConcept(e)}catch(e){console.error("Error adding connection in access tracker"),r.Logger.log("ERROR","Error Adding Connection")}try{if(r.serviceWorker)try{console.time("serviceworker");const n=yield(0,r.sendMessage)("GetTheConcept",{id:e,userId:t});return console.timeEnd("serviceworker"),n.data}catch(e){console.error("GetTheConcept sw error: ",e),(0,r.handleServiceWorkerException)(e)}let n=(0,a.o)();if(e<0){let o=yield(0,r.GetUserGhostId)(t,e,s.b.sessionId);return n=(0,r.convertFromLConceptToConcept)(o),n}if(n=yield c.I.GetConcept(e),null!=n&&0!=n.id||null==e||null==e||(n=yield(0,i.r)(e)),0!=n.id&&null==n.type&&null==(yield c.I.GetConcept(n.typeId))&&null!=n.typeId&&null!=n.typeId){let e=yield(0,i.r)(n.typeId);n.type=e}return n}catch(o){throw console.error("this is the error in the getting concept",o),r.Logger.logError(n,t,"read","unknown",void 0,500,o,"GetTheConcept",[e,t],"unknown",void 0),o}}))}},7869:(e,t,n)=>{n.d(t,{_:()=>y,A:()=>f});var o=n(9581),i=n(9639),r=n(1863),c=n(3518),s=n(2830),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},l=n(2299);class d{}d.isUpdated=!1,d.isOnlineSync=!1;var u=n(3655),h=n(9003),p=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function f(){return p(this,arguments,void 0,(function*(e=!0){try{if(yield(0,u.qI)("concepts"),yield(0,h.qI)("concepts"),e){if((yield(0,u.b8)()).isOnlineSync)return!0;yield function(){return a(this,void 0,void 0,(function*(){const e=s.Logger.logfunction("GetAiData");try{const a=(new Date).getTime();var t=(0,c.ab)("application/x-www-form-urlencoded");const l=yield fetch(o.B.GetAllAiData(),{method:"GET",headers:t});l.ok||(console.log("Ai Error Message: ","Cannot get response"),(0,r.ry)(l));const d=yield l.json();for(var n=0;n<d.length;n++)i.I.AddConcept(d[n]);y();let u=(new Date).getTime()-a;console.log("The time taken is ",u),s.Logger.logUpdate(e)}catch(e){e instanceof Error?console.log("Ai Error Message: ",e.message):console.log("Ai Error Message: ",e),(0,r.Mb)(e,o.B.GetAllAiData())}}))}()}return!0}catch(e){let t={message:"cannot initlize the AI system",ok:!1,status:400,data:e};return console.log(t),!0}}))}function y(){return p(this,void 0,void 0,(function*(){d.isOnlineSync=!0;var e=new l.B(d.isOnlineSync);(0,u.El)(e)}))}},8095:(e,t,n)=>{n.d(t,{h:()=>s});var o=n(2830),i=n(9700),r=n(1863),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(e,t,n){var s=arguments;return c(this,arguments,void 0,(function*(e,t,n,c=!1,a={concepts:[],connections:[]}){var l,d,u,h,p,f;const y=i.V.logfunction("CreateConnectionBetweenTwoConceptsLocal",s);let v=performance.now();try{if(o.serviceWorker){y.serviceWorker=!0;try{const r=yield(0,o.sendMessage)("CreateConnectionBetweenTwoConceptsLocal",{ofTheConcept:e,toTheConcept:t,linker:n,both:c,actions:a});return(null===(d=null===(l=null==r?void 0:r.actions)||void 0===l?void 0:l.concepts)||void 0===d?void 0:d.length)&&(a.concepts=JSON.parse(JSON.stringify(r.actions.concepts))),(null===(h=null===(u=null==r?void 0:r.actions)||void 0===u?void 0:u.connections)||void 0===h?void 0:h.length)&&(a.connections=JSON.parse(JSON.stringify(r.actions.connections))),i.V.logUpdate(y),r.data}catch(e){console.error("CreateConnectionBetweenTwoConceptsLocal sw error: ",e),(0,r.ey)(y,"CreateConnectionBetweenTwoConceptsLocal",e),(0,o.handleServiceWorkerException)(e)}}if(e.userId,c){let i=(null===(p=t.type)||void 0===p?void 0:p.characterValue)+"_s_"+n+"_by";var g=yield(0,o.MakeTheInstanceConceptLocal)("connection",i,!1,999,999,999,0,a);yield(0,o.CreateTheConnectionLocal)(t.id,e.id,g.id,1e3,void 0,void 0,a)}let s=(null===(f=e.type)||void 0===f?void 0:f.characterValue)+"_s_"+n+"_s";var m=yield(0,o.MakeTheInstanceConceptLocal)("connection",s,!1,999,999,999,void 0,a);let v=yield(0,o.CreateTheConnectionLocal)(e.id,t.id,m.id,1e3,void 0,void 0,a);return i.V.logUpdate(y),v}catch(o){throw i.V.logError(v,e.userId,"create",void 0,void 0,500,o,"CreateConnectionBetweenTwoConceptsLocal",[e,t,n,c],void 0,void 0),(0,r.ey)(y,"CreateConnectionBetweenTwoConceptsLocal",o),o}}))}},6416:(e,t,n)=>{n.d(t,{u:()=>i});var o=n(2615);function i(){let e=new Date,t=new Date;return new o.j(0,0,0,0,0,"0",0,!1,e,t,"0")}},3075:(e,t,n)=>{n.d(t,{Ay:()=>d,EO:()=>u,xd:()=>h});var o=n(205),i=n(9736),r=n(5257),c=n(9003),s=n(2830),a=n(1863),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(){return l(this,void 0,void 0,(function*(){const e=s.Logger.logfunction("CreateLocalBinaryTreeFromIndexDb");try{let t=[];if(Array.isArray(t))for(let e=0;e<t.length;e++){let n=t[e];i.v.AddConceptToMemory(n)}o.B.isLocalDataLoaded=!0,o.B.isLocalTypeLoaded=!0,o.B.isLocalCharacterLoaded=!0,s.Logger.logUpdate(e)}catch(t){yield(0,s.DelayFunctionExecution)(2e3,d());let n={message:"Cannot create local binary tree from index db",data:t,ok:!1,status:400};throw(0,a.ey)(e,"CreateLocalBinaryTreeFromIndexDb",t),n}}))}function u(){return l(this,void 0,void 0,(function*(){var e;const t=s.Logger.logfunction("PopulateTheLocalConceptsToMemory");try{yield null===(e=navigator.locks)||void 0===e?void 0:e.request("dblock",(e=>l(this,void 0,void 0,(function*(){let e=yield(0,c.S5)("localid");if(Array.isArray(e)){if(e[0]){let t=e[0].value;if(t)r.R.AddConceptId(e[0]),yield(0,c.kH)("localid",{id:0,value:t-10});else{t=-Math.floor(1e8*Math.random());let e={id:0,value:t},n={id:0,value:t-10};r.R.AddConceptId(e),yield(0,c.kH)("localid",n)}}e[2]}})))),s.Logger.logUpdate(t)}catch(e){let n={message:"Cannot populate Local Ids from the Index Db",data:e,ok:!1,status:400};throw(0,a.ey)(t,"PopulateTheLocalConceptsToMemory",e),n}}))}function h(){return l(this,void 0,void 0,(function*(){var e;const t=s.Logger.logfunction("PopulateTheLocalConnectionToMemory");try{yield null===(e=navigator.locks)||void 0===e?void 0:e.request("dblock",(e=>l(this,void 0,void 0,(function*(){let e=yield(0,c.S5)("localid");if(Array.isArray(e)){if(e[1]){let t=e[1].value;if(t)r.R.AddConnectionId(e[1]),yield(0,c.kH)("localid",{id:1,value:t-10});else{t=-Math.floor(1e8*Math.random());let e={id:0,value:t},n={id:0,value:t-10};r.R.AddConnectionId(e),yield(0,c.kH)("localid",n)}}e[2]}})))),s.Logger.logUpdate(t)}catch(e){let n={message:"Cannot populate Local Ids from the Index Db",data:e,ok:!1,status:400};throw(0,a.ey)(t,"PopulateTheLocalConnectionToMemory",e),n}}))}},999:(e,t,n)=>{n.d(t,{R:()=>l});var o=n(2830),i=n(1863),r=n(6416),c=n(4711),s=n(5868),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e){return a(this,arguments,void 0,(function*(e,t=null,n=null,a=null,d=null,u=null,h=null,p=!1,f={concepts:[],connections:[]}){var y,v,g,m;const C=o.Logger.logfunction("CreateTheCompositionLocal");if(o.serviceWorker){C.serviceWorker=!0;try{const i=yield(0,o.sendMessage)("CreateTheCompositionLocal",{json:e,ofTheConceptId:t,ofTheConceptUserId:n,mainKey:a,userId:d,accessId:u,sessionInformationId:h,actions:f});return(null===(v=null===(y=null==i?void 0:i.actions)||void 0===y?void 0:y.concepts)||void 0===v?void 0:v.length)&&(f.concepts=JSON.parse(JSON.stringify(i.actions.concepts))),(null===(m=null===(g=null==i?void 0:i.actions)||void 0===g?void 0:g.connections)||void 0===m?void 0:m.length)&&(f.connections=JSON.parse(JSON.stringify(i.actions.connections))),o.Logger.logUpdate(C),i.data}catch(e){console.error("CreateTheCompositionLocal error sw: ",e),(0,i.ey)(C,"CreateTheCompositionLocal",e),(0,o.handleServiceWorkerException)(e)}}let T=null!=d?d:999,I=null!=u?u:999,w=null!=h?h:999,k=null!=a?a:0,N=(0,r.u)();for(const o in e)if("string"!=typeof e[o]&&"number"!=typeof e[o])if(null==t&&null==n){let t=k,n=yield(0,s.k)(o,"",!0,T,I,w,void 0,f);N=n,t=n.id,k=n.id,yield l(e[o],n.id,n.userId,t,d,u,h,void 0,f)}else{let n=null!=t?t:999,i=k,r=yield(0,s.k)(o,"",!0,T,I,w,void 0,f);yield(0,c.F)(n,r.id,i,void 0,void 0,void 0,f),yield l(e[o],r.id,r.userId,i,d,u,h,void 0,f)}else{let n=null!=t?t:999,i=k,r=yield(0,s.k)(o,e[o].toString(),!1,T,I,w,void 0,f);yield(0,c.F)(n,r.id,i,void 0,void 0,void 0,f)}return o.Logger.logUpdate(C),N}))}},3077:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(2830),i=n(2615),r=n(9736),c=n(5257),s=n(9700),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e,t,n,l,d,u){return a(this,arguments,void 0,(function*(e,t,n,a,l,d,u=!1,h=0,p={concepts:[],connections:[]}){var f,y,v,g;let m=performance.now();try{if(o.serviceWorker)try{const i=yield(0,o.sendMessage)("CreateTheConceptLocal",{referent:e,typecharacter:t,userId:n,categoryId:a,typeId:l,accessId:d,isComposition:u,referentId:h});return(null===(y=null===(f=null==i?void 0:i.actions)||void 0===f?void 0:f.concepts)||void 0===y?void 0:y.length)&&(p.concepts=JSON.parse(JSON.stringify(i.actions.concepts))),(null===(g=null===(v=null==i?void 0:i.actions)||void 0===v?void 0:v.connections)||void 0===g?void 0:g.length)&&(p.connections=JSON.parse(JSON.stringify(i.actions.connections))),i.data}catch(e){console.error("CreateTheConceptLocal error sw: ",e),(0,o.handleServiceWorkerException)(e)}let s=yield c.R.getConceptId(),m=!0,C=new Date,T=new Date;if("the"==e)return new i.j(1,999,5,5,h,e,d,m,C,T,t);let I=new i.j(s,n,l,a,h,e,d,m,C,T,t);return I.isTemp=!0,I.isComposition=u,r.v.AddConcept(I),p.concepts.push(I),I}catch(o){throw s.V.logError(m,n,"create","unknown","unknown",500,void 0,"createTheConceptLocal",[e,t,n,a,l,d,u],void 0),o}}))}},4711:(e,t,n)=>{n.d(t,{F:()=>l});var o=n(2155),i=n(4864),r=n(5257),c=n(9700),s=n(2830),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e,t,n){return a(this,arguments,void 0,(function*(e,t,n,a=1,l="",d=999,u={concepts:[],connections:[]}){var h,p,f,y;let v=performance.now();if(s.serviceWorker)try{const o=yield(0,s.sendMessage)("CreateTheConnectionLocal",{ofTheConceptId:e,toTheConceptId:t,typeId:n,orderId:a,typeString:l,userId:d,actions:u});return(null===(p=null===(h=null==o?void 0:o.actions)||void 0===h?void 0:h.concepts)||void 0===p?void 0:p.length)&&(u.concepts=JSON.parse(JSON.stringify(o.actions.concepts))),(null===(y=null===(f=null==o?void 0:o.actions)||void 0===f?void 0:f.connections)||void 0===y?void 0:y.length)&&(u.connections=JSON.parse(JSON.stringify(o.actions.connections))),o.data}catch(e){console.log("CreateTheConnectionLocal error sw: ",e),(0,s.handleServiceWorkerException)(e)}try{let c=4,h=yield r.R.getConnectionId(),p=0,f=0,y=0;p=e,f=t,y=n;let v=new o.N(0,0,0,0,0,0,0);return e!=t&&(v=new o.N(h,p,f,d,n,a,c),v.isTemp=!0,v.typeCharacter=l,s.LocalSyncData.AddConnection(v),i.G.AddConnection(v),u.connections.push(v)),v}catch(o){throw c.V.logError(v,d,"create","Unknown","Unknown",500,void 0,"CreateTheConnectionLocal",[e,t,n,a,l,d],"UnknownUserAgent",[]),o}}))}},8064:(e,t,n)=>{n.d(t,{$I:()=>s,Ay:()=>c});var o=n(9736),i=(n(9581),n(3518),n(2830));n(1863);var r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function c(e){return r(this,void 0,void 0,(function*(){return yield o.v.GetConceptByCharacterAndTypeLocal(e,51)}))}function s(e){return r(this,void 0,void 0,(function*(){if(i.serviceWorker)try{return(yield(0,i.sendMessage)("GetConceptByCharacterAndCategoryLocal",{character:e})).data}catch(e){console.error("GetConceptByCharacterAndCategoryLocal error sw: ",e),(0,i.handleServiceWorkerException)(e)}let t=(0,i.CreateDefaultLConcept)();if("the"==e)return t.id=1,t.typeId=5,t.characterValue="the",t;let n=(0,i.SplitStrings)(e);if(n.length>1){let i=1,c=yield s(n[0]);0!=c.id&&(i=c.id),t=yield function(e,t){return r(this,void 0,void 0,(function*(){return o.v.GetConceptByCharacterAndCategoryLocal(e,t)}))}(e,i)}else n[0]==e&&(t=yield c(e));return t}))}},1213:(e,t,n)=>{n.d(t,{f:()=>a});var o=n(9736),i=n(7820),r=n(2830),c=n(176),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e){return s(this,void 0,void 0,(function*(){let t=performance.now();try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("GetTheConceptLocal",{id:e})).data}catch(e){console.error("GetTheConceptLocal error sw: ",e),(0,r.handleServiceWorkerException)(e)}let t=(0,r.CreateDefaultLConcept)();if(e<0){if(t=yield o.v.GetConcept(e),0==t.id){let n=yield i.G.getNodeFromTree(e);if(null==n?void 0:n.value){let e=n.value;e&&(t=e)}}}else{let n=yield(0,r.GetTheConcept)(e);t=(0,c.F4)(n)}return t}catch(n){throw r.Logger.logError(t,"unknown","read","unknown",void 0,200,void 0,"GetTheConceptLocal",[e],"unknown",void 0),n}}))}},9975:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(2830),i=n(9736),r=n(3077),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(e,t,n,s,a){return c(this,arguments,void 0,(function*(e,t,n,c,s,a={concepts:[],connections:[]}){var l,d,u,h;if(o.serviceWorker)try{const i=yield(0,o.sendMessage)("MakeTheConceptLocal",{referent:e,typeCharacter:t,userId:n,categoryId:c,typeId:s,actions:a});return(null===(d=null===(l=null==i?void 0:i.actions)||void 0===l?void 0:l.concepts)||void 0===d?void 0:d.length)&&(a.concepts=JSON.parse(JSON.stringify(i.actions.concepts))),(null===(h=null===(u=null==i?void 0:i.actions)||void 0===u?void 0:u.connections)||void 0===h?void 0:h.length)&&(a.connections=JSON.parse(JSON.stringify(i.actions.connections))),i.data}catch(e){console.error("MakeTheConceptLocal error sw: ",e),(0,o.handleServiceWorkerException)(e)}let p=yield i.v.GetConceptByCharacterAndTypeLocal(e,s),f=p;return"the"==t&&(c=1),0==f.id&&(p=yield(0,r.A)(e,t,n,c,s,4,void 0,void 0,a),f=p),f}))}},5868:(e,t,n)=>{n.d(t,{k:()=>l});var o=n(3077),i=n(8357),r=n(9736),c=n(2830),s=n(1863),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e,t){var n=arguments;return a(this,arguments,void 0,(function*(e,t,a=!1,l,d,u=999,h=0,p={concepts:[],connections:[]}){var f,y,v,g;const m=c.Logger.logfunction("MakeTheInstanceConceptLocal",n);if(performance.now(),c.serviceWorker){m.serviceWorker=!0;try{const n=yield(0,c.sendMessage)("MakeTheInstanceConceptLocal",{type:e,referent:t,composition:a,userId:l,accessId:d,sessionInformationId:u,referentId:h,actions:p});return(null===(y=null===(f=null==n?void 0:n.actions)||void 0===f?void 0:f.concepts)||void 0===y?void 0:y.length)&&(p.concepts=JSON.parse(JSON.stringify(n.actions.concepts))),(null===(g=null===(v=null==n?void 0:n.actions)||void 0===v?void 0:v.connections)||void 0===g?void 0:g.length)&&(p.connections=JSON.parse(JSON.stringify(n.actions.connections))),c.Logger.logUpdate(m),n.data}catch(e){console.error("MakeTheInstanceConceptLocal error sw: ",e),(0,s.ey)(m,"MakeTheInstanceConceptLocal",e),(0,c.handleServiceWorkerException)(e)}}try{let n,s,d=999,u=4,f=l,y=4,v="",g=t.length;if(v=e.startsWith("the_")?e:"the_"+e,a)n=yield(0,i.$)(e,d,l,l,p),s=yield(0,o.A)(t,e,l,u,n.id,y,!0,h,p);else if(g>255)n=yield(0,i.$)(v,d,f,l,p),s=yield(0,o.A)(t,v,l,u,n.id,y,void 0,void 0,p);else{n=yield(0,i.$)(v,d,f,l,p);let e=yield r.v.GetConceptByCharacterAndTypeLocal(t,n.id);s=e,0==e.id&&0==e.userId&&(s=yield(0,o.A)(t,v,l,u,n.id,y,void 0,void 0,p))}return s.type=n,c.LocalSyncData.AddConcept(s),p.concepts.push(s),c.Logger.logUpdate(m),s}catch(e){throw(0,s.ey)(m,"MakeTheInstanceConceptLocal",e),e}}))}},8357:(e,t,n)=>{n.d(t,{$:()=>d});var o=n(3077),i=n(8064),r=n(6467),c=n(9975),s=n(2830),a=n(1863),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e,t,n,u){var h=arguments;return l(this,arguments,void 0,(function*(e,t,n,l,u={concepts:[],connections:[]}){var p,f,y,v;const g=s.Logger.logfunction("MakeTheTypeConceptLocal",h);if(s.serviceWorker){g.serviceWorker=!0;try{const o=yield(0,s.sendMessage)("MakeTheTypeConceptLocal",{typeString:e,sessionId:t,sessionUserId:n,userId:l,actions:u});return(null===(f=null===(p=null==o?void 0:o.actions)||void 0===p?void 0:p.concepts)||void 0===f?void 0:f.length)&&(u.concepts=JSON.parse(JSON.stringify(o.actions.concepts))),(null===(v=null===(y=null==o?void 0:o.actions)||void 0===y?void 0:y.connections)||void 0===v?void 0:v.length)&&(u.connections=JSON.parse(JSON.stringify(o.actions.connections))),s.Logger.logUpdate(g),o.data}catch(e){console.error("MakeTheTypeConceptLocal error sw: ",e),(0,a.ey)(g,"MakeTheTypeConceptLocal",e),(0,s.handleServiceWorkerException)(e)}}let m=yield(0,i.$I)(e);if(m&&(0==m.id||0==m.userId)){let i=(0,r.f)(e);if(i[0]==e)m=yield(0,c.A)(e,"the",l,1,51,u);else{let r=yield d(i[0],t,n,l,u),c=yield d(i[1],t,n,l,u);m=yield(0,o.A)(e,i[1],l,r.id,c.id,4,void 0,void 0,u)}}return s.Logger.logUpdate(g),m}))}},3729:(e,t,n)=>{n.d(t,{D:()=>p});var o=n(9934),i=n(4485),r=n(2),c=n(7876),s=n(1838),a=n(999),l=n(5868),d=n(2830),u=n(176),h=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function p(e){return h(this,arguments,void 0,(function*(e,t={concepts:[],connections:[]}){var n,h,p,f;if(performance.now(),d.serviceWorker)try{const o=yield(0,d.sendMessage)("UpdateCompositionLocal",{patcherStructure:e,actions:t});return(null===(h=null===(n=null==o?void 0:o.actions)||void 0===n?void 0:n.concepts)||void 0===h?void 0:h.length)&&(t.concepts=JSON.parse(JSON.stringify(o.actions.concepts))),(null===(f=null===(p=null==o?void 0:o.actions)||void 0===p?void 0:p.connections)||void 0===f?void 0:f.length)&&(t.connections=JSON.parse(JSON.stringify(o.actions.connections))),o.data}catch(e){console.error("UpdateCompositionLocal error sw: ",e),(0,d.handleServiceWorkerException)(e)}const y=e.userId,v=e.sessionId,g=e.accessId;let m=[];const C=[];let T=(0,d.CreateDefaultLConcept)(),I=(0,d.CreateDefaultLConcept)();const w=[],k=e.compositionId,N=e.ofTheCompositionId;let A=[],L=yield(0,r.s)(k);for(let e=0;e<L.length;e++)m.push((0,u.P6)(L[e]));const S=[],G=[];let x=[];for(let e=0;e<m.length;e++)(0,o.A)(G,m[e].ofTheConceptId),(0,o.A)(S,m[e].ofTheConceptId),(0,o.A)(S,m[e].toTheConceptId),x.push(m[e].ofTheConceptId);for(let e=0;e<S.length;e++){const t=yield(0,c.A)(S[e]);k==S[e]&&(T=(0,u.F4)(t)),N==S[e]&&(I=(0,u.F4)(t)),C.push((0,u.F4)(t))}const B=e.patchObject;for(const e in B){let n=(0,d.CreateDefaultLConcept)();const o=B[e];let r=T;I.id>0&&(r=I),Array.isArray(o)||"object"==typeof o?(n=yield(0,l.k)(e,"",!0,T.userId,4,999,void 0,t),yield(0,a.R)(B[e],n.id,n.userId,T.id,T.userId,4,999,void 0,t)):n=yield(0,l.k)(e,o,!1,y,g,v,void 0,t);const c=(0,i.nm)(C,n);for(let e=0;e<c.length;e++)if(c[e].id>0){const t=(0,i.gt)(m,c[e].id);A=A.concat(t),w.push(c[e])}yield(0,d.CreateTheConnectionLocal)(r.id,n.id,T.id,2,void 0,void 0,t),C.push(n)}for(let e=0;e<A.length;e++)yield(0,s.m)(A[e].id);yield d.LocalSyncData.SyncDataOnline(void 0,t)}))}},8407:(e,t,n)=>{n.d(t,{A:()=>f});var o=n(9581),i=n(3518),r=n(1863),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},s=n(4402),a=n(2830),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class d{constructor(e,t,n,o,i,r,c,s,a,l){this.id=0,this.userId=e,this.data=t,this.securityId=n,this.securityUserId=o,this.accessId=i,this.accessUserId=r,this.sessionId=c,this.sessionUserId=s,this.entryTimestamp=a,this.isNew=l}}var u=n(7282),h=n(2212),p=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function f(e,t){var n=arguments;return p(this,arguments,void 0,(function*(e,t,p=!1,f,y=4,v=999,g=0){const m=a.Logger.logfunction("MakeTheInstanceConcept",n);if(a.serviceWorker){m.serviceWorker=!0;try{const n=yield(0,a.sendMessage)("MakeTheInstanceConcept",{type:e,referent:t,composition:p,userId:f,passedAccessId:y,passedSessionId:v,referentId:g});return a.Logger.logUpdate(m),n.data}catch(e){console.error("MakeTheInstanceConcept sw error: ",e),(0,r.ey)(m,"MakeTheInstanceConcept",e),(0,a.handleServiceWorkerException)(e)}}let C,T=v,I=f,w=f,k=y,N=f,A="",L=t.length,S=(0,u.o)();if(A=e.startsWith("the_")?e:"the_"+e,p)S=yield(0,a.MakeTheTypeConceptApi)(e,f),C=yield(0,h.Ay)(t,f,4,S.id,g,k,e);else if(L>255)S=yield(0,a.MakeTheTypeConceptApi)(A,f),C=yield(0,h.Ay)(t,f,4,S.id,g,k,A),function(e){c(this,void 0,void 0,(function*(){try{var t=(0,i.Xr)();const n=yield fetch(o.B.CreateTheTextDataUrl(),{method:"POST",headers:t,body:JSON.stringify(e)});if(!n.ok)throw(0,r.ry)(n),new Error(`Error! status: ${n.status}`);return yield n.json()}catch(e){throw e instanceof Error?console.log("Create the text error message: ",e.message):console.log("Create the text unexpected error: ",e),e}}))}(new d(f,t,999,I,k,N,T,w,Date.now().toString(),!0));else{S=yield(0,a.MakeTheTypeConceptApi)(A,f);let e=yield(0,s.A)(t,S.id);C=e,0==e.id&&0==e.userId&&(C=yield(0,h.N)(t,f,4,S.id,12,k,A),function(e,t,n,c){var s=arguments;l(this,void 0,void 0,(function*(){const l=a.Logger.logfunction("MakeTheNameInBackend",s);try{let s={newConceptId:e,referent:t,typeId:n,typeUserId:c},d=(0,i.Xr)(),u=JSON.stringify(s);const h=yield fetch(o.B.MakeTheNameInBackendUrl(),{method:"POST",headers:d,body:u});a.Logger.logUpdate(l),h.ok||(0,r.ry)(h)}catch(e){e instanceof Error?console.log("make the name in backend error message: ",e.message):console.log("make the name in backend unexpected error: ",e),(0,r.Mb)(e,o.B.MakeTheNameInBackendUrl()),(0,r.ey)(l,"MakeTheNameInBackend",e)}}))}(C.id,`${t}`,S.id,f))}return C.type=S,a.Logger.logUpdate(m),C}))}},5312:(e,t,n)=>{n.d(t,{NK:()=>h,Ve:()=>p,cf:()=>d,vw:()=>f,y8:()=>u});var o=n(2832),i=n(3130),r=n(2830),c=n(1863),s=n(6687),a=n(7106),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e){var t=arguments;return l(this,arguments,void 0,(function*(e,n="",d=null,h=i.y0){var p,y,v,g,m,C,T,I;const w=r.Logger.logfunction("SearchLinkMultipleAll",t);try{try{if(r.serviceWorker){w.serviceWorker=!0;const t=yield(0,r.sendMessage)("SearchLinkMultipleAll",{searchQuery:e,token:n,caller:d,format:h});return r.Logger.logUpdate(w),t.data}}catch(e){console.error("SearchLinkMultipleAll error sw: ",e),(0,c.ey)(w,"SearchLinkMultipleAll",e),(0,r.handleServiceWorkerException)(e)}let t=[],k=[],N=[],A=[],L=e[0].composition,S={},G={};(null==d?void 0:d.isDataLoaded)?(S.compositionIds=null===(p=d.conceptIds)||void 0===p?void 0:p.slice(),S.internalConnections=null===(y=d.internalConnections)||void 0===y?void 0:y.slice(),S.linkers=null===(v=d.linkers)||void 0===v?void 0:v.slice(),S.reverse=null===(g=d.reverse)||void 0===g?void 0:g.slice(),G=S,t=G.compositionIds,N=G.internalConnections,k=G.linkers,A=G.reverse):(S=yield(0,o.j)(e,n),d&&(d.conceptIds=null===(m=S.compositionIds)||void 0===m?void 0:m.slice(),d.internalConnections=null===(C=S.internalConnections)||void 0===C?void 0:C.slice(),d.linkers=null===(T=S.linkers)||void 0===T?void 0:T.slice(),d.reverse=null===(I=S.reverse)||void 0===I?void 0:I.slice(),d.isDataLoaded=!0),G=S,t=G.compositionIds,N=G.internalConnections,k=G.linkers,A=G.reverse);let x=yield function(e,t,n,o,r,c){return l(this,arguments,void 0,(function*(e,t,n,o,r,c,l=i.y0){try{let d,h,p=yield(0,s.QL)(e);return l==i.ZJ?(d=yield(0,s.MT)(t,n),h=yield f(e,d,r,o)):l==i.yv?(d=yield(0,s.D)(t,n),h=yield f(e,d,r,o)):100==l?(d=yield(0,s.nr)(t,n),h=yield u(p,d,r,o)):l==i.SL?h=yield(0,a._W)(e,t,n,c.ofCompositions,o):(d=yield(0,s.rv)(t,n),h=yield u(p,d,r,o)),h}catch(e){return void console.log("Error Occured in build layer",e)}}))}(k,t,N,A,L,e[0],h);return r.Logger.logUpdate(w),x}catch(e){throw console.log("this is the error in the search link multiple",e),(0,c.ey)(w,"SearchLinkMultipleAll",e),e}}))}function u(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,o=[]){(new Date).getTime();let i={},c=[];for(let t=0;t<e.length;t++)c.push(e[t].toTheConceptId),c.push(e[t].ofTheConceptId),c.push(e[t].typeId);e.sort((function(e,t){return t.id-e.id}));for(let n=0;n<e.length;n++){let i=!1;if(o.includes(e[n].id)&&(i=!0),1==i){if(t[e[n].ofTheConceptId]&&t[e[n].toTheConceptId]){let o=t[e[n].toTheConceptId],i=yield(0,r.GetTheConcept)(e[n].typeId),c=null==o?void 0:o.data,s=Object.keys(c)[0];try{let o=i.characterValue+"_reverse";"string"==typeof c&&(c={}),Array.isArray(c[s][o])||("string"==typeof c[s]&&(c[s]={}),c[s][o]=[]),c[s][o].push(t[e[n].ofTheConceptId])}catch(e){console.log("this is error",e)}}}else if(t[e[n].ofTheConceptId]&&t[e[n].toTheConceptId]){let o=t[e[n].ofTheConceptId],i=yield(0,r.GetTheConcept)(e[n].typeId),c=null==o?void 0:o.data,s=Object.keys(c)[0];try{"string"==typeof c&&(c={}),Array.isArray(c[s][i.characterValue])||("string"==typeof c[s]&&(c[s]={}),c[s][i.characterValue]=[]),c[s][i.characterValue].push(t[e[n].toTheConceptId])}catch(e){console.log("this is error",e)}}}return i=t[n],i}))}function h(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,o=[]){let i=[],c=[];for(let t=0;t<e.length;t++)c.push(e[t].toTheConceptId),c.push(e[t].ofTheConceptId),c.push(e[t].typeId);e.sort((function(e,t){return t.id-e.id}));for(let n=0;n<e.length;n++){let i=!1;if(o.includes(e[n].id)&&(i=!0),1==i){if(t[e[n].ofTheConceptId]&&t[e[n].toTheConceptId]){let o=t[e[n].toTheConceptId],i=yield(0,r.GetTheConcept)(e[n].typeId),c=Object.keys(o)[0];try{let r=i.characterValue+"_reverse";"string"==typeof o&&(o={}),Array.isArray(o[c][r])||("string"==typeof o[c]&&(o[c]={}),o[c][r]=[]),o[c][r].push(t[e[n].ofTheConceptId])}catch(e){console.log("this is error",e)}}}else if(t[e[n].ofTheConceptId]&&t[e[n].toTheConceptId]){let o=t[e[n].ofTheConceptId],i=yield(0,r.GetTheConcept)(e[n].typeId),c=Object.keys(o)[0];try{"string"==typeof o&&(o={}),Array.isArray(o[c][i.characterValue])||("string"==typeof o[c]&&(o[c]={}),o[c][i.characterValue]=[]),o[c][i.characterValue].push(t[e[n].toTheConceptId])}catch(e){console.log("this is error",e)}}}for(let e=0;e<n.length;e++){let o=t[n[e]];o&&i.push(o)}return i}))}function p(e,t,n,o){return l(this,arguments,void 0,(function*(e,t,n,o,i=[]){(new Date).getTime();let c=[],s=[];for(let t=0;t<e.length;t++)s.push(e[t].toTheConceptId),s.push(e[t].ofTheConceptId),s.push(e[t].typeId);e.sort((function(e,t){return t.id-e.id}));for(let n=0;n<e.length;n++){let o=!1;if(i.includes(e[n].id)&&(o=!0),1==o){if(t[e[n].ofTheConceptId]&&t[e[n].toTheConceptId]){let o=t[e[n].toTheConceptId],i=yield(0,r.GetTheConcept)(e[n].typeId),c=null==o?void 0:o.data,s=Object.keys(c)[0];try{let o=i.characterValue+"_reverse";"string"==typeof c&&(c={}),Array.isArray(c[s][o])||("string"==typeof c[s]&&(c[s]={}),c[s][o]=[]),c[s][o].push(t[e[n].ofTheConceptId])}catch(e){console.log("this is error",e)}}}else if(t[e[n].ofTheConceptId]&&t[e[n].toTheConceptId]){let o=t[e[n].ofTheConceptId],i=yield(0,r.GetTheConcept)(e[n].typeId),c=null==o?void 0:o.data,s=Object.keys(c)[0];try{"string"==typeof c&&(c={}),Array.isArray(c[s][i.characterValue])||("string"==typeof c[s]&&(c[s]={}),c[s][i.characterValue]=[]),c[s][i.characterValue].push(t[e[n].toTheConceptId])}catch(e){console.log("this is error",e)}}}for(let e=0;e<o.length;e++){let n=t[o[e]];n&&c.push(n)}return c}))}function f(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,o=[]){let i={},c=yield(0,r.GetConnectionBulk)(e),s=[];for(let e=0;e<c.length;e++)s.push(c[e].toTheConceptId),s.push(c[e].ofTheConceptId),s.push(c[e].typeId);yield(0,r.GetConceptBulk)(s),c.sort((function(e,t){return t.id-e.id}));for(let e=0;e<c.length;e++){let n=!1;if(o.includes(c[e].id)&&(n=!0),1==n){if(t[c[e].ofTheConceptId]&&t[c[e].toTheConceptId]){let n=t[c[e].toTheConceptId],o=yield(0,r.GetTheConcept)(c[e].typeId),i=n,s=Object.keys(i)[0];try{let n=o.characterValue+"_reverse";"string"==typeof i&&(i={}),Array.isArray(i[s][n])||("string"==typeof i[s]&&(i[s]={}),i[s][n]=[]),i[s][n].push(t[c[e].ofTheConceptId])}catch(e){console.log("this is error",e)}}}else if(t[c[e].ofTheConceptId]&&t[c[e].toTheConceptId]){let n=t[c[e].ofTheConceptId],o=yield(0,r.GetTheConcept)(c[e].typeId),i=n,s=Object.keys(i)[0];try{"string"==typeof i&&(i={}),Array.isArray(i[s][o.characterValue])||("string"==typeof i[s]&&(i[s]={}),i[s][o.characterValue]=[]),i[s][o.characterValue].push(t[c[e].toTheConceptId])}catch(e){console.log("this is error",e)}}}return i=t[n],i}))}},7106:(e,t,n)=>{n.d(t,{zl:()=>v,b6:()=>C,e$:()=>I,y6:()=>T,yV:()=>g,_W:()=>m});var o=n(2830),i=n(6687);function r(e){return e.startsWith("the_")?e.slice(4):e}var c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(e,t,n){return c(this,void 0,void 0,(function*(){var i,r,c,s,a,l,d,u;let h=[];for(let t=0;t<e.length;t++)h.push(e[t].toTheConceptId),h.push(e[t].ofTheConceptId),h.push(e[t].typeId);for(let h=0;h<e.length;h++){let p=!1;n.includes(e[h].id)&&(p=!0);let f=yield(0,o.GetTheConcept)(e[h].ofTheConceptId),y=yield(0,o.GetTheConcept)(e[h].toTheConceptId);if(1==p){if(0!=f.id&&0!=y.id){let n,a=null!==(r=null===(i=y.type)||void 0===i?void 0:i.characterValue)&&void 0!==r?r:"self";e[h].toTheConceptId in t?n=t[e[h].toTheConceptId]:(n={},n[a]={},t[e[h].toTheConceptId]=n);let l=yield(0,o.GetTheConcept)(e[h].typeId);try{let e=null!==(s=null===(c=null==f?void 0:f.type)||void 0===c?void 0:c.characterValue)&&void 0!==s?s:"none",n=f.characterValue;l.characterValue,l.characterValue.includes("_s_")&&(f.id in t||(t[f.id]={}),t[f.id][e]=n),t[y.id]={}}catch(e){console.log("this is error",e)}}}else if(0!=f.id&&0!=y.id){let n,i=null!==(l=null===(a=f.type)||void 0===a?void 0:a.characterValue)&&void 0!==l?l:"self";e[h].ofTheConceptId in t?n=t[e[h].ofTheConceptId]:(n={},n[i]={},t[e[h].ofTheConceptId]=n);let r=yield(0,o.GetTheConcept)(e[h].typeId);try{let e=null!==(u=null===(d=null==y?void 0:y.type)||void 0===d?void 0:d.characterValue)&&void 0!==u?u:"none",n=y.characterValue;r.characterValue.includes("_s_")&&(y.id in t||(t[y.id]={}),t[y.id][e]=n),t[f.id]={}}catch(e){console.log("this is error",e)}}}return t}))}var a=n(5312),l=n(7876),d=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function u(e,t,n){if(e in t){let o=t[e];o&&(n[o.connectionType+"_count"]=o.count)}}var h=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},p=n(5898);function f(e,t="DESC"){return"ASC"==t?e.sort((function(e,t){return e.id-t.id})):e.sort((function(e,t){return t.id-e.id})),e}var y=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function v(e,t){return y(this,arguments,void 0,(function*(e,t,n=""){let r=yield(0,o.SearchWithTypeAndLinkerApi)(e,t,n),c=r.compositionIds,s=r.internalConnections,l=r.linkers,d=r.reverse,u=r.mainCompositionIds,h=yield(0,i.QL)(l),p=yield(0,i.MT)(c,s);return yield(0,a.NK)(h,p,u,d)}))}function g(e,t,n,o,r){return y(this,void 0,void 0,(function*(){let c=yield(0,i.QL)(e),s=yield(0,i.rv)(t,n);return yield(0,a.Ve)(c,s,t,o,r)}))}function m(e,t,n,o,r){return y(this,void 0,void 0,(function*(){let c=yield(0,i.QL)(e),s=yield(0,i.D)(t,n);return yield(0,a.NK)(c,s,o,r)}))}function C(e,t,n,a,l){return y(this,void 0,void 0,(function*(){if(o.serviceWorker)try{return(yield(0,o.sendMessage)("formatConnections",{linkers:e,conceptIds:t,mainCompositionIds:n,reverse:a,countInfos:l})).data}catch(e){console.error("formatConnections error sw: ",e),(0,o.handleServiceWorkerException)(e)}let d=yield(0,i.QL)(e);d=f(d);let u=[];u=yield s(d,u,a),u=yield function(e,t,n){return c(this,void 0,void 0,(function*(){var i,c,s,a,l,d,u,h;let p=[];for(let t=0;t<e.length;t++)p.push(e[t].toTheConceptId),p.push(e[t].ofTheConceptId),p.push(e[t].typeId);e.sort((function(e,t){return t.id-e.id}));for(let p=0;p<e.length;p++){let f=!1;n.includes(e[p].id)&&(f=!0);let y=yield(0,o.GetTheConcept)(e[p].ofTheConceptId),v=yield(0,o.GetTheConcept)(e[p].toTheConceptId);if(1==f){if(0!=y.id&&0!=v.id){let n,l=null!==(c=null===(i=v.type)||void 0===i?void 0:i.characterValue)&&void 0!==c?c:"self";e[p].toTheConceptId in t?(n=t[e[p].toTheConceptId],l in n||(n[l]={})):(n={},n[l]={},t[e[p].toTheConceptId]=n);let d=yield(0,o.GetTheConcept)(e[p].typeId);try{let e=null!==(a=null===(s=null==y?void 0:y.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"none",t=y.characterValue,o=d.characterValue;""==o&&(o=e,o=r(o));let i={[e]:t},c=o+"_reverse";d.characterValue.includes("_s_")||("string"==typeof n[l]&&(n[l]={}),n[l][c]=i)}catch(e){console.log("this is error",e)}}}else if(0!=y.id&&0!=v.id){let n,i=null!==(d=null===(l=y.type)||void 0===l?void 0:l.characterValue)&&void 0!==d?d:"self";e[p].ofTheConceptId in t?(n=t[e[p].ofTheConceptId],i in n||(n[i]={})):(n={},n[i]={},t[e[p].ofTheConceptId]=n);let c=yield(0,o.GetTheConcept)(e[p].typeId);try{let e=null!==(h=null===(u=null==v?void 0:v.type)||void 0===u?void 0:u.characterValue)&&void 0!==h?h:"none",t=v.characterValue,o=c.characterValue,s=(c.characterValue,!1);""==o&&(o=e,o=r(o),s=!0);let a={[e]:t};isNaN(Number(o))?c.characterValue.includes("_s_")||("string"==typeof n[i]&&(n[i]={}),n[i][o]=s?t:a):n[i]=[]}catch(e){console.log("this is error",e)}}}return t}))}(d,u,a);let h=yield function(e,t,n,i){return c(this,arguments,void 0,(function*(e,t,n,i,r=[]){var c,s,a,l,d,u;let h=[],p=[];for(let t=0;t<e.length;t++)p.push(e[t].toTheConceptId),p.push(e[t].ofTheConceptId),p.push(e[t].typeId);e.sort((function(e,t){return t.id-e.id}));for(let n=0;n<e.length;n++){let i=!1;r.includes(e[n].id)&&(i=!0);let h=yield(0,o.GetTheConcept)(e[n].ofTheConceptId),p=yield(0,o.GetTheConcept)(e[n].toTheConceptId);if(1==i){if(0!=h.id&&0!=p.id&&p.id in t){let i,r=null!==(s=null===(c=p.type)||void 0===c?void 0:c.characterValue)&&void 0!==s?s:"self";e[n].toTheConceptId in t?i=t[e[n].toTheConceptId]:(i={},i[r]={},t[e[n].toTheConceptId]=i);let a=yield(0,o.GetTheConcept)(e[n].typeId);try{let o=a.characterValue+"_reverse",c=t[e[n].ofTheConceptId];c&&(Array.isArray(i[r][o])?i[r][o].push(c):a.characterValue.includes("_s_")?(i[r][o]=[],i[r][o].push(c)):i[r][o]=c)}catch(e){console.log("this is error",e)}}}else if(0!=h.id&&0!=p.id&&h.id in t){let i,r=null!==(l=null===(a=h.type)||void 0===a?void 0:a.characterValue)&&void 0!==l?l:"self";e[n].ofTheConceptId in t?(i=t[e[n].ofTheConceptId],"string"==typeof i[r]&&(i[r]={})):(i={},i[r]={},t[e[n].ofTheConceptId]=i);let c=!1,s=(yield(0,o.GetTheConcept)(e[n].typeId)).characterValue;""==s&&(s=p.characterValue,c=!0),""==s&&(s=null!==(u=null===(d=null==p?void 0:p.type)||void 0===d?void 0:d.characterValue)&&void 0!==u?u:"");try{let o=t[e[n].toTheConceptId];o&&(Array.isArray(i[r])?c?i[r].push(o[s]):i[r].push(o):Array.isArray(i[r][s])?i[r][s].push(o):s.includes("_s_")?(i[r][s]=[],c?i[r][s].push(o[s]):i[r][s].push(o)):i[r][s]=c?o[s]:o)}catch(e){console.log("this is error",e)}}}for(let e=0;e<n.length;e++){let o=t[n[e]];o&&(o.id=n[e],h.push(o))}return h}))}(d,u,n,[],a);return h}))}function T(e,t,n,c,a){return y(this,arguments,void 0,(function*(e,t,n,c,a,h="DESC"){if(o.serviceWorker)try{return(yield(0,o.sendMessage)("formatConnectionsJustId",{linkers:e,conceptIds:t,mainCompositionIds:n,reverse:c,countInfos:a,order:h})).data}catch(e){console.error("formatConnectionsJustId error sw: ",e),(0,o.handleServiceWorkerException)(e)}let y=yield(0,i.QL)(e),v=yield(0,p.V)(a);y=f(y,h);let g=[];g=yield s(y,g,c),g=yield function(e,t){return d(this,arguments,void 0,(function*(e,t,n=[]){var o,i,c,s,a,d,u,h;let p=[];for(let t=0;t<e.length;t++)p.push(e[t].toTheConceptId),p.push(e[t].ofTheConceptId),p.push(e[t].typeId);for(let p=0;p<e.length;p++){let f=!1,y=yield(0,l.A)(e[p].ofTheConceptId),v=yield(0,l.A)(e[p].toTheConceptId);if(n.includes(e[p].id)&&(f=!0),1==f){if(0!=y.id&&0!=v.id){let n,a=yield(0,l.A)(e[p].typeId),d=null!==(i=null===(o=v.type)||void 0===o?void 0:o.characterValue)&&void 0!==i?i:"self";e[p].toTheConceptId in t?(n=t[e[p].toTheConceptId],d in n||(n[d]={})):(n={},n[d]={},t[e[p].toTheConceptId]=n);try{let e=null!==(s=null===(c=null==y?void 0:y.type)||void 0===c?void 0:c.characterValue)&&void 0!==s?s:"none",t=y.characterValue,o=a.characterValue;""==o&&(o=e,o=r(o));let i={id:y.id,[e]:t},l=o+"_reverse";l.includes("_s_")||("string"==typeof n[d]&&(n[d]={}),n[d][l]=i)}catch(e){console.log("this is error",e)}}}else if(0!=y.id&&0!=v.id){let n,o=yield(0,l.A)(e[p].typeId),i=null!==(d=null===(a=y.type)||void 0===a?void 0:a.characterValue)&&void 0!==d?d:"self";e[p].ofTheConceptId in t?(n=t[e[p].ofTheConceptId],i in n||(n[i]={})):(n={},n[i]={},t[e[p].ofTheConceptId]=n);try{let t=null!==(h=null===(u=null==v?void 0:v.type)||void 0===u?void 0:u.characterValue)&&void 0!==h?h:"none",c=v.characterValue,s=o.characterValue,a=!1;""==s&&(s=t,s=r(s),a=!0);let l={};l[t]={id:v.id,data:c,created_on:e[p].entryTimeStamp},isNaN(Number(s))?s.includes("_s_")||("string"==typeof n[i]&&(n[i]={}),n[i][s]=a?l[t]:l):n[i]=[]}catch(e){console.log("this is error",e)}}}return t}))}(y,g,c);let m=yield function(e,t,n){return d(this,arguments,void 0,(function*(e,t,n,o=[],i){var r,c,s,a,d,h,p;(new Date).getTime();let f=[],y=[];for(let t=0;t<e.length;t++)y.push(e[t].toTheConceptId),y.push(e[t].ofTheConceptId),y.push(e[t].typeId);for(let n=0;n<e.length;n++){let f=!1,y=yield(0,l.A)(e[n].ofTheConceptId),v=yield(0,l.A)(e[n].toTheConceptId);if(o.includes(e[n].id)&&(f=!0),1==f){if(0!=y.id&&0!=v.id&&v.id in t){let o,i=yield(0,l.A)(e[n].typeId),s=null!==(c=null===(r=v.type)||void 0===r?void 0:r.characterValue)&&void 0!==c?c:"self",a=!1;e[n].toTheConceptId in t&&(a=!0),e[n].toTheConceptId in t?(o=t[e[n].toTheConceptId],"string"==typeof o[s]&&(o[s]={})):(o={},o[s]={},t[e[n].toTheConceptId]=o);try{if(t[e[n].ofTheConceptId]){let r=t[e[n].ofTheConceptId];r&&(r.id=y.id,r.created_on=y.entryTimeStamp);let c=i.characterValue+"_reverse";Array.isArray(o[s][c])?o[s][c].push(r):c.includes("_s_")?(o[s][c]=[],o[s][c].push(r)):o[s][c]=r}}catch(e){console.log("this is error",e)}}}else if(0!=y.id&&0!=v.id&&y.id in t){let o,r=yield(0,l.A)(e[n].typeId),c=null!==(a=null===(s=y.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"self",f=!1;e[n].toTheConceptId in t&&(f=!0),e[n].ofTheConceptId in t?(o=t[e[n].ofTheConceptId],"string"==typeof o[c]&&(o[c]={})):(o={},o[c]={},t[e[n].ofTheConceptId]=o),u(y.id,i,o);let g=!1,m=r.characterValue;""==m&&(m=v.characterValue,g=!0),""==m&&(m=null===(d=null==v?void 0:v.type)||void 0===d?void 0:d.characterValue);try{let r=null!==(p=null===(h=null==v?void 0:v.type)||void 0===h?void 0:h.characterValue)&&void 0!==p?p:"none",s=t[e[n].toTheConceptId];if(s){let t={};t[r]={data:s[r],id:v.id,created_on:e[n].entryTimeStamp},Array.isArray(o[c])?g?o[c].push(s[m]):o[c].push(s):Array.isArray(o[c][m])?o[c][m].push(t):m.includes("_s_")?(o[c][m]=[],g?o[c][m].push(t[r]):o[c][m].push(t)):o[c][m]=g?t[r]:t,u(v.id,i,t)}}catch(e){console.log("this is error",e)}}}for(let e=0;e<n.length;e++){let o={};o=t[n[e]],o&&(o.id=n[e]),f.push(o)}return f}))}(y,g,n,c,v);return m}))}function I(e,t,n,c,s){return y(this,arguments,void 0,(function*(e,t,n,c,s,a="DESC"){if(o.serviceWorker)try{return(yield(0,o.sendMessage)("formatConnectionsDataId",{linkers:e,conceptIds:t,mainCompositionIds:n,reverse:c,countInfos:s,order:a})).data}catch(e){console.error("GetConnectionDataPrefetch error sw: ",e),(0,o.handleServiceWorkerException)(e)}let l=yield(0,i.QL)(e),d=yield(0,p.V)(s);l=f(l,a);let y=[];y=yield function(e,t){var n=arguments;return h(this,arguments,void 0,(function*(e,t,i=[]){var r,c,s,a,l,d,u,h;const p=o.Logger.logfunction("FormatFunctionData",n);let f=[];for(let t=0;t<e.length;t++)f.push(e[t].toTheConceptId),f.push(e[t].ofTheConceptId),f.push(e[t].typeId);for(let n=0;n<e.length;n++){let p=!1,f=yield(0,o.GetTheConcept)(e[n].ofTheConceptId),y=yield(0,o.GetTheConcept)(e[n].toTheConceptId);if(i.includes(e[n].id)&&(p=!0),1==p){if(0!=f.id&&0!=y.id){let i,l=yield(0,o.GetTheConcept)(e[n].typeId),d=null!==(c=null===(r=y.type)||void 0===r?void 0:r.characterValue)&&void 0!==c?c:"self";e[n].toTheConceptId in t?i=t[e[n].toTheConceptId]:(i={},i[d]={},t[e[n].toTheConceptId]=i);try{let e=null!==(a=null===(s=null==f?void 0:f.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"none",n=f.characterValue;(l.characterValue+"_reverse").includes("_s_")&&(f.id in t||(t[f.id]={}),t[f.id][e]=n),t[y.id]={}}catch(e){console.log("this is error",e)}}}else if(0!=f.id&&0!=y.id){let i,r=yield(0,o.GetTheConcept)(e[n].typeId),c=null!==(d=null===(l=f.type)||void 0===l?void 0:l.characterValue)&&void 0!==d?d:"self";e[n].ofTheConceptId in t?i=t[e[n].ofTheConceptId]:(i={},i[c]={},t[e[n].ofTheConceptId]=i);try{let e=null!==(h=null===(u=null==y?void 0:y.type)||void 0===u?void 0:u.characterValue)&&void 0!==h?h:"none",n=y.characterValue;r.characterValue.includes("_s_")&&(y.id in t||(t[y.id]={}),t[y.id][e]=n),t[f.id]={}}catch(e){console.log("this is error",e)}}}return o.Logger.logUpdate(p),t}))}(l,y,c),y=yield function(e,t){var n=arguments;return h(this,arguments,void 0,(function*(e,t,i=[]){var c,s,a,l,d,u,h,p;const f=o.Logger.logfunction("FormatFunctionDataForData",n);let y=[];for(let t=0;t<e.length;t++)y.push(e[t].toTheConceptId),y.push(e[t].ofTheConceptId),y.push(e[t].typeId);for(let n=0;n<e.length;n++){let f=!1,y=yield(0,o.GetTheConcept)(e[n].ofTheConceptId),v=yield(0,o.GetTheConcept)(e[n].toTheConceptId);if(i.includes(e[n].id)&&(f=!0),1==f){if(0!=y.id&&0!=v.id){let i,d=yield(0,o.GetTheConcept)(e[n].typeId),u=null!==(s=null===(c=v.type)||void 0===c?void 0:c.characterValue)&&void 0!==s?s:"self";e[n].toTheConceptId in t?(i=t[e[n].toTheConceptId],u in i||(i[u]={})):(i={},i[u]={},t[e[n].toTheConceptId]=i);try{let e=null!==(l=null===(a=null==y?void 0:y.type)||void 0===a?void 0:a.characterValue)&&void 0!==l?l:"none",t=y.characterValue,n=d.characterValue;""==n&&(n=e,n=r(n));let o={id:y.id,data:{[e]:t}},c=n+"_reverse";c.includes("_s_")||("string"==typeof i[u]&&(i[u]={}),i[u][c]=o)}catch(e){console.log("this is error",e)}}}else if(0!=y.id&&0!=v.id){let i,c=yield(0,o.GetTheConcept)(e[n].typeId),s=null!==(u=null===(d=y.type)||void 0===d?void 0:d.characterValue)&&void 0!==u?u:"self";e[n].ofTheConceptId in t?(i=t[e[n].ofTheConceptId],s in i||(i[s]={})):(i={},i[s]={},t[e[n].ofTheConceptId]=i);try{let e=null!==(p=null===(h=null==v?void 0:v.type)||void 0===h?void 0:h.characterValue)&&void 0!==p?p:"none",t=v.characterValue,n=c.characterValue,o=!1;""==n&&(n=e,n=r(n),o=!0);let a={id:v.id,data:{[e]:t}};isNaN(Number(n))?n.includes("_s_")||("string"==typeof i[s]&&(i[s]={}),i[s][n]=a):i[s]=[]}catch(e){console.log("this is error",e)}}}return o.Logger.logUpdate(f),t}))}(l,y,c);let v=yield function(e,t,n,i){var r=arguments;return h(this,arguments,void 0,(function*(e,t,n,i,c=[],s){var a,l,d,h,p,f;const y=o.Logger.logfunction("FormatFromConnectionsAlteredArrayExternal",r);let v=[],g=[];for(let t=0;t<e.length;t++)g.push(e[t].toTheConceptId),g.push(e[t].ofTheConceptId),g.push(e[t].typeId);for(let n=0;n<e.length;n++){let i=!1,r=yield(0,o.GetTheConcept)(e[n].ofTheConceptId),y=yield(0,o.GetTheConcept)(e[n].toTheConceptId);if(c.includes(e[n].id)&&(i=!0),1==i){if(0!=r.id&&0!=y.id&&y.id in t){let i,c=yield(0,o.GetTheConcept)(e[n].typeId),s=null!==(l=null===(a=y.type)||void 0===a?void 0:a.characterValue)&&void 0!==l?l:"self",d=!1;e[n].toTheConceptId in t&&(d=!0),e[n].toTheConceptId in t?(i=t[e[n].toTheConceptId],"string"==typeof i[s]&&(i[s]={})):(i={},i[s]={},t[e[n].toTheConceptId]=i);try{if(t[e[n].ofTheConceptId]){let o={id:r.id,data:t[e[n].ofTheConceptId],created_on:e[n].entryTimeStamp},a=c.characterValue+"_reverse";Array.isArray(i[s][a])?i[s][a].push(o):a.includes("_s_")?(i[s][a]=[],i[s][a].push(o)):i[s][a]=o}}catch(e){console.log("this is error",e)}}}else if(0!=r.id&&0!=y.id&&r.id in t){let i,c=yield(0,o.GetTheConcept)(e[n].typeId),a=null!==(h=null===(d=r.type)||void 0===d?void 0:d.characterValue)&&void 0!==h?h:"self",l=!1;e[n].toTheConceptId in t&&(l=!0),e[n].ofTheConceptId in t?(i=t[e[n].ofTheConceptId],"string"==typeof i[a]&&(i[a]={})):(i={},i[a]={},t[e[n].ofTheConceptId]=i),u(r.id,s,i);let v=!0,g=c.characterValue;""==g&&(g=y.characterValue,v=!0),""==g&&(g=null===(p=null==y?void 0:y.type)||void 0===p?void 0:p.characterValue);try{null===(f=null==y?void 0:y.type)||void 0===f||f.characterValue;let o=t[e[n].toTheConceptId];if(o){let r={id:y.id,data:t[e[n].toTheConceptId],created_on:e[n].entryTimeStamp};Array.isArray(i[a])?i[a].push(o):Array.isArray(i[a][g])?i[a][c.characterValue].push(r):g.includes("_s_")?(i[a][g]=[],i[a][g].push(r)):i[a][g]=r,u(y.id,s,r)}}catch(e){console.log("this is error",e)}}}for(let e=0;e<i.length;e++){let n={};n.id=i[e];let r=yield(0,o.GetTheConcept)(n.id);n.data=t[i[e]],n.created_on=r.entryTimeStamp,v.push(n)}return o.Logger.logUpdate(y),v}))}(l,y,[],n,c,d);return v}))}},3518:(e,t,n)=>{n.d(t,{BZ:()=>c,Xr:()=>i,ab:()=>r});var o=n(3278);function i(e="application/json",t="application/json"){let n={};return n=""!=o.b.BearerAccessToken?{"Content-Type":e,Authorization:"Bearer "+o.b.BearerAccessToken,Accept:t}:{"Content-Type":e,Accept:t},n}function r(e="application/json",t="",n="application/json"){""==t&&(t=o.b.BearerAccessToken);let i={};return i=""!=t?{"Content-Type":e,Authorization:"Bearer "+t,Accept:n}:{"Content-Type":e,Accept:n},i}function c(){let e=o.b.BearerAccessToken;const t=new Headers;return t.append("Authorization","Bearer "+e),t}},6467:(e,t,n)=>{function o(e){const t=e.lastIndexOf("_");let n=[];return n=t>0?[e.substring(0,t),e.substring(t+1,e.length)]:[e],n}n.d(t,{f:()=>o})},4310:(e,t,n)=>{n.d(t,{C:()=>l,i:()=>d});var o=n(2830),i=n(5898),r=n(1863),c=n(7106),s=n(3518),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e){var t=arguments;return a(this,void 0,void 0,(function*(){o.Logger.logfunction("BuildWidgetFromId",t);try{try{if(o.serviceWorker)return(yield(0,o.sendMessage)("BuildWidgetFromId",{id:e})).data}catch(e){console.error("BuildWidgetFromId error sw: ",e),(0,o.handleServiceWorkerException)(e)}let t=[],n=[],a=[],l=[],d="DESC",u=[],h={},p={},f=(0,s.Xr)("application/json"),y=o.BaseUrl.getWidgetData()+"?id="+e;const v=yield fetch(y,{method:"GET",headers:f});if(!v.ok)return(0,r.ry)(v),console.log("This is the BuildWidgetFromId error",v.status),[];h=yield v.json(),t=h.conceptIds,n=h.linkers,a=h.reverse,l=h.mainCompositionIds,u=h.countinfo;let g=(0,i.w)(u);return p=yield(0,c.e$)(n,t,l,a,g,d),p}catch(e){throw console.log("this is the error in the build widget",e),e}}))}function d(e,t){for(let n=0;n<e.length;n++)if(t==e[n].id)return e[n]}},4287:(e,t,n)=>{n.d(t,{w:()=>c});var o=n(2830),i=n(3130),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class c{constructor(){this.subscribers=[],this.mainConcept=0,this.compositionIds=[],this.conceptIds=[],this.internalConnections=[],this.reverse=[],this.linkers=[],this.dependency=[],this.isDataLoaded=!1,this.isUpdating=!1,this.fetched=!1,this.format=i.yv}listenToEventType(e){window.addEventListener(`${e}`,(e=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let t=this;setTimeout((function(){return r(this,void 0,void 0,(function*(){let n=e;if(!t.compositionIds.includes(null==n?void 0:n.detail)){t.compositionIds.unshift(null==n?void 0:n.detail),t.listenToEvent(null==n?void 0:n.detail);let e=null==n?void 0:n.detail,i=yield o.ConnectionData.GetConnectionByOfTheConceptAndType(e,e);for(let e=0;e<i.length;e++)yield o.ConnectionData.GetConnection(i[e]).then((e=>{e.typeId==t.mainConcept?t.internalConnections.includes(e.id)||t.internalConnections.push(e.id):t.linkers.includes(e.id)||t.linkers.push(e.id),t.conceptIds.includes(e.toTheConceptId)||t.conceptIds.push(e.toTheConceptId),t.compositionIds.includes(e.ofTheConceptId)||t.compositionIds.push(e.ofTheConceptId)}))}t.isUpdating=!1,yield t.bind(),t.notify()}))}),200)}}))}listenToEvent(e){window.addEventListener(`${e}`,(t=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let t=this;setTimeout((function(){return r(this,void 0,void 0,(function*(){let n=yield o.ConnectionData.GetConnectionByOfTheConceptAndType(e,e);for(let e=0;e<n.length;e++)yield o.ConnectionData.GetConnection(n[e]).then((e=>{e.typeId==t.mainConcept?t.internalConnections.includes(e.id)||t.internalConnections.push(e.id):t.linkers.includes(e.id)||t.linkers.push(e.id),t.conceptIds.includes(e.toTheConceptId)||t.conceptIds.push(e.toTheConceptId),t.compositionIds.includes(e.ofTheConceptId)||t.compositionIds.push(e.ofTheConceptId)}));t.isUpdating=!1,yield t.bind(),t.notify()}))}),200)}}))}listenToEventConnectionType(e,t){window.addEventListener(`${e}`,(n=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let n=this;setTimeout((function(){return r(this,void 0,void 0,(function*(){let i=yield o.ConnectionData.GetConnectionByOfTheConceptAndType(e,e);for(let e=0;e<i.length;e++)i.typeId==t&&(yield o.ConnectionData.GetConnection(i[e]).then((e=>{e.typeId==n.mainConcept?n.internalConnections.includes(e.id)||n.internalConnections.push(e.id):n.linkers.includes(e.id)||n.linkers.push(e.id),n.conceptIds.includes(e.toTheConceptId)||n.conceptIds.push(e.toTheConceptId),n.compositionIds.includes(e.ofTheConceptId)||n.compositionIds.push(e.ofTheConceptId)})));n.isUpdating=!1,yield n.bind(),n.notify()}))}),200)}}))}bind(){return r(this,void 0,void 0,(function*(){console.log("this is the old execute data")}))}subscribe(e){return r(this,void 0,void 0,(function*(){return this.subscribers.push(e),console.log("again executing data"),yield this.bind(),e(this.data)}))}unsubscribe(e){return this.subscribers.filter((t=>t!=e)),this.subscribers.length}notify(){console.log("notifiers",this.subscribers),this.subscribers.map((e=>{console.log("notify"),e(this.data)}))}}},5328:(e,t,n)=>{n.d(t,{d:()=>l});var o=n(2830),i=n(3130),r=n(8939),c=n(4287),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class a extends c.w{constructor(e,t,n,o,i){super(),this.connections=[],this.data=[],this.mainConcept=e,this.linker=t,this.inpage=n,this.page=o,this.format=i}bind(){return s(this,void 0,void 0,(function*(){var e;if(!this.isDataLoaded){let i=yield(0,o.GetTheConcept)(this.mainConcept),r=(null===(e=i.type)||void 0===e?void 0:e.characterValue)+"_s_"+this.linker,c=yield(0,o.GetConceptByCharacterAndType)(r,16);if(c.id>0){let e=yield(0,o.GetConnectionOfTheConcept)(c.id,i.id,i.userId,this.inpage,this.page);this.connections=e;for(var t=[],n=0;n<this.connections.length;n++)t.push(this.connections[n].toTheConceptId),this.linkers.push(this.connections[n].id),this.listenToEvent(this.connections[n].toTheConceptId);yield(0,o.GetAllConnectionsOfCompositionBulk)(t)}this.isDataLoaded=!0,this.listenToEvent(this.mainConcept)}return yield this.build()}))}build(){return s(this,void 0,void 0,(function*(){this.data=[],this.connections=yield(0,o.GetConnectionBulk)(this.linkers);for(var e=0;e<this.connections.length;e++){let t=this.connections[e].toTheConceptId,n=yield(0,o.GetTheConcept)(t);if(console.log("this is the format",this.format),this.format==i.yv){let e=yield(0,r.RW)(n.id);this.data.push(e)}else if(this.format==i.ZJ){let e=yield(0,r.kx)(n.id);this.data.push(e)}else if(this.format==i.iw){let e=yield(0,o.GetCompositionWithIdAndDateFromMemory)(n.id);this.data.push(e)}else{let e=yield(0,o.GetCompositionWithIdAndDateFromMemory)(n.id);this.data.push(e)}}return this.data}))}}function l(e,t,n,o,r=i.yv){return new a(e,t,n,o,r)}},2830:(e,t,n)=>{n.r(t),n.d(t,{ADMIN:()=>Un,ALLID:()=>En.BG,AccessTracker:()=>Je.J,AddGhostConcept:()=>dn,Anomaly:()=>Go,BaseUrl:()=>l.B,BinaryTree:()=>We.W,BuildWidgetFromId:()=>$o.C,BuilderStatefulWidget:()=>ko,Composition:()=>Et,CompositionBinaryTree:()=>xt,CompositionNode:()=>St,Concept:()=>no.j,ConceptsData:()=>a.I,Connection:()=>O.N,ConnectionData:()=>ze.d,CreateComposition:()=>D.A,CreateConnectionBetweenEntityLocal:()=>Ho,CreateConnectionBetweenTwoConcepts:()=>X,CreateConnectionBetweenTwoConceptsGeneral:()=>Z,CreateConnectionBetweenTwoConceptsLocal:()=>Ln.h,CreateDefaultConcept:()=>M.o,CreateDefaultLConcept:()=>nn.u,CreateSession:()=>Xt,CreateSessionVisit:()=>Zt,CreateTheCompositionLocal:()=>F.R,CreateTheCompositionWithCache:()=>Dt,CreateTheConnection:()=>ie.q,CreateTheConnectionGeneral:()=>$,CreateTheConnectionLocal:()=>on.F,DATAID:()=>En.y0,DATAIDDATE:()=>En.iw,DelayFunctionExecution:()=>bn,DeleteConceptById:()=>Pe,DeleteConceptLocal:()=>Gn,DeleteConnectionById:()=>J.m,DeleteConnectionByType:()=>Eo,DeleteUser:()=>je,DependencyObserver:()=>On.w,FilterSearch:()=>ao,FormatFromConnections:()=>un.vw,FormatFromConnectionsAltered:()=>un.y8,FreeschemaQuery:()=>Do,FreeschemaQueryApi:()=>_o,GetAllConnectionsOfComposition:()=>U.s,GetAllConnectionsOfCompositionBulk:()=>f.Y,GetAllTheConnectionsByTypeAndOfTheConcept:()=>Uo,GetComposition:()=>v.Nj,GetCompositionBulk:()=>et.dF,GetCompositionBulkWithDataId:()=>et.cw,GetCompositionFromConnectionsWithDataId:()=>et.p8,GetCompositionFromConnectionsWithDataIdFromConnections:()=>et.km,GetCompositionFromConnectionsWithDataIdInObject:()=>et.rv,GetCompositionFromConnectionsWithDataIdIndex:()=>et.Nt,GetCompositionFromConnectionsWithIndex:()=>et.as,GetCompositionFromConnectionsWithIndexFromConnections:()=>et.hG,GetCompositionFromMemoryWithConnections:()=>v.JA,GetCompositionList:()=>T,GetCompositionListAll:()=>I,GetCompositionListAllWithId:()=>w,GetCompositionListListener:()=>zn,GetCompositionListLocal:()=>b,GetCompositionListLocalWithId:()=>E,GetCompositionListWithId:()=>k,GetCompositionListWithIdUpdated:()=>N,GetCompositionListener:()=>Hn,GetCompositionLocal:()=>G,GetCompositionLocalWithId:()=>x,GetCompositionWithAllIds:()=>v.Mb,GetCompositionWithCache:()=>Ht,GetCompositionWithDataIdBulk:()=>zt,GetCompositionWithDataIdWithCache:()=>Jt,GetCompositionWithId:()=>v.yz,GetCompositionWithIdAndDateFromMemory:()=>v.Ez,GetConceptBulk:()=>pt.r,GetConceptByCharacter:()=>g.A,GetConceptByCharacterAndCategoryLocal:()=>m.$I,GetConceptByCharacterAndType:()=>re.A,GetConnectionBetweenTwoConceptsLinker:()=>Rn,GetConnectionBulk:()=>ft.j,GetConnectionById:()=>Xe,GetConnectionDataPrefetch:()=>et.QL,GetConnectionOfTheConcept:()=>W,GetLink:()=>se,GetLinkListListener:()=>to,GetLinkListener:()=>Qn.d,GetLinkRaw:()=>ae,GetLinkerConnectionFromConcepts:()=>Ee,GetLinkerConnectionToConcepts:()=>Ue,GetRelation:()=>en,GetRelationLocal:()=>vn,GetRelationRaw:()=>tn,GetTheConcept:()=>z.A,GetTheConceptLocal:()=>hn.f,GetUserGhostId:()=>ln,JUSTDATA:()=>En.ZJ,LConcept:()=>oo,LConnection:()=>io,LISTNORMAL:()=>En.SL,LocalConceptsData:()=>y.v,LocalSyncData:()=>so.H,LocalTransaction:()=>Ao,Logger:()=>yo.V,LoginToBackend:()=>gt,MakeTheInstanceConcept:()=>q.A,MakeTheInstanceConceptLocal:()=>K.k,MakeTheTimestamp:()=>Ze,MakeTheTypeConcept:()=>Ie,MakeTheTypeConceptApi:()=>Se,MakeTheTypeConceptLocal:()=>le.$,NORMAL:()=>En.yv,PRIVATE:()=>Dn,PUBLIC:()=>Fn,PatcherStructure:()=>ro,RAW:()=>En.XZ,RecursiveSearchApi:()=>nt,RecursiveSearchApiNewRawFullLinker:()=>ct,RecursiveSearchApiRaw:()=>it,RecursiveSearchApiRawFullLinker:()=>rt,RecursiveSearchApiWithInternalConnections:()=>ot,RecursiveSearchListener:()=>Zn,SchemaQueryListener:()=>Mo,SearchAllConcepts:()=>Ot,SearchLinkInternal:()=>Nn,SearchLinkInternalAll:()=>An,SearchLinkMultipleAll:()=>un.cf,SearchLinkMultipleAllObservable:()=>Vn,SearchLinkMultipleApi:()=>c.j,SearchQuery:()=>Ke,SearchStructure:()=>lo,SearchWithLinker:()=>Mt,SearchWithTypeAndLinker:()=>qn.zl,SearchWithTypeAndLinkerApi:()=>Wn,SessionData:()=>co,Signin:()=>wt,Signup:()=>Ct,SignupEntity:()=>Tt,SplitStrings:()=>s.f,StatefulWidget:()=>Io,SyncData:()=>V.Y,TrashTheConcept:()=>$e,UpdateComposition:()=>_t,UpdateCompositionLocal:()=>pn.D,UserBinaryTree:()=>sn,Validator:()=>Bo,ViewInternalData:()=>Tn,ViewInternalDataApi:()=>mn,WidgetTree:()=>Po,convertFromConceptToLConcept:()=>In.F4,convertFromLConceptToConcept:()=>In.dp,convertWidgetTreeToWidget:()=>Zo,convertWidgetTreeToWidgetWithWrapper:()=>Ko,createFormFieldData:()=>Ro,dispatchIdEvent:()=>yi,getFromDatabaseWithType:()=>ne,getObjectsFromIndexDb:()=>oe,getWidgetBulkFromId:()=>Yo,getWidgetFromId:()=>Xo,handleServiceWorkerException:()=>gi,hasActivatedSW:()=>ai,init:()=>ui,recursiveFetch:()=>v.zN,recursiveFetchNew:()=>Rt,renderLatestWidget:()=>qo,renderPage:()=>zo,renderWidget:()=>Qo,searchLinkMultipleListener:()=>Mn,sendEmail:()=>mo,sendMessage:()=>hi,serviceWorker:()=>oi,setHasActivatedSW:()=>li,storeToDatabase:()=>te,subscribedListeners:()=>ci,unwrapContainers:()=>ni,updateAccessToken:()=>di,uploadAttachment:()=>dt,uploadFile:()=>ht,uploadImage:()=>ut,validDocumentFormats:()=>lt,validImageFormats:()=>at});var o={};n.r(o),n.d(o,{ADMIN:()=>Un,ALLID:()=>En.BG,AccessTracker:()=>Je.J,AddGhostConcept:()=>dn,Anomaly:()=>Go,BaseUrl:()=>l.B,BinaryTree:()=>We.W,BuildWidgetFromId:()=>$o.C,BuilderStatefulWidget:()=>ko,Composition:()=>Et,CompositionBinaryTree:()=>xt,CompositionNode:()=>St,Concept:()=>no.j,ConceptsData:()=>a.I,Connection:()=>O.N,ConnectionData:()=>ze.d,CreateComposition:()=>D.A,CreateConnectionBetweenEntityLocal:()=>Ho,CreateConnectionBetweenTwoConcepts:()=>X,CreateConnectionBetweenTwoConceptsGeneral:()=>Z,CreateConnectionBetweenTwoConceptsLocal:()=>Ln.h,CreateDefaultConcept:()=>M.o,CreateDefaultLConcept:()=>nn.u,CreateSession:()=>Xt,CreateSessionVisit:()=>Zt,CreateTheCompositionLocal:()=>F.R,CreateTheCompositionWithCache:()=>Dt,CreateTheConnection:()=>ie.q,CreateTheConnectionGeneral:()=>$,CreateTheConnectionLocal:()=>on.F,DATAID:()=>En.y0,DATAIDDATE:()=>En.iw,DelayFunctionExecution:()=>bn,DeleteConceptById:()=>Pe,DeleteConceptLocal:()=>Gn,DeleteConnectionById:()=>J.m,DeleteConnectionByType:()=>Eo,DeleteUser:()=>je,DependencyObserver:()=>On.w,FilterSearch:()=>ao,FormatFromConnections:()=>un.vw,FormatFromConnectionsAltered:()=>un.y8,FreeschemaQuery:()=>Do,FreeschemaQueryApi:()=>_o,GetAllConnectionsOfComposition:()=>U.s,GetAllConnectionsOfCompositionBulk:()=>f.Y,GetAllTheConnectionsByTypeAndOfTheConcept:()=>Uo,GetComposition:()=>v.Nj,GetCompositionBulk:()=>et.dF,GetCompositionBulkWithDataId:()=>et.cw,GetCompositionFromConnectionsWithDataId:()=>et.p8,GetCompositionFromConnectionsWithDataIdFromConnections:()=>et.km,GetCompositionFromConnectionsWithDataIdInObject:()=>et.rv,GetCompositionFromConnectionsWithDataIdIndex:()=>et.Nt,GetCompositionFromConnectionsWithIndex:()=>et.as,GetCompositionFromConnectionsWithIndexFromConnections:()=>et.hG,GetCompositionFromMemoryWithConnections:()=>v.JA,GetCompositionList:()=>T,GetCompositionListAll:()=>I,GetCompositionListAllWithId:()=>w,GetCompositionListListener:()=>zn,GetCompositionListLocal:()=>b,GetCompositionListLocalWithId:()=>E,GetCompositionListWithId:()=>k,GetCompositionListWithIdUpdated:()=>N,GetCompositionListener:()=>Hn,GetCompositionLocal:()=>G,GetCompositionLocalWithId:()=>x,GetCompositionWithAllIds:()=>v.Mb,GetCompositionWithCache:()=>Ht,GetCompositionWithDataIdBulk:()=>zt,GetCompositionWithDataIdWithCache:()=>Jt,GetCompositionWithId:()=>v.yz,GetCompositionWithIdAndDateFromMemory:()=>v.Ez,GetConceptBulk:()=>pt.r,GetConceptByCharacter:()=>g.A,GetConceptByCharacterAndCategoryLocal:()=>m.$I,GetConceptByCharacterAndType:()=>re.A,GetConnectionBetweenTwoConceptsLinker:()=>Rn,GetConnectionBulk:()=>ft.j,GetConnectionById:()=>Xe,GetConnectionDataPrefetch:()=>et.QL,GetConnectionOfTheConcept:()=>W,GetLink:()=>se,GetLinkListListener:()=>to,GetLinkListener:()=>Qn.d,GetLinkRaw:()=>ae,GetLinkerConnectionFromConcepts:()=>Ee,GetLinkerConnectionToConcepts:()=>Ue,GetRelation:()=>en,GetRelationLocal:()=>vn,GetRelationRaw:()=>tn,GetTheConcept:()=>z.A,GetTheConceptLocal:()=>hn.f,GetUserGhostId:()=>ln,JUSTDATA:()=>En.ZJ,LConcept:()=>oo,LConnection:()=>io,LISTNORMAL:()=>En.SL,LocalConceptsData:()=>y.v,LocalSyncData:()=>so.H,LocalTransaction:()=>Ao,Logger:()=>yo.V,LoginToBackend:()=>gt,MakeTheInstanceConcept:()=>q.A,MakeTheInstanceConceptLocal:()=>K.k,MakeTheTimestamp:()=>Ze,MakeTheTypeConcept:()=>Ie,MakeTheTypeConceptApi:()=>Se,MakeTheTypeConceptLocal:()=>le.$,NORMAL:()=>En.yv,PRIVATE:()=>Dn,PUBLIC:()=>Fn,PatcherStructure:()=>ro,RAW:()=>En.XZ,RecursiveSearchApi:()=>nt,RecursiveSearchApiNewRawFullLinker:()=>ct,RecursiveSearchApiRaw:()=>it,RecursiveSearchApiRawFullLinker:()=>rt,RecursiveSearchApiWithInternalConnections:()=>ot,RecursiveSearchListener:()=>Zn,SchemaQueryListener:()=>Mo,SearchAllConcepts:()=>Ot,SearchLinkInternal:()=>Nn,SearchLinkInternalAll:()=>An,SearchLinkMultipleAll:()=>un.cf,SearchLinkMultipleAllObservable:()=>Vn,SearchLinkMultipleApi:()=>c.j,SearchQuery:()=>Ke,SearchStructure:()=>lo,SearchWithLinker:()=>Mt,SearchWithTypeAndLinker:()=>qn.zl,SearchWithTypeAndLinkerApi:()=>Wn,SessionData:()=>co,Signin:()=>wt,Signup:()=>Ct,SignupEntity:()=>Tt,SplitStrings:()=>s.f,StatefulWidget:()=>Io,SyncData:()=>V.Y,TrashTheConcept:()=>$e,UpdateComposition:()=>_t,UpdateCompositionLocal:()=>pn.D,UserBinaryTree:()=>sn,Validator:()=>Bo,ViewInternalData:()=>Tn,ViewInternalDataApi:()=>mn,WidgetTree:()=>Po,convertFromConceptToLConcept:()=>In.F4,convertFromLConceptToConcept:()=>In.dp,convertWidgetTreeToWidget:()=>Zo,convertWidgetTreeToWidgetWithWrapper:()=>Ko,createFormFieldData:()=>Ro,dispatchIdEvent:()=>yi,getFromDatabaseWithType:()=>ne,getObjectsFromIndexDb:()=>oe,getWidgetBulkFromId:()=>Yo,getWidgetFromId:()=>Xo,handleServiceWorkerException:()=>gi,hasActivatedSW:()=>ai,init:()=>ui,recursiveFetch:()=>v.zN,recursiveFetchNew:()=>Rt,renderLatestWidget:()=>qo,renderPage:()=>zo,renderWidget:()=>Qo,searchLinkMultipleListener:()=>Mn,sendEmail:()=>mo,sendMessage:()=>hi,serviceWorker:()=>oi,setHasActivatedSW:()=>li,storeToDatabase:()=>te,subscribedListeners:()=>ci,unwrapContainers:()=>ni,updateAccessToken:()=>di,uploadAttachment:()=>dt,uploadFile:()=>ht,uploadImage:()=>ut,validDocumentFormats:()=>lt,validImageFormats:()=>at});var i=n(5020),r=n(205),c=n(2832),s=n(6467),a=n(9639),l=n(9581),d=n(3518),u=n(1863),h=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function p(e,t){var n=arguments;return h(this,void 0,void 0,(function*(){const o=yo.V.logfunction("GetAllConceptsByType",n);try{var i=new URLSearchParams;i.append("type",e),i.append("user_id",t.toString());var r=(0,d.Xr)("application/x-www-form-urlencoded");const n=yield fetch(l.B.GetAllConceptsByTypeUrl(),{method:"POST",headers:r,body:i});if(n.ok){const e=yield n.json();for(var c=0;c<e.length;c++)a.I.AddConcept(e[c])}else console.log("GetAllConceptsByType error",n.status),(0,u.ry)(n)}catch(e){e instanceof Error?console.log("GetAllConceptsByType error message: ",e.message):console.log("GetAllConceptsByType unexpected error: ",e),(0,u.Mb)(e,l.B.GetAllConceptsByTypeUrl()),(0,u.ey)(o,"GetAllConceptsByType",e)}}))}var f=n(8642),y=n(9736),v=n(8939),g=n(2013),m=n(8064),C=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function T(e,t){var n=arguments;return C(this,arguments,void 0,(function*(e,t,o=10,i=1){const r=yo.V.logfunction("GetCompositionList",n);if(oi){r.serviceWorker=!0;try{const n=yield hi("GetCompositionList",{compositionName:e,userId:t,inpage:o,page:i});return yo.V.logUpdate(r),n.data}catch(e){console.error("GetCompositionList sw error: ",e),(0,u.ey)(r,"GetCompositionList",e),gi(e)}}let c=yield(0,g.A)(e),s=[];if(c){yield p(e,t);let n=yield a.I.GetConceptsByTypeIdAndUser(c.id,t),r=o*(i-1),l=[];for(let e=r;e<r+o;e++)n[e]&&l.push(n[e].id);yield(0,f.Y)(l);for(let e=r;e<r+o;e++)if(n[e]){let t=yield(0,v.kx)(n[e].id);s.push(t)}}return yo.V.logUpdate(r),s}))}function I(e,t){return C(this,arguments,void 0,(function*(e,t,n=10,o=1){let i=b(e,t),r=T(e,t),c=[];return Promise.race([i,r]).then((e=>{console.log("Promise result",e),c.push(...e)})).catch((e=>{console.log("error in handling",e)})),r.then((e=>{console.log("This is the second promise result",e),c.push(...e)})),c}))}function w(e,t){return C(this,arguments,void 0,(function*(e,t,n=10,o=1){if(oi)try{return(yield hi("GetCompositionListAllWithId",{compositionName:e,userId:t,inpage:n,page:o})).data}catch(e){console.error("GetCompositionListAllWithId sw error: ",e),gi(e)}let i=yield(0,m.Ay)(e),r=yield(0,g.A)(e),c=[],s=[],l=[],d=[];0!=i.id&&(s=yield y.v.GetConceptsByTypeIdAndUser(i.id,t)),0!=r.id&&(yield p(e,t),d=yield a.I.GetConceptsByTypeIdAndUser(r.id,t),c=d);for(let e=0;e<s.length;e++){let t=!1;for(let n=0;n<d.length;n++)s[e].ghostId==d[n].ghostId&&(t=!0);t||l.push(s[e])}console.log("This is the all list",l);let u=[];return u=yield function(e,t){return C(this,arguments,void 0,(function*(e,t,n=10,o=1){let i=[],r=n*(o-1),c=[],s=t.length;for(let t=r;t<r+n-s;t++)e[t]&&c.push(e[t].id);for(let e=0;e<t.length;e++){let n=yield x(t[e].id);i.push(n)}yield(0,f.Y)(c);for(let t=r;t<r+n-s;t++)if(e[t]){let n=yield(0,v.RW)(e[t].id);i.push(n)}return i}))}(c,l,n,o),u}))}function k(e,t){return C(this,arguments,void 0,(function*(e,t,n=10,o=1){if(oi)try{return(yield hi("GetCompositionListWithId",{compositionName:e,userId:t,inpage:n,page:o})).data}catch(e){console.error("GetCompositionListWithId sw error: ",e),gi(e)}let i=yield(0,g.A)(e),r=[];if(i){yield p(e,t);let c=yield a.I.GetConceptsByTypeIdAndUser(i.id,t),s=n*(o-1),l=[];for(let e=s;e<s+n;e++)c[e]&&l.push(c[e].id);yield(0,f.Y)(l);for(let e=s;e<s+n;e++)if(c[e]){let t=yield(0,v.RW)(c[e].id);r.push(t)}}return r}))}function N(e,t){return C(this,arguments,void 0,(function*(e,t,n=10,o=1){let i=yield(0,g.w)(e),r=[];if(i){yield p(e,t);let c=yield a.I.GetConceptsByTypeIdAndUser(i.id,t),s=n*(o-1),l=[];for(let e=s;e<s+n;e++)c[e]&&l.push(c[e].id);yield(0,f.Y)(l);for(let e=s;e<s+n;e++)if(c[e]){let t=yield(0,v.RW)(c[e].id);r.push(t)}}return r}))}var A=n(4864),L=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},S=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function G(e){return S(this,void 0,void 0,(function*(){var t,n;try{if(oi)try{return(yield hi("GetCompositionLocal",{id:e})).data}catch(e){console.error("GetCompositionLocal error sw: ",e),gi(e)}let o=[],i={};o=yield A.G.GetConnectionsOfCompositionLocal(e);let r=[];for(let e=0;e<o.length;e++)r.includes(o[e].ofTheConceptId)||r.push(o[e].ofTheConceptId);let c=yield y.v.GetConcept(e);if(0==c.id){let t=yield function(e){var t=arguments;return L(this,void 0,void 0,(function*(){const n=yo.V.logfunction("TranslateLocalToReal",t);let o=(0,M.o)();try{var i=(0,d.ab)("application/x-www-form-urlencoded");const t=yield fetch(l.B.GetRealConceptById(),{method:"POST",headers:i,body:`id=${e}`});if(t.ok)return o=yield t.json(),o.id>0&&a.I.AddConcept(o),o;console.log("Error in Getting Translating concept Error",t.status),(0,u.ry)(t),yo.V.logUpdate(n)}catch(e){e instanceof Error?console.log("Error in Getting Translating concept error message: ",e):console.log("Error in Getting Translating concept unexpected error: ",e),(0,u.Mb)(e,l.B.GetRealConceptById()),(0,u.ey)(n,"TranslateLocalToReal",e)}return o}))}(e);if(t.id>0)return yield(0,v.Nj)(t.id)}let s=yield B(e,o,r);return i[null!==(n=null===(t=null==c?void 0:c.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:"top"]=s,i}catch(e){throw e}}))}function x(e){return S(this,void 0,void 0,(function*(){var t,n;try{if(oi)try{return(yield hi("GetCompositionLocalWithId",{id:e})).data}catch(e){console.error("GetCompositionLocalWithId error sw: ",e),gi(e)}let o=[],i={},r={};o=yield A.G.GetConnectionsOfCompositionLocal(e);let c=[];for(let e=0;e<o.length;e++)c.includes(o[e].ofTheConceptId)||c.push(o[e].ofTheConceptId);let s=yield y.v.GetConcept(e);if(0!=s.id){let r=yield B(e,o,c);i[null!==(n=null===(t=null==s?void 0:s.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:"top"]=r}return r.data=i,r.id=e,r}catch(e){throw e}}))}function B(e,t,n){return S(this,arguments,void 0,(function*(e,t,n,o=[]){var i,r,c;let s={},a=[],l=yield y.v.GetConcept(e);if(0!=l.id&&null==l.type){let e=l.typeId,t=yield y.v.GetConcept(e);l.type=t}if(null===(i=null==l?void 0:l.type)||void 0===i?void 0:i.characterValue,!n.includes(e))return null==l?void 0:l.characterValue;if(o.includes(e))return"";o.push(e);for(let o=0;o<t.length;o++)if(t[o].ofTheConceptId==e){let e=t[o].toTheConceptId,i=yield y.v.GetConcept(e);if(0!=i.id&&null==(null==i?void 0:i.type)){let e=i.typeId,t=yield y.v.GetConcept(e);i.type=t}let l="the_",d=(null!==(c=null===(r=null==i?void 0:i.type)||void 0===r?void 0:r.characterValue)&&void 0!==c?c:"top").replace(l,"");if(isNaN(Number(d))){if(d){const o=yield B(e,t,n);s[d]=o}}else{const o=yield B(e,t,n);a[d]=o,s=a}}return s}))}var R=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function b(e,t){return R(this,void 0,void 0,(function*(){if(oi)try{return(yield hi("GetCompositionListLocal",{compositionName:e,userId:t})).data}catch(e){console.error("GetCompositionListLocal error sw: ",e),gi(e)}try{let n=yield(0,m.Ay)(e),o=[];if(0!=n.id){let e=yield y.v.GetConceptsByTypeIdAndUser(n.id,t);for(let t=0;t<e.length;t++){let n=yield G(e[t].id);o.push(n)}}return o}catch(e){throw e}}))}function E(e,t){return R(this,void 0,void 0,(function*(){if(oi)try{return(yield hi("GetCompositionListLocalWithId",{compositionName:e,userId:t})).data}catch(e){console.error("GetCompositionListLocalWithId error sw: ",e),gi(e)}try{let n=yield(0,m.Ay)(e),o=[];if(0!=n.id){let e=yield y.v.GetConceptsByTypeIdAndUser(n.id,t);for(let t=0;t<e.length;t++){let n=yield x(e[t].id);o.push(n)}}return o}catch(e){throw e}}))}var U=n(2),D=n(1218),F=n(999),_=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function W(e,t,n){var o=arguments;return _(this,arguments,void 0,(function*(e,t,n,i=10,r=1){const c=yo.V.logfunction("GetConnectionOfTheConcept",o);let s=[];try{if(oi){c.serviceWorker=!0;try{const o=yield hi("GetConnectionOfTheConcept",{typeId:e,ofTheConceptId:t,userId:n,inpage:i,page:r});return yo.V.logUpdate(c),o.data}catch(e){console.error("GetConnectionOfTheConcept sw error: ",e),(0,u.ey)(c,"GetConnectionOfTheConcept",e),gi(e)}}let o=new URLSearchParams;o.append("typeId",`${e}`),o.append("ofTheConceptId",`${t}`),o.append("userId",`${n}`),o.append("inpage",`${i}`),o.append("page",`${r}`);let a=(0,d.Xr)("application/x-www-form-urlencoded");const h=yield fetch(l.B.GetAllConnectionsOfConceptUrl(),{method:"POST",headers:a,body:o});return h.ok?s=yield h.json():((0,u.ey)(c,"GetConnectionOfTheConcept",h.status),(0,u.ry)(h),console.log("Get connection of concept error",h.status)),yo.V.logUpdate(c),s}catch(e){e instanceof Error?console.log("Get connection of concept  error message: ",e.message):console.log("Get connection of concept unexpected error: ",e),(0,u.Mb)(e,l.B.GetAllConnectionsOfConceptUrl()),(0,u.ey)(c,"GetConnectionOfTheConcept",e)}}))}var O=n(2155),V=n(442),M=n(7282),P=n(5976),j=n(7273),H=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function $(e,t,n,o){return H(this,arguments,void 0,(function*(e,t,n,o,i=1,r=4){if(e>0&&n>0){var c=t,s=yield P.p.getId(),a=new O.N(s,e,n,c,o,i,r);return e==n?(a.ofTheConceptId=0,a.toTheConceptId=1,a):(a.toUpdate=!0,a.isTemp=!1,V.Y.AddConnection(a),a)}throw new j.z("cannot create connection because id are negative ",!1,400,"")}))}var J=n(1838),z=n(7876),q=n(8407),Q=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function X(e,t,n){return Q(this,arguments,void 0,(function*(e,t,n,o=!1,i=!1){var r,c;if(oi)try{return(yield hi("CreateConnectionBetweenTwoConcepts",{ofTheConcept:e,toTheConcept:t,linker:n,both:o,count:i})).data}catch(e){console.error("CreateConnectionBetweenTwoConcepts sw error: ",e),gi(e)}let s=e.userId;if(o){let o=n+"_by",c=(null===(r=t.type)||void 0===r?void 0:r.characterValue)+"_s_"+o;i&&(yield Y(o,t,s));let a=yield(0,q.A)("connection",c,!1,999,999,999),l=new O.N(0,t.id,e.id,s,a.id,1e3,4);V.Y.AddConnection(l)}let a=n+"_s",l=(null===(c=e.type)||void 0===c?void 0:c.characterValue)+"_s_"+a;i&&(yield Y(a,e,s));let d=yield(0,q.A)("connection",l,!1,999,999,999),u=new O.N(0,e.id,t.id,s,d.id,1e3,4);return V.Y.AddConnection(u),u}))}function Y(e,t){return Q(this,arguments,void 0,(function*(e,t,n=null){var o;let i=t,r=null!=n?n:t.userId,c=e+"_count",s=(null===(o=t.type)||void 0===o?void 0:o.characterValue)+"_s_"+c,a=yield(0,q.A)("connection",s,!1,r,4,999),l=yield W(a.id,t.id,r,10,1),d=[],u=(0,M.o)();for(let e=0;e<l.length;e++){let t=yield(0,z.A)(l[e].toTheConceptId);d.push(t)}if(d.length<1)u=yield(0,q.A)("count","1",!1,r,4,999);else{let e=d[0],t=0;try{t=Number(e.characterValue)}catch(e){t=0}t+=1,u=yield(0,q.A)("count",t.toString(),!1,r,4,999);for(let e=0;e<l.length;e++)(0,J.m)(l[e].id)}let h=new O.N(0,i.id,u.id,i.userId,a.id,1e3,4);yield V.Y.AddConnection(h)}))}function Z(e,t,n){return Q(this,arguments,void 0,(function*(e,t,n,o=!1,i=!1){var r,c;let s=e.userId;if(o){let o=n+"_by",c=(null===(r=t.type)||void 0===r?void 0:r.characterValue)+"_s_"+o;i&&(yield Y(o,t,s));let a=yield(0,q.A)("connection",c,!1,999,999,999),l=new O.N(0,t.id,e.id,s,a.id,1e3,4);V.Y.AddConnection(l)}let a=n+"_s",l=(null===(c=e.type)||void 0===c?void 0:c.characterValue)+"_s_"+a;i&&(yield Y(a,e,s));let d=yield(0,q.A)("connection",l,!1,999,999,999);return yield $(e.id,e.userId,t.id,d.id,1e3,4)}))}var K=n(5868),ee=(n(3655),function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))});function te(e,t){const n=yo.V.logfunction("storeToDatabase",[e,"noindexdb"]);yo.V.logUpdate(n)}function ne(e,t,n){return ee(this,void 0,void 0,(function*(){const t=yo.V.logfunction("getFromDatabaseWithType",[e,"noindexdb"]);yo.V.logUpdate(t)}))}function oe(e){return ee(this,void 0,void 0,(function*(){const t=yo.V.logfunction("getObjectsFromIndexDb",[e,"noindexdb"]);yo.V.logUpdate(t)}))}var ie=n(1666),re=n(4402),ce=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function se(e,t){var n=arguments;return ce(this,arguments,void 0,(function*(e,t,o=10,i=1){var r;const c=yo.V.logfunction("GetLink",n);if(oi){c.serviceWorker=!0;try{const n=yield hi("GetLink",{id:e,linker:t,inpage:o,page:i});return yo.V.logUpdate(c),n.data}catch(e){console.error("GetLink sw error: ",e),(0,u.ey)(c,"GetLink",e),gi(e)}}let s=[],a=yield(0,z.A)(e),l=(null===(r=a.type)||void 0===r?void 0:r.characterValue)+"_s_"+t,d=yield(0,re.A)(l,16);if(d.id>0){let e=yield W(d.id,a.id,a.userId,o,i),t=[];for(let n=0;n<e.length;n++)t.push(e[n].toTheConceptId);yield(0,f.Y)(t);for(let t=0;t<e.length;t++){let n=e[t].toTheConceptId,o=yield(0,z.A)(n),i=yield(0,v.Ez)(o.id);s.push(i)}}return yo.V.logUpdate(c),s}))}function ae(e,t){var n=arguments;return ce(this,arguments,void 0,(function*(e,t,o=10,i=1){var r;const c=yo.V.logfunction("GetLinkRaw",n);let s=[],a=yield(0,z.A)(e),l=(null===(r=a.type)||void 0===r?void 0:r.characterValue)+"_s_"+t,d=yield(0,re.A)(l,16);if(d.id>0){let e=yield W(d.id,a.id,a.userId,o,i),t=[];for(let n=0;n<e.length;n++)t.push(e[n].toTheConceptId);for(let t=0;t<e.length;t++){let n=e[t].toTheConceptId,o=yield(0,z.A)(n);s.push(o)}}return yo.V.logUpdate(c),s}))}var le=n(8357),de=n(2212);class ue{constructor(e,t,n,o,i,r,c,s,a,l){this.id=0,this.isNew=!1,this.userId=e,this.data=`${t}`,this.securityId=n,this.securityUserId=o,this.accessId=i,this.accessUserId=r,this.sessionId=c,this.sessionUserId=s,this.isNew=l}}class he{constructor(){this.name="character Repository"}static AddCharacter(e){this.characterData[e.id]=e}static GetCharacter(e){for(var t=new ue(0,"0",0,0,0,0,0,0,"0",!1),n=0;n<this.characterData.length;n++)this.characterData[n].data==e&&(t=this.characterData[n]);return t}}he.characterData=[];class pe{constructor(e,t,n,o){this.id=e,this.userId=t,this.referentId=n,this.isNew=o}}var fe=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},ye=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function ve(e,t,n,o,i){return ye(this,void 0,void 0,(function*(){return new ue(t,e,n,t,o,t,i,t,"",!1),yield function(){return fe(this,void 0,void 0,(function*(){var e;const t=yo.V.logfunction("CreateTheCharacter",e);try{if(0==(e=he.GetCharacter(e.data)).id){var n=(0,d.Xr)();const i=yield fetch(l.B.CreateTheCharacterDataUrl(),{method:"POST",headers:n,body:JSON.stringify(e)});if(!i.ok)throw(0,u.ry)(i),new Error(`Error! status: ${i.status}`);const r=yield i.json();var o=new ue(r.userId,e.data,0,0,4,4,999,999,"",!1);return o.id=r.id,he.AddCharacter(o),yo.V.logUpdate(t),r}return new pe(e.id,e.userId,0,!1)}catch(e){throw e instanceof Error?console.log("create the character error message: ",e.message):console.log("create the character unexpected error: ",e),(0,u.ey)(t,"CreateTheCharacter",e),e}}))}()}))}var ge=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function me(e,t,n,o,i,r,c){return ge(this,void 0,void 0,(function*(){let s=yield(0,re.A)(e,o),a=s;return 0==a.id&&(s=yield(0,de.Ay)(e,t,n,o,i,r,c),a=s),a}))}var Ce=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},Te=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Ie(e,t,n,o){var i=arguments;return Te(this,void 0,void 0,(function*(){const r=yo.V.logfunction("MakeTheTypeConcept",i);if(oi){r.serviceWorker=!0;try{const i=yield hi("MakeTheTypeConcept",{typeString:e,sessionId:t,sessionUserId:n,userId:o});return yo.V.logUpdate(r),i.data}catch(e){console.error("MakeTheTypeConcept sw error: ",e),(0,u.ey)(r,"MakeTheTypeConcept",e),gi(e)}}let c=yield(0,g.A)(e);if(c&&(0==c.id||0==c.userId)){let i=(0,s.f)(e);if(i.length>0)if(i[0]==e){let n=yield function(e,t,n,o,i,r){return Ce(this,void 0,void 0,(function*(){let n;if(1==e.length){let i=e.charCodeAt(0),c=49;yield ve(e,t,999,o,r),n=me(e,t,4,c,i,o,"the_character")}else{let i=yield ve(e,t,999,o,r);i.isNew,n=yield me(e,t,4,51,i.id,o,"the_characters")}return n}))}(e,o,0,999,0,t);c=n}else{let r=yield Ie(i[0],t,n,o),s=yield Ie(i[1],t,n,o);s&&(c=yield(0,de.N)(e,o,r.id,s.id,999,999,i[1]))}}return yo.V.logUpdate(r),c}))}var we=n(8146),ke=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},Ne=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Ae(e){return Ne(this,void 0,void 0,(function*(){const t=yo.V.logfunction("GetConceptByCharacterAndCategory",e);let n=(0,M.o)();if("the"==e)return n.id=1,n.typeId=5,n.characterValue="the",n;let o=(0,s.f)(e);if(o.length>1){let t=1,i=yield Ae(o[0]);0!=i.id&&(t=i.id),n=yield function(e,t){var n=arguments;return Ne(this,void 0,void 0,(function*(){const o=yo.V.logfunction("GetConceptByCharacterAndCategoryFromMemory",n);let i=yield a.I.GetConceptByCharacterAndCategoryLocal(e,t);return 0==i.id&&(i=yield function(e,t){var n=arguments;return ke(this,void 0,void 0,(function*(){const o=yo.V.logfunction("GetConceptByCharacterAndCategoryDirectApi",n);let i=(0,M.o)();try{var r=(0,d.Xr)("application/x-www-form-urlencoded");const n=yield fetch(l.B.GetConceptByCharacterAndCategoryDirectUrl(),{method:"POST",headers:r,body:`character_value=${e}&category_id=${t}`});n.ok?(i=yield n.json(),a.I.AddConcept(i)):(console.log("This is the concept by category and character error",n.status),(0,u.ry)(n)),yo.V.logUpdate(o)}catch(e){e instanceof Error?console.log(" This is the concept by category and character error message: ",e.message):console.log(" This is the concept by category and character unexpected error: ",e),(0,u.Mb)(e,l.B.GetConceptByCharacterAndCategoryDirectUrl()),(0,u.ey)(o,"GetConceptByCharacterAndCategoryDirectApi",e)}return i}))}(e,t)),yo.V.logUpdate(o),i}))}(e,t)}else o[0]==e&&(n=yield function(e){var t=arguments;return Ne(this,void 0,void 0,(function*(){const n=yo.V.logfunction("GetConceptByCharacter",t);let o=yield a.I.GetConceptByCharacterAndTypeLocal(e,51);return 0==o.id&&(o=yield(0,we.Y)(e)),yo.V.logUpdate(n),o}))}(e));return yo.V.logUpdate(t),n}))}var Le=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Se(e,t){var n=arguments;return Le(this,void 0,void 0,(function*(){const t=yo.V.logfunction("MakeTheTypeConceptApi",n);let o=(0,M.o)();try{if(o=yield Ae(e),0==o.id||4==o.typeId){let n=(0,d.Xr)("application/x-www-form-urlencoded");const i=yield fetch(l.B.MakeTheTypeConceptUrl(),{method:"POST",headers:n,body:`type=${e}`});if(!i.ok)throw(0,u.ry)(i),new Error(`Error! status: ${i.status}`);o=yield i.json(),yo.V.logUpdate(t)}}catch(e){e instanceof Error?console.log("Make The Type Concept Api error : ",e.message):console.log("Make The Type Concept Api error : ",e),(0,u.Mb)(e,l.B.MakeTheTypeConceptUrl()),(0,u.ey)(t,"MakeTheTypeConceptApi",e)}return o}))}var Ge=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function xe(e){var t=arguments;return Ge(this,void 0,void 0,(function*(){yo.V.logfunction("GetAllLinkerConnectionsFromTheConcept",t);var n=[];try{(new Date).getTime();var o=(0,d.Xr)("application/x-www-form-urlencoded");const t=yield fetch(l.B.GetAllLinkerConnectionOfConceptUrl()+`?conceptId=${e}`,{method:"GET",headers:o});if(t.ok){const e=yield t.json();for(var i=0;i<e.length;i++){var r=e[i];n.push(r)}}else console.log("Get all linker connection from the concepts error","cannot get respone"),(0,u.ry)(t)}catch(e){e instanceof Error?console.log("Get all linker connection from the concepts error: ",e.message):console.log("Get all linker connection from the concepts error(Unexpected): ",e),(0,u.Mb)(e,l.B.GetAllLinkerConnectionOfConceptUrl())}return n}))}var Be=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Re(e){var t=arguments;return Be(this,void 0,void 0,(function*(){const n=yo.V.logfunction("GetAllLinkerConnectionsToTheConcept",t);var o=[];try{(new Date).getTime();var i=(0,d.Xr)("application/x-www-form-urlencoded");const t=yield fetch(l.B.GetAllLinkerConnectionToConceptUrl()+`?conceptId=${e}`,{method:"GET",headers:i});if(t.ok){const e=yield t.json();for(var r=0;r<e.length;r++){var c=e[r];o.push(c)}yo.V.logUpdate(n)}else console.log("Get all linker connection To the concepts error","cannot get respone"),(0,u.ry)(t)}catch(e){e instanceof Error?console.log("Get all linker connection To the concepts error: ",e.message):console.log("Get all linker connection To the concepts error(Unexpected): ",e),(0,u.Mb)(e,l.B.GetAllLinkerConnectionToConceptUrl()),(0,u.ey)(n,"GetAllLinkerConnectionsToTheConcept",e)}return o}))}var be=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Ee(e){var t=arguments;return be(this,void 0,void 0,(function*(){const n=yo.V.logfunction("GetLinkerConnectionFromConcepts",t);let o=yield xe(e);for(let e=0;e<o.length;e++){let t=o[e],n=t.typeId,i=yield(0,z.A)(n);t.type=i}return yo.V.logUpdate(n),o}))}function Ue(e){var t=arguments;return be(this,void 0,void 0,(function*(){const n=yo.V.logfunction("GetLinkerConnectionToConcepts",t);let o=yield Re(e);for(let e=0;e<o.length;e++){let t=o[e],n=t.typeId,i=yield(0,z.A)(n);t.type=i}return yo.V.logUpdate(n),o}))}var De=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},Fe=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},_e=n(6963),We=n(2202),Oe=n(5457),Ve=n(991),Me=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Pe(e){var t=arguments;return Me(this,void 0,void 0,(function*(){const n=yo.V.logfunction("DeleteConceptById",t);if(oi)try{return(yield hi("DeleteConceptById",{id:e})).data}catch(e){console.error("DeleteConceptById sw error: ",e),gi(e)}if(e>0){var o=yield a.I.GetConcept(e);if(o.id>0){var i=o.typeId,r=o.characterValue;yield Oe.c.removeTypeConcept(i,e),yield _e.f.removeNodeByCharacter(r,e),yield function(e){var t=arguments;return Fe(this,void 0,void 0,(function*(){const n=yo.V.logfunction("DeleteTheConcept",t);try{const t=new FormData;t.append("id",e.toString());let o=(0,d.BZ)();const i=yield fetch(l.B.DeleteConceptUrl(),{method:"POST",headers:o,body:t});i.ok||(console.log("Delete concept error",i.status),(0,u.ry)(i)),yo.V.logUpdate(n)}catch(e){e instanceof Error?console.log("Delete concept error message: ",e.message):console.log("Delete concept unexpected error: ",e),(0,u.Mb)(e,l.B.DeleteConceptUrl()),(0,u.ey)(n,"DeleteTheConcept",e)}}))}(e),yield We.W.removeNodeFromTree(e),yield Ve.H.removeNodeFromTree(e)}}else y.v.RemoveConceptById(e);yo.V.logUpdate(n)}))}function je(e){return Me(this,void 0,void 0,(function*(){if(oi)try{return(yield hi("DeleteUser",{id:e})).data}catch(e){console.error("DeleteUser sw error: ",e),gi(e)}e>0?function(e){var t=arguments;De(this,void 0,void 0,(function*(){const n=yo.V.logfunction("DeleteUserInBackend",t);try{var o=(0,d.ab)("application/json","");let t=l.B.DeleteUserUrl();t=t+"?conceptId="+e+"&apiKey=freeschema";const i=yield fetch(t,{method:"POST",headers:o});if(i.ok){let e=yield i.json(),t=Number(e.data);return console.log("this is the delete email concept",t),Pe(t),yo.V.logUpdate(n),t}throw(0,u.ry)(i),new Error(`Delete composition Error! status: ${i.status}`)}catch(e){e instanceof Error?console.log("Delete composition error message: ",e.message):console.log("Delete composition unexpected error: ",e),(0,u.Mb)(e,l.B.DeleteConceptUrl()),(0,u.ey)(n,"DeleteUserInBackend",e)}}))}(e):y.v.RemoveConceptById(e)}))}var He=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function $e(e,t){return He(this,void 0,void 0,(function*(){try{const n=new Headers;n.append("Authorization","Bearer "+t);const o=new FormData;o.append("id",e.toString());const i=yield fetch(l.B.DeleteConceptUrl(),{method:"POST",body:o,headers:n});if(!i.ok)throw(0,u.ry)(i),new Error(`Delete composition Error! status: ${i.status}`)}catch(e){e instanceof Error?console.log("Delete composition error message: ",e.message):console.log("Delete composition unexpected error: ",e),(0,u.Mb)(e,l.B.DeleteConceptUrl())}}))}var Je=n(1735),ze=n(8286),qe=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},Qe=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Xe(e){var t=arguments;return Qe(this,void 0,void 0,(function*(){const n=yo.V.logfunction("GetConnectionById",t);if(console.log("AccessTracker activation status from GetConnectionById"),!0===Je.J.activateStatus)try{Je.J.incrementConnection(e)}catch(e){console.error("Error adding connection in access tracker"),yo.V.log("ERROR","Error Adding Connection")}if(oi)try{return(yield hi("GetConnectionById",{id:e})).data}catch(e){console.error("GetConnectionById sw error: ",e),gi(e)}let o=yield ze.d.GetConnection(e);if((null==o||0==o.id)&&null!=e&&null!=e){let t=yield function(e){var t=arguments;return qe(this,void 0,void 0,(function*(){const n=yo.V.logfunction("GetConnection",t);let o=yield ze.d.GetConnection(e);try{if(0!=o.id)return o;{let t=(0,d.Xr)("application/x-www-form-urlencoded");const i=new FormData;i.append("id",e.toString());const r=yield fetch(l.B.GetConnectionUrl(),{method:"POST",headers:t,body:i});return r.ok?(o=yield r.json(),ze.d.AddConnection(o)):((0,u.ry)(r),console.log("Get Connection Error",r.status)),yo.V.logUpdate(n),o}}catch(e){e instanceof Error?console.log("Get Connection error message: ",e.message):console.log("Get Connection unexpected error: ",e),(0,u.Mb)(e,l.B.GetConnectionUrl()),(0,u.ey)(n,"GetConnection",e)}}))}(e);o=t}return yo.V.logUpdate(n),o}))}var Ye=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Ze(e,t,n){return Ye(this,arguments,void 0,(function*(e,t,n,o=4,i=999){const r=yo.V.logfunction("MakeTheTimestamp");if(oi){r.serviceWorker=!0;try{const c=yield hi("MakeTheTimestamp",{type:e,referent:t,userId:n,accessId:o,sessionInformationId:i});return yo.V.logUpdate(r),c.data}catch(e){console.error("MakeTheTimestamp sw error: ",e),(0,u.ey)(r,"MakeTheTimestamp",e),gi(e)}}let c,s="",a=e.startsWith("the_"),l=(0,M.o)();return s=a?e:"the_"+e,l=yield Se(s,n),c=yield me(t,n,4,l.id,0,o,s),yo.V.logUpdate(r),c}))}class Ke{constructor(){this.composition=0,this.type="",this.linker="",this.inpage=10,this.page=1,this.listLinkers=[],this.fullLinkers=[],this.textSearch="",this.logic="or",this.reverse=!1,this.doFilter=!1,this.filterSearches=[],this.selectors=[],this.ofCompositions=[]}}var et=n(6687),tt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function nt(){var e=arguments;return tt(this,arguments,void 0,(function*(t=0,n=[],o=""){const i=yo.V.logfunction("RecursiveSearchApi",e);let r=[];try{if(oi){i.serviceWorker=!0;try{const e=yield hi("RecursiveSearchApi",{composition:t,listLinkers:n,textSearch:o});return yo.V.logUpdate(i),e.data}catch(e){console.error("RecursiveSearchApi sw error: ",e),(0,u.ey)(i,"RecursiveSearchApi",e),gi(e)}}let e=new Ke;e.composition=t,e.listLinkers=n,e.textSearch=o;let c=JSON.stringify(e),s=(0,d.Xr)();const a=yield fetch(l.B.RecursiveSearchUrl(),{method:"POST",headers:s,body:c});if(a.ok){const e=yield a.json();let t=e.compositionIds,n=e.internalConnections;e.externalConnections,r=yield(0,et.p8)(t,n)}else console.log("recursive search error ",a.status),(0,u.ey)(i,"RecursiveSearchApi",a.status),(0,u.ry)(a);yo.V.logUpdate(i)}catch(e){e instanceof Error?console.log("recursive search error message: ",e.message):console.log("recursive search unexpected error: ",e),(0,u.ey)(i,"RecursiveSearchApi",e),(0,u.Mb)(e,l.B.RecursiveSearchUrl())}return r}))}function ot(){var e=arguments;return tt(this,arguments,void 0,(function*(t=0,n=[],o=""){const i=yo.V.logfunction("RecursiveSearchApiWithInternalConnections",e);let r=[];try{if(oi){i.serviceWorker=!0;try{const e=yield hi("RecursiveSearchApiWithInternalConnections",{composition:t,listLinkers:n,textSearch:o});return yo.V.logUpdate(i),e.data}catch(e){console.error("RecursiveSearchApiWithInternalConnections sw error: ",e),(0,u.ey)(i,"RecursiveSearchApiWithInternalConnections",e),gi(e)}}let e=new Ke;e.composition=t,e.listLinkers=n,e.textSearch=o;let c=JSON.stringify(e),s=(0,d.Xr)();const a=yield fetch(l.B.RecursiveSearchUrl(),{method:"POST",headers:s,body:c});if(a.ok){const e=yield a.json();let t=e.compositionIds,n=e.internalConnections;e.externalConnections,r=yield(0,et.km)(t,n),yo.V.logUpdate(i)}else console.log("recursive search error ",a.status),(0,u.ey)(i,"GetCompositionConnectionsBetweenTwoConcepts",a.status),(0,u.ry)(a)}catch(e){e instanceof Error?console.log("recursive search error message: ",e.message):console.log("recursive search unexpected error: ",e),(0,u.ey)(i,"GetCompositionConnectionsBetweenTwoConcepts",e),(0,u.Mb)(e,l.B.RecursiveSearchUrl())}return r}))}function it(){var e=arguments;return tt(this,arguments,void 0,(function*(t=0,n=[],o=""){const i=yo.V.logfunction("RecursiveSearchApiRaw",e);try{if(oi){i.serviceWorker=!0;try{const e=yield hi("RecursiveSearchApiRaw",{composition:t,listLinkers:n,textSearch:o});return yo.V.logUpdate(i),e.data}catch(e){console.error("RecursiveSearchApiRaw sw error: ",e),(0,u.ey)(i,"RecursiveSearchApiRaw",e),gi(e)}}let e=new Ke;e.composition=t,e.listLinkers=n,e.textSearch=o;let r=JSON.stringify(e),c=(0,d.Xr)();const s=yield fetch(l.B.RecursiveSearchUrl(),{method:"POST",headers:c,body:r});if(s.ok){const e=yield s.json();return e.compositionIds,e.internalConnections,e.externalConnections,yo.V.logUpdate(i),e}return console.log("recursive search error ",s.status),(0,u.ey)(i,"RecursiveSearchApiRaw",s.status),(0,u.ry)(s),yo.V.logUpdate(i),[]}catch(e){e instanceof Error?console.log("recursive search error message: ",e.message):console.log("recursive search unexpected error: ",e),(0,u.ey)(i,"RecursiveSearchApiRaw",e),(0,u.Mb)(e,l.B.RecursiveSearchUrl())}}))}function rt(){var e=arguments;return tt(this,arguments,void 0,(function*(t=0,n=[],o=""){const i=yo.V.logfunction("RecursiveSearchApiRawFullLinker",e);try{if(oi){i.serviceWorker=!0;try{const e=yield hi("RecursiveSearchApiRawFullLinker",{composition:t,fullLinkers:n,textSearch:o});return yo.V.logUpdate(i),e.data}catch(e){console.error("RecursiveSearchApiRawFullLinker sw error: ",e),(0,u.ey)(i,"RecursiveSearchApiRawFullLinker",e),gi(e)}}let e=new Ke;e.composition=t,e.fullLinkers=n,e.textSearch=o;let r=JSON.stringify(e),c=(0,d.Xr)();const s=yield fetch(l.B.RecursiveSearchUrl(),{method:"POST",headers:c,body:r});if(s.ok){const e=yield s.json();return e.compositionIds,e.internalConnections,e.externalConnections,yo.V.logUpdate(i),e}return console.log("recursive search error ",s.status),(0,u.ey)(i,"RecursiveSearchApiRawFullLinker",s.status),(0,u.ry)(s),yo.V.logUpdate(i),[]}catch(e){e instanceof Error?console.log("recursive search error message: ",e.message):console.log("recursive search unexpected error: ",e),(0,u.Mb)(e,l.B.RecursiveSearchUrl()),(0,u.ey)(i,"RecursiveSearchApiRawFullLinker",e)}}))}function ct(){var e=arguments;return tt(this,arguments,void 0,(function*(t=0,n=[],o=""){const i=yo.V.logfunction("RecursiveSearchApiRawFullLinker",e);try{if(oi)try{i.serviceWorker=!0;const e=yield hi("RecursiveSearchApiNewRawFullLinker",{composition:t,fullLinkers:n,textSearch:o});return yo.V.logUpdate(i),e.data}catch(e){console.error("RecursiveSearchApiNewRawFullLinker sw error: ",e),(0,u.ey)(i,"RecursiveSearchApiNewRawFullLinker",e),gi(e)}let e=new Ke;e.composition=t,e.fullLinkers=n,e.textSearch=o;let r=JSON.stringify(e),c=(0,d.Xr)();const s=yield fetch(l.B.RecursiveSearchUrl(),{method:"POST",headers:c,body:r});if(s.ok){const e=yield s.json();return e.compositionIds,e.internalConnections,e.externalConnections,yo.V.logUpdate(i),e}return console.log("recursive search error ",s.status),(0,u.ey)(i,"RecursiveSearchApiNewRawFullLinker",s.status),(0,u.ry)(s),yo.V.logUpdate(i),[]}catch(e){e instanceof Error?console.log("recursive search error message: ",e.message):console.log("recursive search unexpected error: ",e),(0,u.Mb)(e,l.B.RecursiveSearchUrl()),(0,u.ey)(i,"RecursiveSearchApiNewRawFullLinker",e)}}))}var st=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const at=["image/jpeg","image/jpg","image/png","image/webp"],lt=["application/msword","application/vnd.ms-excel","application/vnd.ms-powerpoint","text/plain","application/pdf"];function dt(e,t){return st(this,void 0,void 0,(function*(){const n=yo.V.logfunction("uploadAttachment");try{console.log("File Type",e.type);const o=new FormData;let i;if(lt.includes(e.type))o.append("file",e,e.name),i=yield ht(o,t);else{if(!at.includes(e.type))return{message:"Invalid File Format",success:!1};o.append("image",e,e.name),i=yield ut(o,t)}return(null==i?void 0:i.data)?(yo.V.logUpdate(n),{message:"Upload Success",success:!0,url:i.data}):{message:"File Upload Failed",success:!1}}catch(e){throw console.error(e),(0,u.ey)(n,"uploadAttachment",e),e}}))}function ut(e){return st(this,arguments,void 0,(function*(e,t=""){const n=yo.V.logfunction("uploadImage");try{const o=yield fetch(l.B.uploadImageUrl(),{method:"POST",body:e,headers:{Authorization:`Bearer ${t}`}});if(!o.ok){const e=o.headers.get("content-type");e&&e.includes("text/plain")&&console.info(null==o?void 0:o.text());const t=yield null==o?void 0:o.text();return console.error(`${o.status} ${t}`),yo.V.logUpdate(n),null}return yield o.json()}catch(e){return console.error(e),(0,u.ey)(n,"uploadImage",e),null}}))}function ht(e){return st(this,arguments,void 0,(function*(e,t=""){const n=yo.V.logfunction("uploadFile");try{const o=yield fetch(l.B.uploadFileUrl(),{method:"POST",body:e,headers:{Authorization:`Bearer ${t}`}});if(!o.ok){const e=o.headers.get("content-type");e&&e.includes("text/plain")&&console.info(o.text());const t=yield o.text();return console.error(`${o.status} ${t}`),null}return yo.V.logUpdate(n),yield o.json()}catch(e){return console.error(e),(0,u.ey)(n,"uploadFile",e),null}}))}var pt=n(1239),ft=n(7467),yt=n(3278),vt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function gt(e,t){var n=arguments;return vt(this,void 0,void 0,(function*(){const o=yo.V.logfunction("LoginToBackend",n);try{let n={email:e,password:t},i=new Headers;i.append("Content-Type","application/json");let r=JSON.stringify(n);const c=yield fetch(l.B.LoginUrl(),{method:"POST",headers:i,body:r}),s=yield c.json();if(c.ok)return yt.b.BearerAccessToken=s.data.token,yo.V.logUpdate(o),s;console.log("Login tsccs error message: ",c.status),(0,u.ER)(c,s)}catch(e){e instanceof Error?console.log("Login tsccs error message: ",e.message):console.log(" Login tsccs  unexpected error: ",e),(0,u.Mb)(e,l.B.LoginUrl()),(0,u.ey)(o,"LoginToBackend",e)}}))}var mt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Ct(e){return mt(this,void 0,void 0,(function*(){const t=yield function(){return mt(this,arguments,void 0,(function*(e="",t={}){let n={message:"success",status:!1,statusCode:200,data:"cannot signup"};try{const o=yield fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(t)}),i=yield o.json();return o.ok?n={message:"success",status:!0,statusCode:200,data:i}:(0,u.ER)(o,i),n}catch(t){console.log("Signup Error: ",t),(0,u.Mb)(t,e)}}))}(l.B.SignupUrl(),e);return t}))}function Tt(e){return mt(this,void 0,void 0,(function*(){const t=l.B.NODE_URL,n=yield fetch(`${t}/api/v1/entity/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(n.ok)return n.json();if(404===n.status)throw new Error("404, Not found");if(500===n.status)throw new Error("500, internal server error");throw new Error(n.status)}))}var It=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function wt(e){return It(this,void 0,void 0,(function*(){const t=JSON.stringify({email:e.email,password:e.password});let n={message:"success",status:!1,statusCode:200,data:""};const o=new Headers;o.append("Content-Type","application/json");const i=l.B.LoginUrl();try{const e=yield fetch(i,{method:"POST",headers:o,body:t,redirect:"follow"}),r=yield e.json();return e.ok?n={message:"success",status:!0,statusCode:200,data:null==r?void 0:r.data}:(0,u.ER)(e,r),n}catch(e){console.log("Sign in api error",e),(0,u.Mb)(e,i)}}))}var kt=n(9934),Nt=n(4485);function At(e=[],t){Array.isArray(e)&&e.splice(e.findIndex((function(e){return e.id===t.id})),1)}function Lt(e=[],t){Array.isArray(e)&&e.splice(e.findIndex((function(e){return e.id===t.id})),1)}class St{constructor(e,t,n,o){this.expiryTime=new Date(Date.now()+6e5),this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o}isValid(){const e=new Date(Date.now());return!(this.expiryTime<e&&(xt.removeNodeFromTree(this.key),1))}saveToCache(e){this.value.cached=e}addNode(e,t,n){if(null==t)return e;const o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return this.isValid(),e;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));const r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return this.isValid(),t}rightRotate(e){if(e){const t=e.leftNode;if(t){const n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){const t=e.rightNode;if(t){const n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){return t?e==t.key&&t.isValid()?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(null==e.leftNode){const t=e.rightNode;return e=null,t}if(null==e.rightNode){const t=e.leftNode;return e=null,t}{const t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.rightNode=this.removeNode(e.rightNode,t.key),e}}countNodeBelow(e){return null==e?0:1+this.countNodeBelow(e.leftNode)+this.countNodeBelow(e.rightNode)}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}var Gt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class xt{static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static addCompositionToTree(e){const t=new St(e.id,e,null,null);this.addNodeToTree(t)}static getNodeFromTree(e){return Gt(this,void 0,void 0,(function*(){return this.root?this.root.getFromNode(e,this.root):null}))}static removeNodeFromTree(e){return Gt(this,void 0,void 0,(function*(){this.root&&(this.root=this.root.removeNode(this.root,e))}))}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}xt.root=null;var Bt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Rt(e,t,n,o){return Bt(this,arguments,void 0,(function*(e,t,n,o,i=[]){var r,c;let s={};const l=[];if(0==e)return"";let d=bt(n,e);if(null!=d&&0!=d.id||null==e||null==e||(d=yield(0,z.A)(e)),0!=d.id&&null==d.type){const e=d.typeId;let t=bt(n,e);d.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,z.A)(e),d.type=t)}if(!o.includes(e))return null==d?void 0:d.characterValue;if(i.includes(e))return"";i.push(e);for(let d=0;d<t.length;d++)if(t[d].ofTheConceptId==e){const u=t[d].toTheConceptId;if(o.includes(e)){let e=bt(n,u);if(null!=e&&0!=e.id||null==u||null==u||(e=yield(0,z.A)(u)),0!=e.id&&null==(null==e?void 0:e.type)){const t=e.typeId;let n=yield a.I.GetConcept(t);e.type=n,null==n&&null!=t&&null!=t&&(n=yield(0,z.A)(t),e.type=n)}const d="the_",h=(null!==(c=null===(r=null==e?void 0:e.type)||void 0===r?void 0:r.characterValue)&&void 0!==c?c:"").replace(d,"");if(isNaN(Number(h))){if(h){const e=yield Rt(u,t,n,o,i);s[h]=e}}else{const e=yield Rt(u,t,n,o,i);l[h]=e,s=l}}}return s}))}function bt(e,t){let n=(0,M.o)();for(let o=0;o<e.length;o++)if(t==e[o].id)return n=e[o],n;return n}class Et{constructor(){this.id=0,this.mainConcept=(0,M.o)(),this.connections=[],this.concepts=[],this.subcompositions=[],this.cached={}}updateCache(){return e=this,t=void 0,o=function*(){if(0==this.mainConcept.id)for(let e=0;e<this.concepts.length;e++)this.concepts[e].id==this.id&&(this.mainConcept=this.concepts[e]);this.cached=yield Rt(this.id,this.connections,this.concepts,this.subcompositions,[])},new((n=void 0)||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}));var e,t,n,o}UpdateAcrossDistributedSystem(){var e,t;try{0!=this.id&&(t=null===(e=this.id)||void 0===e?void 0:e.toString(),l.B.MQTT_CONNECTION&&l.B.MQTT_CONNECTION.publish("compositionUpdate",t))}catch(e){console.log("Error while publishing message",e)}}isUpdating(){this.UpdateAcrossDistributedSystem()}GetDataCache(){var e,t,n;const o={};o[null!==(n=null===(t=null===(e=this.mainConcept)||void 0===e?void 0:e.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:""]=this.cached;const i={};return i.data=o,i.id=this.id,i}}var Ut=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Dt(e){return Ut(this,arguments,void 0,(function*(e,t=null,n=null,o=null,i=null,r=null,c=null,s=null){const a=null!=i?i:999,l=null!=r?r:4,d=null!=c?c:999;let u=null!=o?o:0,h=(0,M.o)();null==s&&(s=new Et);for(const o in e)if("object"==typeof e[o]||Array.isArray(e[o])){const p=yield(0,q.A)(o,"",!0,a,l,d);if(null==t&&null==n){let t=u;h=p,t=p.id,u=p.id,s.concepts.push(p),s.id=p.id,yield Dt(e[o],p.id,p.userId,t,i,r,c,s)}else{const a=null!=t?t:999,l=null!=n?n:999,d=u;h=p,s.concepts.push(p);const f=yield(0,ie.q)(a,l,p.id,d);s.connections.push(f),yield Dt(e[o],p.id,p.userId,d,i,r,c,s)}null!=e[o]&&null!=e[o]&&s.subcompositions.push(p.id)}else{const i=null!=t?t:999,r=null!=n?n:999,c=u,h=yield(0,q.A)(o,e[o],!1,a,l,d);s.concepts.push(h);const p=yield(0,ie.q)(i,r,h.id,c);s.connections.push(p)}return h}))}var Ft=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function _t(e){return Ft(this,void 0,void 0,(function*(){const t=yo.V.logfunction("UpdateComposition");if(oi){t.serviceWorker=!0;try{const n=yield hi("UpdateComposition",{patcherStructure:e});return yo.V.logUpdate(t),n.data}catch(e){console.error("UpdateComposition sw error: ",e),(0,u.ey)(t,"UpdateComposition",e),gi(e)}}const n=e.userId,o=e.sessionId,i=e.accessId;let r=[];const c=[];let s=(0,M.o)(),a=(0,M.o)();const l=[];let d=e.compositionId;const h=e.ofTheCompositionId;let p=[];if(d<0){let e=yield(0,z.A)(d,n);if(!(e.id>0))return null;d=e.id}r=yield(0,U.s)(d);const f=[],y=new Et,v=[];y.id=d,y.isUpdating();let g=[];for(let e=0;e<r.length;e++)(0,kt.A)(v,r[e].ofTheConceptId),(0,kt.A)(f,r[e].ofTheConceptId),(0,kt.A)(f,r[e].toTheConceptId),g.push(r[e].ofTheConceptId);y.subcompositions=v,y.connections=r;for(let e=0;e<f.length;e++){const t=yield(0,z.A)(f[e]);d==f[e]&&(s=t),h==f[e]&&(a=t),c.push(t)}const m=e.patchObject;for(const e in m){let t=(0,M.o)();const r=m[e];let d=s;if(a.id>0&&(d=a),Array.isArray(r)||"object"==typeof r){t=yield(0,q.A)(e,"",!0,s.userId,4,999),y.subcompositions.push(t.id);const n=(0,Nt.vo)(c,t);for(let e=0;e<n.length;e++)if(n[e].id>0){const t=(0,Nt.wS)(y.connections,n[e].id);p=p.concat(t),l.push(n[e])}yield Dt(m[e],t.id,t.userId,s.id,s.userId,4,999,y)}else{t=yield(0,q.A)(e,r,!1,n,i,o);const s=(0,Nt.vo)(c,t);for(let e=0;e<s.length;e++)if(s[e].id>0){const t=(0,Nt.wS)(y.connections,s[e].id);p=p.concat(t),l.push(s[e])}}const u=(0,ie.q)(d.id,d.userId,t.id,s.id);c.push(t),y.connections.push(u)}for(let e=0;e<p.length;e++)Lt(y.connections,p[e]),(0,J.m)(p[e].id);for(let e=0;e<l.length;e++)At(c,l[e]);y.concepts=y.concepts.concat(c),y.mainConcept=s,y.id=s.id,yield y.updateCache(),xt.addCompositionToTree(y),V.Y.SyncDataOnline();let C=y.GetDataCache();return yo.V.logUpdate(t),C}))}var Wt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Ot(e,t,n,o){return Wt(this,arguments,void 0,(function*(e,t,n,o,i=10,r=1){var c=(0,d.ab)("application/x-www-form-urlencoded",o),s=new URLSearchParams;s.append("type",e),s.append("search",t),s.append("composition",n),s.append("inpage",i.toString()),s.append("page",r.toString());const a=l.B.SearchCompositionsUrl()+"?"+s.toString();try{const e=yield fetch(a,{method:"GET",headers:c});return e.ok?yield e.json():((0,u.ry)(e),[])}catch(e){console.log("This is the searching error",e),(0,u.Mb)(e,a)}}))}var Vt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Mt(e){return Vt(this,arguments,void 0,(function*(e,t=""){var n=(0,d.ab)("application/json",t);const o=l.B.SearchLinkMultipleAll(),i=JSON.stringify(e);try{const e=yield fetch(o,{method:"POST",headers:n,body:i});return e.ok?yield e.json():(console.log("This is the searching error",e.status),(0,u.ry)(e),[])}catch(e){console.log("This is the searching error",e),(0,u.Mb)(e,o)}}))}var Pt=n(7139),jt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Ht(e){return jt(this,arguments,void 0,(function*(e,t=[]){var n,o;let i=[];const r=[];let c={},s={};const l=yield xt.getNodeFromTree(e),d=[];let u=yield a.I.GetConcept(e);if(0==u.id&&null!=e&&null!=e&&(u=yield(0,Pt.r)(e)),null==l){let a=[];a=t.length>0?$t(e,t):yield(0,U.s)(e),i=a;for(let e=0;e<i.length;e++)d.includes(i[e].ofTheConceptId)||(d.push(i[e].ofTheConceptId),r.push(i[e].ofTheConceptId)),r.includes(i[e].toTheConceptId)||r.push(i[e].toTheConceptId);qt(u,i,r,d);let l=[];s=yield(0,v.zN)(e,i,d,l),c[null!==(o=null===(n=null==u?void 0:u.type)||void 0===n?void 0:n.characterValue)&&void 0!==o?o:""]=s}else s=l.value.GetDataCache(),c=s;return 0==u.id?"":c}))}function $t(e,t){const n=[];for(let o=0;o<t.length;o++)t[o].typeId==e&&n.push(t[o]);return n}function Jt(e){return jt(this,arguments,void 0,(function*(e,t=[]){var n,o;let i={},r=[];const c=[];let s;const l={},d=yield xt.getNodeFromTree(e),u=[];let h=yield a.I.GetConcept(e);if(0==h.id&&null!=e&&null!=e&&(h=yield(0,Pt.r)(e)),null==d){let a=[];a=t.length>0?$t(e,t):yield(0,U.s)(e),r=a;for(let e=0;e<r.length;e++)u.includes(r[e].ofTheConceptId)||(u.push(r[e].ofTheConceptId),c.push(r[e].ofTheConceptId)),c.includes(r[e].toTheConceptId)||c.push(r[e].toTheConceptId);qt(h,r,c,u),s=yield(0,v.zN)(e,r,u),l[null!==(o=null===(n=null==h?void 0:h.type)||void 0===n?void 0:n.characterValue)&&void 0!==o?o:""]=s,i.created_at=h.entryTimeStamp,i.data=l,i.id=e}else s=d.value.GetDataCache(),i=s;return 0==h.id?"":i}))}function zt(e,t){return jt(this,void 0,void 0,(function*(){let n=[];const o=[];n=yield(0,ft.j)(t);for(let t=0;t<e.length;t++){const i=yield Jt(e[t],n);i&&o.push(i)}return o}))}function qt(e,t,n,o){return jt(this,void 0,void 0,(function*(){const i=new Et,r=yield function(e){return jt(this,void 0,void 0,(function*(){let t=[];const n=[];for(let o=0;o<(null==e?void 0:e.length);o++){const i=yield a.I.GetConcept(e[o]);0==i.id?n.push(e[o]):t.push(i)}return 0==(null==n?void 0:n.length)||(t=yield(0,pt.I)(n)),t}))}(n);i.connections=t,i.concepts=r,i.id=e.id,i.subcompositions=o,i.mainConcept=e;const c=yield Rt(e.id,t,r,o,[]);i.cached=c,xt.addCompositionToTree(i)}))}var Qt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Xt(e){return Qt(this,void 0,void 0,(function*(){try{var t=(0,d.Xr)();const n=JSON.stringify(e),o=yield fetch(l.B.CreateSessionId(),{method:"POST",headers:t,body:n});return o.ok?o.json():(console.log("Creating session failed",yield o.json()),(0,u.ry)(o),null)}catch(e){console.log("Creating session failed",e),(0,u.Mb)(e,l.B.CreateSessionId())}}))}var Yt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Zt(e,t){return Yt(this,void 0,void 0,(function*(){try{var n=(0,d.Xr)("application/x-www-form-urlencoded");const o=new URLSearchParams;o.append("sessionId",e.toString()),o.append("url",t);const i=yield fetch(l.B.CreateSessionVisitUrl(),{method:"POST",headers:n,body:o});return i.ok?i.json():(console.log("Creating session url failed",yield i.json()),(0,u.ry)(i),null)}catch(e){console.log("Creating session url failed",e),(0,u.Mb)(e,l.B.CreateSessionVisitUrl())}}))}var Kt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function en(e,t){var n=arguments;return Kt(this,arguments,void 0,(function*(e,t,o=10,i=1){const r=yo.V.logfunction("GetRelation",n);if(oi){r.serviceWorker=!0;try{const n=yield hi("GetRelation",{id:e,relation:t,inpage:o,page:i});return yo.V.logUpdate(r),n.data}catch(e){console.error("GetRelation error sw: ",e),(0,u.ey)(r,"GetRelation",e),gi(e)}}let c=[],s=yield(0,z.A)(e),a=yield Ae(t);if(a.id>0){let e=yield W(a.id,s.id,s.userId,o,i),t=[];for(let n=0;n<e.length;n++)t.push(e[n].toTheConceptId);yield(0,f.Y)(t);for(let t=0;t<e.length;t++){let n=e[t].toTheConceptId,o=yield(0,z.A)(n),i=yield(0,v.Ez)(o.id);c.push(i)}}return yo.V.logUpdate(r),c}))}function tn(e,t){var n=arguments;return Kt(this,arguments,void 0,(function*(e,t,o=10,i=1){const r=yo.V.logfunction("GetRelationRaw",n);if(oi){r.serviceWorker=!0;try{const n=yield hi("GetRelationRaw",{id:e,relation:t,inpage:o,page:i});return yo.V.logUpdate(r),n.data}catch(e){console.error("GetRelationRaw error sw: ",e),(0,u.ey)(r,"GetRelationRaw",e),gi(e)}}let c=[],s=yield(0,z.A)(e),a=yield Ae(t);if(a.id>0){let e=yield W(a.id,s.id,s.userId,o,i),t=[];for(let n=0;n<e.length;n++)t.push(e[n].toTheConceptId);for(let t=0;t<e.length;t++){let n=e[t].toTheConceptId,o=yield(0,z.A)(n);c.push(o)}}return yo.V.logUpdate(r),c}))}var nn=n(6416),on=n(4711);class rn{constructor(e,t,n,o){this.value=[],this.height=1,this.key=e,this.value.push(t),this.leftNode=n,this.rightNode=o}addNode(e,t,n){if(null==t)return e;var o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return t.value.push(...e.value),t;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){return t?e==t.key?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}var n=this.inOrderSuccessor(e.rightNode);return e.value=n.value,e.key=n.key,e.rightNode=this.removeNode(e.rightNode,n.key),e}countNodeBelow(e){return null==e?0:1+this.countNodeBelow(e.leftNode)+this.countNodeBelow(e.rightNode)}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}var cn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class sn{static compositeKey(e,t){return("0000"+e.toString(16).toUpperCase()).slice(-4)+("0000"+t.toString(16).toUpperCase()).slice(-4)}static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static waitForDataToLoad(){return cn(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(r.B.isDataLoaded)return e("done");setTimeout(sn.checkFlag,1e3,e)}static addConceptToTree(e,t,n=999){let o=this.compositeKey(t,n);var i=new rn(o,e,null,null);this.addNodeToTree(i)}static getNodeFromTree(e,t){return cn(this,void 0,void 0,(function*(){let n=this.compositeKey(e,t);return this.root?this.root.getFromNode(n,this.root):null}))}static removeNodeFromTree(e){return cn(this,arguments,void 0,(function*(e,t=999){if(this.root){let n=this.compositeKey(e,t);this.root=this.root.removeNode(this.root,n)}}))}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}sn.root=null;var an=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function ln(e,t){return an(this,arguments,void 0,(function*(e,t,n=999){let o=yield sn.getNodeFromTree(e,n),i=(0,nn.u)();if(o)for(let e=0;e<o.value.length;e++){let n=o.value[e];n.ghostId==t&&(i=n)}return i}))}function dn(e,t){return an(this,arguments,void 0,(function*(e,t,n=999){sn.addConceptToTree(e,t,n)}))}var un=n(5312),hn=n(1213),pn=n(3729),fn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},yn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function vn(e,t,n){return yn(this,void 0,void 0,(function*(){try{if(oi)try{return(yield hi("GetRelationLocal",{id:e,relation:t,userId:n})).data}catch(e){console.error("GetRelationLocal error sw: ",e),gi(e)}let o=yield(0,m.$I)(t),i=[];0!=o.id&&(i=yield function(e,t){return fn(this,void 0,void 0,(function*(){try{return yield A.G.GetConnectionOfCompositionAndTypeLocal(t,e)}catch(e){throw e}}))}(e,o.id));let r=[];for(let e=0;e<i.length;e++){let t=yield G(i[e].toTheConceptId);r.push(t)}return r}catch(e){throw e}}))}var gn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function mn(e){return gn(this,void 0,void 0,(function*(){let t=[];try{var n=(0,d.Xr)();const o=yield fetch(l.B.ViewInternalDataUrl(),{method:"POST",headers:n,body:JSON.stringify(e)});if(o.ok){let e=yield o.json(),n={};for(let o=0;o<e.length;o++){let i=e[o].concepts;t=e[o].connections;let r=e[o].id;(0,pt.r)(i),n[r]=t}return n}return console.log("View Internal Data error",o.status),(0,u.ry)(o),t}catch(e){throw e instanceof Error?console.log(" This is the view internal data error message: ",e.message):console.log(" This is the view internal data unexpected error: ",e),e}}))}var Cn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Tn(e){return Cn(this,void 0,void 0,(function*(){var t;try{let n=yield mn(e),o=[];for(let i=0;i<e.length;i++){let r=e[i],c=n[r];if(r&&c){let e=[],t={};for(let t=0;t<c.length;t++)e.includes(c[t].ofTheConceptId)||e.push(c[t].ofTheConceptId);let n=yield(0,v.zN)(r,c,e);t.data=n,t.id=r,o.push(t)}else{let e={};e.id=r;let n=yield(0,z.A)(r),i={};n.type&&(i[null===(t=null==n?void 0:n.type)||void 0===t?void 0:t.characterValue]=n.characterValue,e.data=i,o.push(e))}}return o}catch(e){throw e}}))}var In=n(176),wn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},kn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Nn(e){return kn(this,arguments,void 0,(function*(e,t=""){try{let n=yield function(e){return wn(this,arguments,void 0,(function*(e,t=""){var n=(0,d.ab)("application/json",t);let o=l.B.SearchInternalWithAuthenticatedCcsUrl();o=o+"?composition="+e.composition+"&search="+e.search+"&internalComposition="+e.internalComposition+"&type="+e.type+"&inpage="+e.inpage+"&page="+e.page;try{const e=yield fetch(o,{method:"GET",headers:n});return e.ok?yield e.json():(console.log("This is the searching internal error",e.status),(0,u.ry)(e),[])}catch(e){console.log("This is the searching internal error",e),(0,u.Mb)(e,o)}}))}(e,t);return yield Tn(n)}catch(e){throw e}}))}function An(e){return kn(this,arguments,void 0,(function*(e,t=""){try{return yield function(e){return wn(this,void 0,void 0,(function*(){var t=(0,d.ab)("application/json","");let n=l.B.SearchInternalWithCcsUrl();n=n+"?composition="+e.composition+"&search="+e.search+"&internalComposition="+e.internalComposition+"&type="+e.type+"&inpage="+e.inpage+"&page="+e.page;try{const e=yield fetch(n,{method:"GET",headers:t});return e.ok?yield e.json():(console.log("This is the searching internal error",e.status),(0,u.ry)(e),[])}catch(e){console.log("This is the searching internal error",e),(0,u.Mb)(e,n)}}))}(e)}catch(e){throw e}}))}var Ln=n(8095),Sn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Gn(e){return Sn(this,void 0,void 0,(function*(){if(oi)try{return(yield hi("DeleteConceptLocal",{id:e})).data}catch(e){console.error("DeleteConceptLocal error sw: ",e),gi(e)}let t=yield(0,hn.f)(e);y.v.RemoveConcept(t)}))}var xn=n(2803),Bn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Rn(e,t,n,o){return Bn(this,arguments,void 0,(function*(e,t,n,o,i=!0){var r,c;const s=yo.V.logfunction("GetConnectionBetweenTwoConceptsLinker");if(oi){s.serviceWorker=!0;try{const r=yield hi("GetConnectionBetweenTwoConceptsLinker",{ofTheConcept:e,toTheConcept:t,linker:n,fullLinker:o,forward:i});return yo.V.logUpdate(s),r.data}catch(e){console.error("GetConnectionBetweenTwoConceptsLinker sw error: ",e),(0,u.ey)(s,"GetConnectionBetweenTwoConceptsLinker",e),gi(e)}}let a=(0,M.o)();if(""!=n){let o="";o=i?(null===(r=e.type)||void 0===r?void 0:r.characterValue)+"_s_"+n+"_s":(null===(c=t.type)||void 0===c?void 0:c.characterValue)+"_s_"+n+"_by",a=yield(0,q.A)("connection",o,!1,999)}""!=o&&(a=yield Se(o,999));let l=[];return l=i?yield(0,xn.x)(e.id,t.id,a.id):yield(0,xn.x)(t.id,e.id,a.id),yo.V.logUpdate(s),l}))}function bn(e,t){return new Promise(((n,o)=>{setTimeout((()=>{n(t)}),e)}))}var En=n(3130);const Un=3,Dn=4,Fn=5;var _n=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Wn(e,t){return _n(this,arguments,void 0,(function*(e,t,n=""){let o=l.B.SearchAllTypeWithLinker(e.auth);var i=(0,d.ab)("application/json",n);o=o+"?search="+e.search+"&type="+e.type+"&inpage="+e.inpage+"&page="+e.page;const r=JSON.stringify(t);try{const e=yield fetch(o,{method:"POST",headers:i,body:r});return e.ok?yield e.json():((0,u.ry)(e),console.log("This is the searching multiple error",e.status),[])}catch(e){console.log("This is the searching SearchWithTypeAndLinker error",e),(0,u.Mb)(e,o)}}))}var On=n(4287);class Vn extends On.w{constructor(e,t,n=En.y0){super(),this.searchQuery=[],this.format=En.y0,this.searchQuery=e,this.format=n}bind(){return e=this,t=void 0,o=function*(){return this.data=yield(0,un.cf)(this.searchQuery,"",this,this.format),this.mainConcept=this.searchQuery[0].composition,this.listenToEvent(this.mainConcept),console.log("this is the data",this.data),this.data},new((n=void 0)||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}));var e,t,n,o}}function Mn(e,t,n=En.y0){return new Vn(e,null!=t?t:"",n)}var Pn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class jn extends On.w{constructor(e,t=En.ZJ){super(),this.id=e,this.format=t}bind(){return Pn(this,void 0,void 0,(function*(){if(!this.isDataLoaded){let e=yield(0,v.hL)(this.id);this.mainConcept=this.id,this.compositionIds=e.compositionList;let t=e.connectionList;for(let e=0;e<t.length;e++)this.internalConnections.push(t[e].id);this.isDataLoaded=!0,this.listenToEvent(this.mainConcept)}return yield this.build()}))}build(){return Pn(this,void 0,void 0,(function*(){let e=[],t=this.internalConnections;for(let n=0;n<t.length;n++)e.push(yield ze.d.GetConnection(t[n]));return this.format==En.ZJ?this.data=yield(0,v.ay)(this.mainConcept,e,this.compositionIds):this.format==En.y0?this.data=yield(0,v.$V)(this.mainConcept,e,this.compositionIds):this.format==En.yv?this.data=yield(0,v.re)(this.mainConcept,e,this.compositionIds):this.data=yield(0,v.ay)(this.mainConcept,e,this.compositionIds),this.data}))}}function Hn(e,t=En.ZJ){return new jn(e,t)}var $n=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class Jn extends On.w{constructor(e,t,n,o,i){super(),this.data=[],this.startPage=0,this.compositionName=e,this.userId=t,this.inpage=n,this.page=o,this.format=i}bind(){return $n(this,void 0,void 0,(function*(){if(!this.isDataLoaded){var e=yield(0,g.A)(this.compositionName);if(e){yield p(this.compositionName,this.userId);let o=yield a.I.GetConceptsByTypeIdAndUser(e.id,this.userId);for(var t=this.inpage*(this.page-1),n=t;n<t+this.inpage;n++)o[n]&&this.compositionIds.push(o[n].id)}yield(0,f.Y)(this.compositionIds),this.isDataLoaded=!0,this.listenToEventType(e.id);for(let e=0;e<this.compositionIds.length;e++)this.listenToEvent(this.compositionIds[e])}return yield this.build()}))}build(){return $n(this,void 0,void 0,(function*(){if(this.data=[],this.format==En.ZJ){for(let e=this.startPage;e<this.startPage+this.inpage;e++)if(this.compositionIds[e]){let t=yield(0,v.kx)(this.compositionIds[e]);this.data.push(t)}}else if(this.format==En.y0){for(let e=this.startPage;e<this.startPage+this.inpage;e++)if(this.compositionIds[e]){let t=yield(0,v.RW)(this.compositionIds[e]);this.data.push(t)}}else if(this.format==En.yv){for(let e=this.startPage;e<this.startPage+this.inpage;e++)if(this.compositionIds[e]){let t=yield(0,v.XI)(this.compositionIds[e]);this.data.push(t)}}else for(let e=this.startPage;e<this.startPage+this.inpage;e++)if(this.compositionIds[e]){let t=yield(0,v.kx)(this.compositionIds[e]);this.data.push(t)}return this.data}))}}function zn(e,t,n,o,i=En.ZJ){return new Jn(e,t,n,o,i)}var qn=n(7106),Qn=n(5328),Xn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class Yn extends On.w{constructor(e,t,n="",o){super(),this.searchText="",this.connections=[],this.externalConnectionIds=[],this.data=[],this.mainConcept=e,this.searchLinkers=t,this.textSearch=n,o&&(this.format=o)}listenToEvent(e){window.addEventListener(`${e}`,(t=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let t=this;setTimeout((function(){return Xn(this,void 0,void 0,(function*(){let n=yield ze.d.GetConnectionByOfTheConceptAndType(e,e);for(let e=0;e<n.length;e++)yield ze.d.GetConnection(n[e]).then((e=>{e.typeId==t.mainConcept?t.internalConnections.includes(e.id)||t.internalConnections.push(e.id):t.linkers.includes(e.id)||t.linkers.push(e.id),t.conceptIds.includes(e.toTheConceptId)||t.conceptIds.push(e.toTheConceptId),t.compositionIds.includes(e.ofTheConceptId)||t.compositionIds.push(e.ofTheConceptId),t.compositionIds.includes(e.toTheConceptId)||t.compositionIds.push(e.toTheConceptId)}));t.isUpdating=!1,yield t.bind(),t.notify()}))}),200)}}))}bind(){return Xn(this,void 0,void 0,(function*(){if(!this.isDataLoaded){this.isDataLoaded=!0;const e=yield it(this.mainConcept,this.searchLinkers,this.textSearch);this.compositionIds=e.compositionIds||[],this.internalConnections=e.internalConnections||[],this.externalConnectionIds=e.externalConnections||[],this.linkers=this.externalConnectionIds,this.connections=yield(0,ft.j)(this.externalConnectionIds);for(let e=0;e<this.compositionIds.length;e++)this.listenToEvent(this.compositionIds[e]);this.listenToEvent(this.mainConcept)}return yield this.build()}))}build(){return Xn(this,void 0,void 0,(function*(){return this.externalConnectionIds=this.linkers,this.format&&this.format==En.XZ?this.data={compositionIds:this.compositionIds,internalConnections:this.internalConnections,externalConnections:this.externalConnectionIds}:this.data=yield(0,et.p8)(this.compositionIds,this.internalConnections),this.data}))}}function Zn(e,t,n="",o){return new Yn(e,t,n,o)}var Kn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class eo extends On.w{constructor(e,t,n,o=En.y0){super(),this.searchQuery=[],this.format=En.y0,this.mainCompositionIds=[],this.searchCharacter="",this.token="",this.searchStructure=e,this.searchQuery=t,this.searchQuery[0].type=e.composition,this.searchCharacter=e.composition,this.format=o,this.token=yt.b.BearerAccessToken}listenToEventType(e){window.addEventListener(`${e}`,(e=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let t=this;setTimeout((function(){return Kn(this,void 0,void 0,(function*(){let n=e;t.mainCompositionIds.includes(null==n?void 0:n.detail)||(t.mainCompositionIds.unshift(null==n?void 0:n.detail),t.conceptIds.push(null==n?void 0:n.detail),t.listenToEvent(null==n?void 0:n.detail),ze.d.GetConnectionsOfConcept(null==n?void 0:n.detail).then((e=>{for(let n=0;n<e.length;n++)t.linkers.push(e[n].id)}))),t.isUpdating=!1,yield t.bind(),t.notify()}))}),200)}}))}bind(){return Kn(this,void 0,void 0,(function*(){if(!this.isDataLoaded){this.isDataLoaded=!0;var e=yield(0,g.A)(this.searchCharacter);let t=yield Wn(this.searchStructure,this.searchQuery,this.token);this.conceptIds=t.compositionIds,this.internalConnections=t.internalConnections,this.linkers=t.linkers,this.reverse=t.reverse,this.mainCompositionIds=t.mainCompositionIds,this.listenToEventType(e.id);for(let e=0;e<this.mainCompositionIds.length;e++)this.listenToEvent(this.mainCompositionIds[e])}return yield this.build()}))}build(){return Kn(this,void 0,void 0,(function*(){return yield(0,pt.r)(this.conceptIds),this.format==En.y0?this.data=yield(0,qn.yV)(this.linkers,this.conceptIds,this.internalConnections,this.mainCompositionIds,this.reverse):this.data=yield(0,qn._W)(this.linkers,this.conceptIds,this.internalConnections,this.mainCompositionIds,this.reverse),this.data}))}}function to(e,t,n,o=En.y0){return new eo(e,t,n,o)}var no=n(2615);class oo{constructor(e,t,n,o,i,r,c,s=!1,a,d,u){this.structureType="lconcept",this.isComposition=!1,this.isTemp=!1,this.isSynced=!1,this.applicationId=l.B.getRandomizer(),this.id=e,this.userId=t,this.typeId=n,this.ghostId=e,this.categoryId=o,this.characterValue=r,this.accessId=i,this.type=null,this.isNew=s,this.typeCharacter=c,this.entryTimeStamp=a,this.updatedTimeStamp=d,this.isSynced=!1,this.referentId=u}getType(){console.log(this.typeId)}}class io{constructor(e,t,n,o,i,r){this.isTemp=!1,this.applicationId=l.B.getRandomizer(),this.type=(0,M.o)(),this.id=e,this.ofTheConceptId=t,this.toTheConceptId=n,this.typeId=o,this.ghostId=e,this.orderId=i,this.typeCharacter="",this.accessId=r,this.typeCharacter="",this.entryTimeStamp=new Date,this.terminationDateTime=new Date,this.localSyncTime=new Date}}class ro{constructor(){this.compositionId=0,this.userId=999,this.sessionId=999,this.accessId=4,this.ofTheCompositionId=0,this.patchObject={}}}class co{constructor(){this.id="0",this.remote_address="",this.server_port="",this.server_address="",this.server_name="",this.server_software="",this.http_user_agent="",this.self="",this.port="",this.userId="",this.email=""}}var so=n(628);class ao{constructor(){this.type="",this.search="",this.logicoperator="=",this.index=0,this.composition=!0,this.name="",this.operateon=""}}class lo{constructor(){this.type="",this.search="",this.composition="",this.internalComposition="",this.userId=999,this.inpage=10,this.page=1,this.auth=!0}}var uo=n(7887),ho=n(3075),po=n(7869),fo=n(9635),yo=n(9700);class vo{static initialize(){try{console.warn("Initialized Application Monitoring for tracking errors..."),this.initGlobalErrorHandlers(),this.logCatchError(),this.logErrorEvent(),this.logUnhandledError(),this.logUserInteractions(),this.logNetworkRequests(),this.logRouteChanges(),this.logPerformanceMetrics(),this.logWebSocketEvents()}catch(e){console.error("Error during Application Monitoring initialization:",e)}}static initGlobalErrorHandlers(){try{if(console.log("this is the window",window),void 0===typeof window)return;window.onerror=(e,t,n,o,i)=>{const r={message:e,source:t,lineno:n,colno:o,stack:(null==i?void 0:i.stack)||"undefined"};console.log("This is the window error",r),yo.V.logApplication("ERROR","Runtime Error",r),yo.V.log("ERROR","Runtime Error",r)},window.onunhandledrejection=e=>{yo.V.logApplication("ERROR","Unhandled Promise Rejection",{message:e.reason?e.reason.message:e.reason,stack:e.reason?e.reason.stack:null}),yo.V.log("ERROR","Unhandled Promise Rejection",{message:e.reason?e.reason.message:e.reason,stack:e.reason?e.reason.stack:null})}}catch(e){console.warn("Failed to initialize global error handlers:",e)}}static logCatchError(){try{const e=console.error;console.log("Inside originalConsoleError..."),console.error=function(...t){const n="Console Error",o={arguments:t.map((e=>go(e)))};yo.V.logApplication("ERROR",n,o),yo.V.log("ERROR",n,o),e.apply(console,t)}}catch(e){console.warn("Failed to override console.error:",e)}}static logErrorEvent(){try{window.addEventListener("error",(e=>{var t;console.log("Inside error event...");const n={error:(null===(t=e.error)||void 0===t?void 0:t.message)||e.message,source:e.filename,line:e.lineno,column:e.colno,stack:e.error?go(e.error.stack):void 0},o="Unhandled Error";yo.V.logApplication("ERROR",o,n),yo.V.log("ERROR",o,n)}))}catch(e){console.warn("Failed to add error event listener:",e)}}static logUnhandledError(){try{window.addEventListener("unhandledrejection",(e=>{var t,n;console.log("Inside unhandledrejection...");const o={reason:(null===(t=e.reason)||void 0===t?void 0:t.message)||String(e.reason),stack:(null===(n=e.reason)||void 0===n?void 0:n.stack)||"No stack trace available"};yo.V.logApplication("ERROR","Unhandled Promise Rejection",o),yo.V.log("ERROR","Unhandled Promise Rejection",o)}))}catch(e){console.warn("Failed to add unhandled rejection event listener:",e)}}static logUserInteractions(){document.addEventListener("click",(e=>{var t;const n=e.target,o={element:n.tagName,id:n.id,classes:n.className,text:null===(t=n.innerText)||void 0===t?void 0:t.slice(0,50)};yo.V.logApplication("INFO","User Click",o)})),document.addEventListener("input",(e=>{const t=e.target;t.tagName,t.id,t.value})),document.addEventListener("scroll",(()=>{window.scrollY}))}static logNetworkRequests(){try{if(void 0===typeof window)return;const e=null===window||void 0===window?void 0:window.fetch;if(!e)throw new Error("Original fetch is not available.");const t=[l.B.PostLogger(),l.B.PostPrefetchConceptConnections()];window.fetch=(...n)=>{return o=this,i=void 0,c=function*(){const[o,i]=n,r=o instanceof Request?o.url:o instanceof URL?o.toString():o;if(t.includes(r))return console.log("Ignored URLs detected : ",r),e(...n);let c={request:{type:"REQUEST",message:"Network Request",method:(null==i?void 0:i.method)||"GET",url:r,body:null==i?void 0:i.body}};try{const t=yield e(...n);return c.response={type:"RESPONSE",message:"Network Response",url:r,status:t.status},t}catch(e){throw c.response={type:"ERROR",message:"Network Request Failed",url:r,error:e instanceof Error?e.message:String(e)},yo.V.logApplication("ERROR","Failed Network Request",c),new Error(`Network request failed for ${r}: ${e.message}`)}},new((r=void 0)||(r=Promise))((function(e,t){function n(e){try{a(c.next(e))}catch(e){t(e)}}function s(e){try{a(c.throw(e))}catch(e){t(e)}}function a(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(n,s)}a((c=c.apply(o,i||[])).next())}));var o,i,r,c}}catch(e){console.warn("Failed to override network requests:",e)}}static logPerformanceMetrics(){void 0!==typeof window&&(null===window||void 0===window||window.addEventListener("load",(()=>{const e=performance.timing;e.loadEventEnd,e.navigationStart,e.domContentLoadedEventEnd,e.navigationStart})))}static logRouteChanges(){const e=history.pushState;history.pushState=function(...t){var n;const o={url:null===(n=t[2])||void 0===n?void 0:n.toString()};return yo.V.logApplication("INFO","Route Change",o),e.apply(this,t)},null===window||void 0===window||window.addEventListener("popstate",(()=>{const e={url:location.href};yo.V.logApplication("INFO","Route Changed (Back/Forward)",e)}))}static logWebSocketEvents(){if(void 0===typeof window)return;const e=WebSocket;window.WebSocket=class extends e{constructor(e,t){super(e,t);const n={url:e.toString()};yo.V.logApplication("INFO","WebSocket Open",n),this.addEventListener("message",(t=>{const n={url:e,data:t.data};yo.V.logApplication("INFO","WebSocket Message",n)})),this.addEventListener("error",(t=>{const n={url:e,error:t instanceof Error?t.message:String(t)};yo.V.logApplication("ERROR","WebSocket Error",n)})),this.addEventListener("close",(()=>{const t={url:e};yo.V.logApplication("INFO","WebSocket Closed",t)}))}}}}function go(e){try{return JSON.stringify(e,((e,t)=>t&&"object"==typeof t&&t instanceof Error?{message:t.message,stack:t.stack}:t))}catch(e){return"Error while serializing value"}}const mo=(e,t,...n)=>{return o=void 0,i=[e,t,...n],c=function*(e,t,n=!1){try{let o=l.B.sendMail();n&&(o=l.B.sendBulkMail());const i=yield fetch(o,{method:"POST",body:e instanceof FormData?e:JSON.stringify(e),headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}),r=i.headers.get("content-type");if(!i.ok){const e=yield i.json();return console.info(`${i.status} ${e}`),null}const c=yield i.json();return r&&r.includes("text/plain")?yield i.text():c}catch(e){return console.error(e),null}},new((r=void 0)||(r=Promise))((function(e,t){function n(e){try{a(c.next(e))}catch(e){t(e)}}function s(e){try{a(c.throw(e))}catch(e){t(e)}}function a(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(n,s)}a((c=c.apply(o,i||[])).next())}));var o,i,r,c};class Co{constructor(){this.inDevelopment=!1,this.subscribers=[]}notify(){console.log("this is the subscribers",this.subscribers),this.subscribers.map((e=>{e(this.data)}))}dataChange(e){return this.subscribers.push(e),e(this.data)}}class To extends Co{constructor(){super(...arguments),this.element=null,this.elementIdentifier=0,this.widgetMounted=!1}getComponent(){return this.element}getElementById(e){let t=this.getComponent(),n=document.body;if(t){let o=t.querySelector("#"+e);if(o)return n=o,n}return null}createWidgetWrapperIdentifier(){return this.elementIdentifier=1e4*Math.random(),this.elementIdentifier.toString()}}class Io extends To{constructor(){super(...arguments),this.html="",this.css="",this.js="",this.childWidgets=[],this.childWidgetElement=[],this.widgetState={},this.parentElement=""}getElement(){return this.element}setTitle(e){document.title=e}getHtml(){return this.html}UpdateChildData(e,t){let n=t;n.data=e,n.render(),n.update()}update(){}setState(e){this.data=e,this.notify(),this.render()}loadChildWidgets(){this.childWidgets.map((e=>{let t=this.getElementById(e.parentElement);t&&(t.innerHTML=""),e.mount(t)}))}render(){this.element&&(this.element.innerHTML=this.getHtml()),this.after_render(),this.widgetMounted&&this.loadChildWidgets()}getElementByClassName(e){let t=this.getComponent();return t?null==t?void 0:t.querySelectorAll("."+e):[]}mount_child(){}mount(e){return t=this,n=void 0,i=function*(){e&&(this.element=document.createElement("div"),this.element.id=this.createWidgetWrapperIdentifier(),this.element.innerHTML=this.getHtml(),e.appendChild(this.element),this.parentElement=e.id,this.before_render(),this.mount_child(),this.widgetMounted=!0)},new((o=void 0)||(o=Promise))((function(e,r){function c(e){try{a(i.next(e))}catch(e){r(e)}}function s(e){try{a(i.throw(e))}catch(e){r(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(c,s)}a((i=i.apply(t,n||[])).next())}));var t,n,o,i}before_render(){this.render()}after_render(){console.log("this is calling the after render",this)}renderChildWidgets(){function e(t){var n;t&&(null===(n=t.childWidgets)||void 0===n||n.forEach((t=>{e(t)})),t.render())}console.log("this is the render child widget",this),this.childWidgets.forEach((t=>{e(t)}))}setWidgetState(e,t){this.widgetState[e]=t,function e(t){t&&Array.isArray(t.childWidgets)&&t.childWidgets.forEach((n=>{n.widgetState=Object.assign(Object.assign({},n.widgetState),t.widgetState),e(n)}))}(this),this.renderChildWidgets()}getWidgetState(e,t){return Object.keys.length&&this.widgetState[e]?this.widgetState[e]:t}}var wo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class ko extends Io{constructor(){super(...arguments),this.childComponents=[],this.componentMounted=!1,this.oldHtml=null,this.phonebooks=[],this.childrenData={},this.childWidgets=[],this.typeValueList=[],this.widgetType="the_element_name",this.parentConceptList=[]}getUserId(){return wo(this,void 0,void 0,(function*(){const e=yield new Promise((e=>{let t=(null===localStorage||void 0===localStorage?void 0:localStorage.getItem("profile"))||"";t?e(JSON.parse(t)):e()}));return null==e?void 0:e.userId}))}getTypeValueList(){return wo(this,arguments,void 0,(function*(e=""){return new Promise((t=>wo(this,void 0,void 0,(function*(){const n=null==(e=this.widgetType)?void 0:e.match(/^[a-z0-9]+_[a-z0-9]+/i),o=n?n[0]:"",i=null==e?void 0:e.match(/^([a-z0-9]+).*_([a-z0-9]+)$/i),r=i?`${i[1]}_${i[2]}`:"";let c=[],s=new ao;s.type=r,s.search="1",s.logicoperator=">",s.name="emailfilter",s.operateon="entityEmail",s.composition=!1,c.push(s);let a=new Do;a.typeConnection=e,a.name="entityEmail";let l=new Do;l.type=o,l.filterLogic="( emailfilter )",l.filters=c,l.name="top",l.inpage=100,l.freeschemaQueries=[a],l.outputFormat=En.y0,Mo(l,"").subscribe((n=>{if(null==n?void 0:n.length){const i=null==n?void 0:n.map((t=>{var n,i,c,s,a,l,d;const u=null===(s=null===(c=null===(i=null===(n=t.data)||void 0===n?void 0:n[o])||void 0===i?void 0:i[e])||void 0===c?void 0:c.data)||void 0===s?void 0:s[r];return{id:null===(d=null===(l=null===(a=t.data)||void 0===a?void 0:a[o])||void 0===l?void 0:l[e])||void 0===d?void 0:d.id,name:u,text:u}}));return this.typeValueList=i,t(i),i}}))}))))}))}setTitle(e){document.title=e}getHtml(){return this.html}createRandomNumber(){return this.elementIdentifier=1e4*Math.random(),this.elementIdentifier}mount_child(){return wo(this,void 0,void 0,(function*(){try{new Function("tsccs",`\n        return (async function() {\n          ${this.mountChildWidgetsFunction}\n        }).call(this);\n      `).bind(this)(o)}catch(e){throw console.log("This is the error in the mount child",e),e}}))}setProperty(e){return wo(this,void 0,void 0,(function*(){return this.widgetType=e,this.getTypeValueList(this.widgetType).then((()=>{var e,t,n;null===(e=this.element)||void 0===e||e.setAttribute("data-type-value",this.widgetType),null===(n=null===(t=this.element)||void 0===t?void 0:t.parentElement)||void 0===n||n.setAttribute("data-type-value",this.widgetType),this.render()})),this}))}createTypeEditor(e){!function(e,t){if(e){const n=document.querySelector("#widget-properties #widget-type"),o=null==n?void 0:n.querySelectorAll("input");null==o||o.forEach((e=>{null==e||e.remove()}));const i=e.target.closest(".added-widget-container"),r=e.target.closest("div");let c="";i?c=null==i?void 0:i.getAttribute("data-type-value"):r&&(c=null==r?void 0:r.getAttribute("data-type-value"));const s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("name","input-widgetTypeValue"),s.setAttribute("of",t.elementIdentifier.toString()),s.setAttribute("class","form-control"),s.setAttribute("id","widgetType"),s.setAttribute("onchange","updateWidgetTypeValue(event)"),t.widgetType?s.value=t.widgetType:s.setAttribute("placeholder","e.g. the_entity");let a=t;s.addEventListener("change",(function(e){var t,n,o;const i=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;a.widgetType=i,a.before_render(),a.loadChildWidgets(),null===(o=null===(n=a.element)||void 0===n?void 0:n.parentElement)||void 0===o||o.setAttribute("data-type-value",a.widgetType)})),null==n||n.appendChild(s)}}(e,this)}mount(e){return wo(this,void 0,void 0,(function*(){if(e){this.element=document.createElement("div"),this.element.id=this.createWidgetWrapperIdentifier();let t=this;this.inDevelopment&&(this.element.onclick=function(e){e.preventDefault(),t.createTypeEditor(e)},this.element.className="mftsccs-marking-element"),this.element.innerHTML=this.getHtml(),null==e||e.setAttribute("data-type-value",t.widgetType),e.appendChild(this.element),this.parentElement=e.id,0==this.componentMounted||0==this.widgetMounted?(this.before_render(),this.mount_child(),this.widgetMounted=!0,this.componentMounted=!0):this.render(),this.childWidgetElement=this.getElementByClassName("added-widget-container")}}))}before_render(){try{new Function("tsccs",`\n        return (async function() {\n          ${this.componentDidMountFunction}\n        }).call(this);\n      `).bind(this)(o)}catch(e){throw console.log("This is the error in the before render",e),e}}after_render(){try{new Function("tsccs",`\n        return (async function() {\n          ${this.addEventFunction}\n        }).call(this);\n      `).bind(this)(o)}catch(e){throw console.log("This is the error in the after render",e),e}}CreateConnectionBetweenEntityLocal(e,t,n){return wo(this,void 0,void 0,(function*(){var o;const i=e.userId,r=(null===(o=e.type)||void 0===o?void 0:o.characterValue)+"_"+n,c=yield(0,le.$)(r,999,999,i);return yield(0,on.F)(e.id,t.id,c.id,1e3),"connection created"}))}}var No=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class Ao{constructor(){this.actions={concepts:[],connections:[]},this.success=!0,this.transactionId=Math.random().toString().substring(5)}initialize(){return No(this,void 0,void 0,(function*(){yield so.H.initializeTransaction(this.transactionId)}))}commitTransaction(){return No(this,void 0,void 0,(function*(){if(!this.success)throw Error("Query Transaction Expired");yield so.H.SyncDataOnline(this.transactionId),this.actions={concepts:[],connections:[]},this.success=!1}))}rollbackTransaction(){return No(this,void 0,void 0,(function*(){this.success=!1,this.actions={concepts:[],connections:[]},yield so.H.rollbackTransaction(this.transactionId,this.actions)}))}markAction(){return No(this,void 0,void 0,(function*(){yield so.H.markTransactionActions(this.transactionId,this.actions)}))}MakeTheInstanceConceptLocal(e,t){return No(this,arguments,void 0,(function*(e,t,n=!1,o,i,r=999,c=0){try{if(!this.success)throw Error("Query Transaction Expired");const s=yield(0,K.k)(e,t,n,o,i,r,c,this.actions);return yield this.markAction(),s}catch(e){throw console.log(e),this.success=!1,e}}))}MakeTheTypeConceptLocal(e,t,n,o){return No(this,void 0,void 0,(function*(){try{if(!this.success)throw Error("Query Transaction Expired");const i=yield(0,le.$)(e,t,n,o,this.actions);return yield this.markAction(),i}catch(e){throw console.log(e),this.success=!1,e}}))}CreateConnectionBetweenTwoConceptsLocal(e,t,n){return No(this,arguments,void 0,(function*(e,t,n,o=!1){try{if(!this.success)throw Error("Query Transaction Expired");const i=yield(0,Ln.h)(e,t,n,o,this.actions);return yield this.markAction(),i}catch(e){throw console.log(e),this.success=!1,e}}))}CreateTheConnectionLocal(e,t,n){return No(this,arguments,void 0,(function*(e,t,n,o=1,i="",r=999){try{if(!this.success)throw Error("Query Transaction Expired");const c=yield(0,on.F)(e,t,n,o,i,r,this.actions);return yield this.markAction(),c}catch(e){throw console.log(e),this.success=!1,e}}))}CreateTheCompositionLocal(e){return No(this,arguments,void 0,(function*(e,t=null,n=null,o=null,i=null,r=null,c=null,s=!1){try{if(!this.success)throw Error("Query Transaction Expired");const a=yield(0,F.R)(e,t,n,o,i,r,c,s,this.actions);return yield this.markAction(),a}catch(e){throw console.log(e),this.success=!1,e}}))}}const Lo={number:/^\d+(\.\d+)?$/,text:/^[\s\S]*$/,textOnly:/^[A-Za-z\s]+$/,email:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,document:/\.(pdf|docx?|pptx?|xlsx?)$/i,sound:/\.(mp3|wav|ogg|flac)$/i,image:/\.(jpg|jpeg|png|gif|bmp|svg|webp)$/i,video:/\.(mp4|avi|mov|mkv|flv|webm)$/i,url:/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/,date:/^\d{4}-\d{2}-\d{2}$/,time:/^(?:[01]\d|2[0-3]):[0-5]\d$/,password:/^.{6,}$/,ipaddress:/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$|^([0-9a-fA-F]{1,4}:){7}([0-9a-fA-F]{1,4})$/,uuid:/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/};var So=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class Go{constructor(){Go.cacheInitialized||Go.initializeAnomalyParameters()}static initializeAnomalyParameters(){return So(this,void 0,void 0,(function*(){try{yield Go.getAnomalyParameters(),Go.refreshCache(),Go.cacheInitialized=!0}catch(e){console.error("Error during anomaly parameter initialization:",e)}}))}static getAnomalyParameters(){return So(this,void 0,void 0,(function*(){const e=Date.now();if(Go.anomalyParamsCache&&e-Go.lastFetchedTime<Go.cacheExpiryThreshold)return console.log("Returning cached anomaly parameters"),Go.anomalyParamsCache;try{return yield Go.fetchAnomalyParameters()}catch(e){throw console.error("Error fetching anomaly parameters:",e),e}}))}static fetchAnomalyParameters(){return So(this,void 0,void 0,(function*(){try{const e=yield fetch("https://devai.freeschema.com/v1/get-frontend-anomaly-parameters",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to fetch anomaly parameters");const t=yield e.json();return Go.anomalyParamsCache=t.data,Go.lastFetchedTime=Date.now(),t.data}catch(e){throw console.error("API Fetch Error:",e),e}}))}static refreshCache(){return So(this,void 0,void 0,(function*(){try{Date.now()-Go.lastFetchedTime>Go.cacheExpiryThreshold&&(yield Go.getAnomalyParameters())}catch(e){console.error("Error refreshing anomaly parameters cache:",e)}}))}detectDataType(e){for(const[t,n]of Object.entries(Lo))if(n.test(e))return t;return null}checkConceptAnomaly(e,t){return So(this,void 0,void 0,(function*(){const n=[];try{if(!t)return n.push("Null value"),{valid:!1,warnings:n};const o=Go.anomalyParamsCache;e.startsWith("the_")||(e=`the_${e}`);const i=o[e];if(console.log("Concept Details : ",i),!i)return console.warn(`No concept details found for type: ${e}`),n.push(`No concept details found for type: ${e}`),{valid:!1,warnings:n};const r=t.length,{min_length:c,max_length:s,data_types:a}=i,l=r>=c&&r<=s,d=this.detectDataType(t),u=a.includes(d);return l||n.push(`Length of '${t}' is outside the allowed range (min: ${c}, max: ${s}). Current length: ${r}.`),u||n.push(`Type mismatch for '${t}'. Expected types: ${a.join(", ")}, detected type: ${d}.`),l&&u&&n.push(`Concept ${e} is valid. Length: ${r}, Type: ${d}`),{valid:l&&u,warnings:n}}catch(o){return console.error(`Error checking anomaly for ${e} with value ${t}:`,o),{valid:!1,warnings:n}}}))}static checkAnomalyInBulk(e){return So(this,void 0,void 0,(function*(){Go.cacheInitialized||(yield Go.initializeAnomalyParameters());try{const t={};for(const[n,o]of Object.entries(e)){const e=o.value,{valid:i,warnings:r}=yield(new Go).checkConceptAnomaly(n,e);t[n]={valid:i,warnings:r}}return t}catch(e){throw console.error("Bulk Anomaly Check Error:",e),e}}))}static getExportedFunction(){console.log("Main : ",o);const e=Object.keys(o);return console.log("The exported List : ",e),e}static getFunctionaAnomalyParameters(){}}Go.anomalyParamsCache=null,Go.cacheInitialized=!1,Go.lastFetchedTime=0,Go.cacheExpiryThreshold=6e5;var xo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class Bo{checkUniqueness(e,t){return xo(this,void 0,void 0,(function*(){const n=yo.V.logfunction("checkUniqueness");e.startsWith("the_")||(e="the_"+e);let o=(yield Se(e,999)).id,i=yield(0,re.A)(t,o);return console.log("This is the concept for validator",i),!(i.id>0||(yo.V.logUpdate(n),0))}))}validateField(e,t,n,o,i,r,c,s,a,l,d,h,p){return xo(this,arguments,void 0,(function*(e,t,n,o,i,r,c,s,a,l,d,h,p,f=!1){var y;const v=yo.V.logfunction("validateField");try{performance.now();const e={};if(!p||null!==o&&""!==o||(e.required="This is required field"),n&&o){let t=Lo[n];t&&""!==o&&!t.test(o)&&(e.dataType=`Invalid value for ${n}`)}if(i&&o){const t="string"==typeof i?new RegExp(i):i;""===o||t.test(o)||(e.pattern="Pattern doesn't match with value")}if(o&&null!==c&&o.length>c&&(e.maxLength=`Length exceeds the maximum length of ${c}`),o&&null!==s&&o.length<s&&(e.minLength=`Length must be at least ${s} characters long`),null!==a&&o&&!isNaN(Number(o))&&Number(o)<a&&(e.minValue=`Value must be greater than or equal to ${a}`),null!==l&&o&&!isNaN(Number(o))&&Number(o)>l&&(e.maxValue=`Value must be less than or equal to ${l}`),h&&t&&d){const t=d.split(",").map((e=>e.trim().toLowerCase())),n=null===(y=h.name.split(".").pop())||void 0===y?void 0:y.toLowerCase();n&&!t.includes(n)&&(e.accept=`File must be a valid file type: ${t.join(", ")}`)}return r&&f&&o&&((yield this.checkUniqueness(r,o))||(e.unique="Value is not unique")),yo.V.logUpdate(v),e}catch(e){throw(0,u.ey)(v,"Validator.validateField",e),e}}))}validateForm(e){return xo(this,void 0,void 0,(function*(){const t=yo.V.logfunction("validateForm");try{performance.now();const n={};for(const t in e){const{value:o,fieldType:i,dataType:r,pattern:c,conceptType:s,maxLength:a=null,minLength:l=null,minValue:d=null,maxValue:u=null,accept:h=null,file:p=null,required:f,isUnique:y}=e[t],v=yield this.validateField(t,i,r,o,c,s,a,l,d,u,h,p,f,y);Object.keys(v).length>0&&(n[t]=v)}return yo.V.logUpdate(t),n}catch(e){throw(0,u.ey)(t,"Validator.validateForm",e),e}}))}validate(e,t,n,o,i,r,c,s,a,l,d,h,p,f=!1){const y=yo.V.logfunction("validate");try{let u={};return this.validateField(e,t,n,o,i,r,c,s,a,l,d,h,p,f).then((e=>{Object.keys(e).length>0?(u.status=!1,u.details=e):u.status=!0})),console.error("Error on validate object"),yo.V.logUpdate(y),u}catch(e){(0,u.ey)(y,"Validator.validate",e)}}}const Ro=e=>{var t;const n=document.getElementsByName(e)[0];if(!n)return console.warn(`Element with NAME "${e}" not found.`),{value:null,fieldType:null,dataType:null,pattern:null,conceptType:null,maxLength:null,minLength:null,minValue:null,maxValue:null,accept:null,file:null,required:!1,isUnique:!0};const o=n.hasAttribute("required")||"true"===n.getAttribute("data-required"),i=n.hasAttribute("isUnique")&&"true"===n.getAttribute("isUnique");return{value:n.value,fieldType:n.type,dataType:n.getAttribute("data-type"),pattern:n.getAttribute("data-pattern"),conceptType:n.getAttribute("concept-type"),maxLength:n.getAttribute("data-maxlength")?parseInt(n.getAttribute("data-maxlength")):null,minLength:n.getAttribute("data-minlength")?parseInt(n.getAttribute("data-minlength")):null,minValue:n.getAttribute("data-min")?parseInt(n.getAttribute("data-min")):null,maxValue:n.getAttribute("data-max")?parseInt(n.getAttribute("data-max")):null,accept:n.getAttribute("accept")||null,file:"file"===n.type&&(null===(t=n.files)||void 0===t?void 0:t[0])||null,required:o,isUnique:i}};var bo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Eo(e,t){var n=arguments;return bo(this,void 0,void 0,(function*(){const o=yo.V.logfunction("DeleteConnectionByType",n);if(oi){o.serviceWorker=!0;try{const n=yield hi("DeleteConnectionByType",{id:e,linker:t});return yo.V.logUpdate(o),n.data}catch(e){console.error("DeleteConnectionByType sw error: ",e),(0,u.ey)(o,"DeleteConnectionByType",e),gi(e)}}let i=yield xe(e);for(let e=0;e<i.length;e++)ze.d.AddConnection(i[e]);let r=yield ze.d.GetConnectionsOfConcept(e),c=yield(0,g.A)(t),s=[];for(let e=0;e<r.length;e++)r[e].typeId==c.id&&s.push(r[e]);for(let e=0;e<s.length;e++)(0,J.m)(s[e].id);yo.V.logUpdate(o)}))}function Uo(e,t){return bo(this,arguments,void 0,(function*(e,t,n=!1){if(oi)try{return(yield hi("GetAllTheConnectionsByTypeAndOfTheConcept",{id:e,linker:t,reverse:n})).data}catch(e){console.error("GetAllTheConnectionsByTypeAndOfTheConcept sw error: ",e),gi(e)}let o=[];if(n){let n=yield Re(e),i=yield Se(t,999);for(let e=0;e<n.length;e++)n[e].typeId==i.id&&o.push(n[e])}else{let n=yield xe(e);for(let e=0;e<n.length;e++)ze.d.AddConnection(n[e]);let i=yield ze.d.GetConnectionsOfConcept(e),r=yield(0,g.A)(t);for(let e=0;e<i.length;e++)i[e].typeId==r.id&&o.push(i[e])}return o}))}class Do{constructor(){this.type="",this.inpage=10,this.page=1,this.concepts=[],this.conceptIds=[],this.selectors=[],this.freeschemaQueries=[],this.filters=[],this.filterLogic="",this.typeConnection="",this.order="DESC",this.outputFormat=En.yv,this.name="",this.reverse=!1,this.limit=!1,this.includeInFilter=!1,this.isOldConnectionType=!1}}var Fo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function _o(e){var t=arguments;return Fo(this,arguments,void 0,(function*(e,n=""){const o=yo.V.logfunction("FreeschemaQueryApi",t);var i=(0,d.ab)("application/json",n);const r=l.B.FreeschemaQueryUrl(),c=JSON.stringify(e);try{const e=yield fetch(r,{method:"POST",headers:i,body:c});return e.ok?yield e.json():((0,u.ry)(e),console.log("This is the freeschema query error",e.status),[])}catch(e){console.log("This is the freeschema query error others",e),(0,u.Mb)(e,r),(0,u.ey)(o,"FreeschemaQueryApi",e)}}))}var Wo=n(5898),Oo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class Vo extends On.w{constructor(e,t){super(),this.query=new Do,this.countInfoStrings=[],this.order="DESC",this.query=e,this.format=e.outputFormat,this.order=e.order}bind(){return Oo(this,void 0,void 0,(function*(){var e,t;if(this.isDataLoaded)for(let e=0;e<this.compositionIds.length;e++)this.listenToEvent(this.compositionIds[e]);else{if(this.isDataLoaded=!0,this.query.outputFormat=En.BG,""!=this.query.type){let e=yield Se(this.query.type,999);this.listenToEventType(e.id)}let n=yield _o(this.query,"");this.conceptIds=n.conceptIds,this.internalConnections=null!==(e=n.internalConnections)&&void 0!==e?e:[],this.linkers=null!==(t=n.linkers)&&void 0!==t?t:[],this.reverse=n.reverse,this.compositionIds=n.mainCompositionIds;for(let e=0;e<this.compositionIds.length;e++)this.listenToEvent(this.compositionIds[e]);this.countInfoStrings=n.countinfo}return yield this.build()}))}build(){return Oo(this,void 0,void 0,(function*(){yo.V.logfunction("build",["schemaquery",this.compositionIds]);let e=(0,Wo.w)(this.countInfoStrings);return this.format==En.y0?this.data=yield(0,qn.e$)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,e,this.order):this.format==En.ZJ?this.data=yield(0,qn.y6)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,e,this.order):this.data=yield(0,qn.b6)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,e),this.data}))}}function Mo(e,t){return new Vo(e,t)}class Po{constructor(){this.id=0,this.name="",this.html="",this.css="",this.js="",this.library={css:[],js:[]},this.timestamp="",this.widgetId=0,this.type="",this.clean="",this.after_render="",this.before_render="",this.update="",this.origin=0,this.version=0,this.mount_child="",this.children=[],this.wrapper="0",this.widget=new ko}}var jo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Ho(e,t,n){return jo(this,void 0,void 0,(function*(){var o;const i=yo.V.logfunction("CreateConnectionBetweenEntityLocal",[e.id,t.id,n]),r=e.userId,c=(null===(o=e.type)||void 0===o?void 0:o.characterValue)+"_"+n,s=yield(0,le.$)(c,999,999,r);console.log(yield(0,on.F)(e.id,t.id,s.id,1e3)),yo.V.logUpdate(i)}))}var $o=n(4310),Jo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function zo(e,t,n){return Jo(this,void 0,void 0,(function*(){var o;const i=yield en(e,"the_page_body");(null===(o=null==i?void 0:i[0])||void 0===o?void 0:o.id)?yield Qo(i[0].id,t,n):t.innerHTML="<h4>Invalid or Page doesn't exist</h4>"}))}function qo(e,t,n){return Jo(this,void 0,void 0,(function*(){var o;const i=yield en(e,"the_widget_latest");if(0==(null==i?void 0:i.length))yield Qo(e,t,n);else{const e=null===(o=null==i?void 0:i[0])||void 0===o?void 0:o.id;e&&(yield Qo(e,t,n))}}))}function Qo(e,t,n){return Jo(this,void 0,void 0,(function*(){try{const o=yield(0,$o.C)(e),i=yield Yo(e,[],o);if(!i.name)return void(t.innerHTML="<h4>Invalid or Widget doesn't exist</h4>");const r=t,c=yield Zo(i,r,void 0,n);console.log("this is the tree newWidget",i);const s=document.createElement("style");s.innerHTML=i.css+c.css,r.appendChild(s);const a=document.createElement("script");a.innerHTML=i.js,r.appendChild(a),r.querySelectorAll(".wb-initial-empty").forEach((e=>{e.classList.remove("wb-initial-empty")})),document.querySelectorAll('[onclick="widgetSelected(event)"]').forEach((e=>{e.removeAttribute("onclick")}))}catch(e){console.error("Error Caught Rendering Widget")}}))}function Xo(e){return Jo(this,arguments,void 0,(function*(e,t=[],n=""){const o=yield(0,$o.C)(e);return yield Yo(e,[],o)}))}function Yo(e){return Jo(this,arguments,void 0,(function*(e,t=[],n,o=""){var i,r,c,s,a,l,d,u,h,p,f,y,v,g,m,C,T,I,w,k,N,A,L,S,G,x,B,R,b,E,U,D,F,_,W,O,V,M,P,j,H,$,J,z;try{const q=new Po,Q=(0,$o.i)(n,e);t.push(e);const X=null===(i=null==Q?void 0:Q.data)||void 0===i?void 0:i.the_widget;q.name=null===(c=null===(r=null==X?void 0:X.the_widget_name)||void 0===r?void 0:r.data)||void 0===c?void 0:c.the_name,q.html=null===(a=null===(s=null==X?void 0:X.the_widget_html)||void 0===s?void 0:s.data)||void 0===a?void 0:a.the_html,q.css=null===(d=null===(l=null==X?void 0:X.the_widget_css)||void 0===l?void 0:l.data)||void 0===d?void 0:d.the_css,q.js=null===(h=null===(u=null==X?void 0:X.the_widget_js)||void 0===u?void 0:u.data)||void 0===h?void 0:h.the_js,q.origin=Number(null===(f=null===(p=null==X?void 0:X.the_widget_origin)||void 0===p?void 0:p.data)||void 0===f?void 0:f.the_origin),q.version=null===(v=null===(y=null==X?void 0:X.the_widget_version)||void 0===y?void 0:y.data)||void 0===v?void 0:v.the_version,q.clean=null===(m=null===(g=null==X?void 0:X.the_widget_clean)||void 0===g?void 0:g.data)||void 0===m?void 0:m.the_clean,q.timestamp=null===(T=null===(C=null==X?void 0:X.the_widget_timestamp)||void 0===C?void 0:C.data)||void 0===T?void 0:T.the_timestamp,q.id=Q.id;const Y=null===(w=null===(I=null==X?void 0:X.the_widget_type)||void 0===I?void 0:I.data)||void 0===w?void 0:w.the_type;q.type="null"==Y||null==Y?"the_element_name":Y,q.after_render=null===(N=null===(k=null==X?void 0:X.the_widget_after_render)||void 0===k?void 0:k.data)||void 0===N?void 0:N.the_after_render,q.before_render=null===(L=null===(A=null==X?void 0:X.the_widget_before_render)||void 0===A?void 0:A.data)||void 0===L?void 0:L.the_before_render,q.update=null===(G=null===(S=null==X?void 0:X.the_widget_update)||void 0===S?void 0:S.data)||void 0===G?void 0:G.the_update,q.widgetId=e,q.mount_child=null===(B=null===(x=null==X?void 0:X.the_widget_mount_child)||void 0===x?void 0:x.data)||void 0===B?void 0:B.the_mount_child;const Z=null==X?void 0:X.the_widget_s_child;if(null==Z?void 0:Z.length)for(let e=0;e<Z.length;e++){const i=(null===(E=null===(b=null===(R=Z[e])||void 0===R?void 0:R.data.the_child_widget)||void 0===b?void 0:b.the_child_widget_info)||void 0===E?void 0:E.id)||(null===(_=null===(F=null===(D=null===(U=Z[e])||void 0===U?void 0:U.data.the_child_widget)||void 0===D?void 0:D.the_child_widget_parent)||void 0===F?void 0:F.data)||void 0===_?void 0:_.the_parent),r=yield Yo(i,t,n,o),c=null===(P=null===(M=null===(V=null===(O=null===(W=Z[e])||void 0===W?void 0:W.data)||void 0===O?void 0:O.the_child_widget)||void 0===V?void 0:V.the_child_widget_type)||void 0===M?void 0:M.data)||void 0===P?void 0:P.the_type,s=null===(z=null===(J=null===($=null===(H=null===(j=Z[e])||void 0===j?void 0:j.data)||void 0===H?void 0:H.the_child_widget)||void 0===$?void 0:$.the_child_widget_wrapper)||void 0===J?void 0:J.data)||void 0===z?void 0:z.the_wrapper;r.type="null"==c||null==c?"the_element_name":c,r.wrapper=s,q.children.push(r)}return q}catch(e){throw console.error("error",e),e}}))}function Zo(e,t){return Jo(this,arguments,void 0,(function*(e,t,n=!0,o,i){var r,c;const s=new ko;s.html=e.html,s.widgetType=e.type,s.componentDidMountFunction=e.before_render,s.addEventFunction=e.after_render,s.mountChildWidgetsFunction=e.mount_child,s.widgetState=Object.assign({},i),o&&(s.data=o),t.innerHTML="";const a=t;if(a&&(yield s.mount(a),e.widget=s,e.children.length>0&&(null===(r=s.childWidgetElement)||void 0===r?void 0:r.length)>0))for(let t=0;t<(null===(c=e.children)||void 0===c?void 0:c.length);t++){const n=e.children[t];for(let e=0;e<s.childWidgetElement.length;e++){const t=s.childWidgetElement[e];if(n.wrapper===t.id){const e=ei(n);n.html=`<div id="${n.wrapper}">${n.html}</div>`;const o=yield Zo(e,t,!1,s.data,s.widgetState);s.childWidgets.push(o),s.css=s.css+o.css+`#${t.id} { ${n.css} }`,o.dataChange((e=>{var t;const n=null===(t=null==e?void 0:e.type)||void 0===t?void 0:t.characterValue;n&&(s.childrenData[n]=e)}))}}}return console.log("newWidget ->",s,e),yield ni(t,".widget_container"),s}))}function Ko(e,t){return Jo(this,arguments,void 0,(function*(e,t,n=!0,o){var i,r;let c=new ko;c.html=e.html,c.widgetState=Object.assign({},o),c.widgetType=e.type,c.componentDidMountFunction=e.before_render,c.addEventFunction=e.after_render,c.mountChildWidgetsFunction=e.mount_child,c.inDevelopment=!0,t.innerHTML="";let s=t;if(s&&(yield c.mount(s),e.widget=c,e.children.length>0&&(null===(i=c.childWidgetElement)||void 0===i?void 0:i.length)>0))for(let t=0;t<(null===(r=e.children)||void 0===r?void 0:r.length);t++){let n=e.children[t];for(let e=0;e<c.childWidgetElement.length;e++){let t=c.childWidgetElement[e];if(n.wrapper===t.id){const e=ei(n),o=yield Ko(e,t,!1,c.widgetState);c.childWidgets.push(o),c.css=c.css+o.css+`#${t.id} { ${n.css} }`,o.dataChange((e=>{var t;console.log("This is the data change in child",e);let n=null===(t=null==e?void 0:e.type)||void 0===t?void 0:t.characterValue;n&&(c.childrenData[n]=e),console.log("new child data",c.childrenData)}))}}}return console.log("newWidget ->",c,e),c}))}function ei(e){return e.html=e.html.replace(/<[^>]*\bclass=["'][^"']*\bwidget_container\b[^"']*["'][^>]*>/g,(e=>e.replace(/\bwidget_container\b/g,"").trim())),e.html=e.html.replace(/<[^>]*\bdraggable=["'][^"']*\btrue\b[^"']*["'][^>]*>/g,(e=>e.replace(/\btrue\b/g,"false").trim())),e.html=e.html.replace(/<[^>]*\bclass=["'][^"']*\bhover-element\b[^"']*["'][^>]*>/g,(e=>e.replace(/\bhover-element\b/g,"").trim())),e.html=e.html.replace(/<[^>]*\bclass=["'][^"']*\bwb-block\b[^"']*["'][^>]*>/g,(e=>e.replace(/\bwb-block\b/g,"").trim())),e.html=e.html.replace(/<[^>]*onclick="widgetSelected\(event\)"\s*,?\s*ondragover="_dragService\.dragOverWidgetElement\(event\)"\s*,?\s*ondrop="_dragService\.dropWidgetElement\(event\)"\s*,?\s*ondragstart="_dragService\.dragStartWidgetElement\(event\)"\s*,?\s*ondragend="_dragService\.dragEndWidgetElement\(event\)"[^>]*>/g,(e=>e.replace(/onclick="widgetSelected\(event\)"/g,'onclick=""').replace(/ondragover="_dragService\.dragOverWidgetElement\(event\)"/g,'ondragover=""').replace(/ondrop="_dragService\.dropWidgetElement\(event\)"/g,'ondrop=""').replace(/ondragstart="_dragService\.dragStartWidgetElement\(event\)"/g,'ondragstart=""').replace(/ondragend="_dragService\.dragEndWidgetElement\(event\)"/g,'ondragend=""').trim())),e.html=e.html.replace(/<[^>]*\bondragstart=["'][^"']*\b_dragService\.onWidgetDragStart\(event\)\b[^"']*["'][^>]*>/g,(e=>e.replace(/\b_dragService\.onWidgetDragStart\(event\)\b/g,"").trim())),e}function ti(e,t){return Jo(this,void 0,void 0,(function*(){return e.querySelectorAll(t).forEach((e=>{for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.remove()})),e}))}function ni(e,t){return Jo(this,void 0,void 0,(function*(){const n=e.querySelectorAll(t);for(const e of n){const n=e.parentElement;if(n){for(;e.firstChild;){const o=yield ti(e.firstChild,t);n.insertBefore(o,e)}n.removeChild(e)}}}))}var oi,ii=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const ri=Date.now().toString(36)+Math.random().toString(36).substring(2);let ci=[],si=[],ai=!1;function li(e){ai=e}function di(e="",t){yt.b.BearerAccessToken=e,null==typeof document?yt.b.sessionId=t:yt.b.sessionId=parseInt((0,yo.R)("SessionId")),oi&&hi("updateAccessToken",{accessToken:e,session:parseInt((0,yo.R)("SessionId"))})}function ui(){return ii(this,arguments,void 0,(function*(e="",t="",n="",o="",i=!0,c="",s=void 0,a={},d={}){var h;try{l.B.BASE_URL=e,l.B.AI_URL=t,l.B.NODE_URL=o,l.B.BASE_APPLICATION=c,l.B.LOG_SERVER=null!==(h=d.logserver)&&void 0!==h?h:"https://logdev.freeschema.com",console.log("setting the logserver",l.B.LOG_SERVER,d.logserver),di(n);let i=Math.floor(1e8*Math.random());l.B.setRandomizer(i);const p={logApplication:!1,logPackage:!1,accessTracker:!1,isTest:!1};if(l.B.FLAGS=p,l.B.FLAGS=Object.assign(Object.assign({},p),a),function(e){const t=yo.V.logfunction("initializeFlags",arguments);try{return e.logApplication&&(vo.initialize(),yo.V.logApplicationActivationStatus=!0,console.warn("Application log started.")),e.logPackage&&(yo.V.logPackageActivationStatus=!0,console.warn("Package log started.")),e.accessTracker&&(Je.J.activateStatus=!0,console.warn("Access Tracker Activated.")),e.isTest&&(r.B.isDataLoaded=!0,r.B.isCharacterLoaded=!0,r.B.isTypeLoaded=!0,r.B.isLocalDataLoaded=!0,r.B.isLocalTypeLoaded=!0,r.B.isLocalCharacterLoaded=!0,r.B.isConnectionLoaded=!0,r.B.isConnectionTypeLoaded=!0,r.B.isLocalConnectionLoaded=!0),yo.V.logUpdate(t),e}catch(e){throw(0,u.ey)(t,"initializeFlags",e),e}}(l.B.FLAGS),!("serviceWorker"in navigator))return yield fi(),void console.warn("Service Worker not supported in this browser.");if(function(){navigator.serviceWorker.addEventListener("message",(e=>ii(this,void 0,void 0,(function*(){var t,n,o,i;try{if(e.data&&"API_401"===e.data.type){const{requestDetails:o}=e.data,i={method:o.method,headers:new Headers(o.headers),body:o.body},r=yield fetch(o.url,i),c=yield null==r?void 0:r.json();null===(n=null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||void 0===n||n.postMessage({type:"API_RESPONSE",messageId:e.data.messageId,response:new Response(c,{status:r.status,statusText:r.statusText,headers:r.headers})})}}catch(t){console.error("Error during listenPostMessage",t),null===(i=null===(o=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===o?void 0:o.controller)||void 0===i||i.postMessage({type:"API_RESPONSE",messageId:e.data.messageId})}}))))}(),function(){fo.x.addEventListener("message",(e=>ii(this,void 0,void 0,(function*(){const{type:t,payload:n}=e.data;if(!t)return;let o={success:!1,data:void 0};pi[t]?yield pi[t](n):console.warn(`Unable to handle "${t}" case in BC service worker`)}))))}(),s&&s.activate&&s.manual)yield new Promise(((e,t)=>{navigator.serviceWorker.ready.then((t=>ii(this,void 0,void 0,(function*(){console.log("registraions ready",t),oi=t.active,yield mi(),e("done")})))).catch((e=>{console.error("Error: Ready service worker",e),t(e)})).finally((()=>console.log("Finally service worker ready done"))),setTimeout((()=>t("Timeout ready")),3e4)}));else if(s&&(null==s?void 0:s.activate))try{console.log("service worker initialiing"),yield function(e){var t=arguments;return ii(this,void 0,void 0,(function*(){const n=yo.V.logfunction("handleRegisterServiceWorker",t);yield new Promise(((t,o)=>{var i,r;let c=!1;navigator.serviceWorker.register(null!==(i=e.pathToSW)&&void 0!==i?i:"./serviceWorker.bundle.js",{scope:null!==(r=e.scope)&&void 0!==r?r:"/"}).then((e=>ii(this,void 0,void 0,(function*(){console.log("Service Worker registered:",e),setInterval((()=>{si.length&&vi()}),2e3),console.log("update listen start"),e.onupdatefound=()=>{const n=e.installing;console.log("new worker",n),n&&(n.onstatechange=()=>ii(this,void 0,void 0,(function*(){console.warn("on state change triggered",n.state,navigator.serviceWorker.controller),"installing"===n.state&&(console.log("Service Worker installing"),oi=void 0),"activated"!==n.state&&"redundant"!==n.state||!navigator.serviceWorker.controller||(oi=n,console.log("New Service Worker is active",e),setTimeout((()=>{console.log("Message Processed after some time"),vi()}),5e3),yield mi(),c=!0,vi(),t())})))},e.addEventListener("controllerchange",(()=>ii(this,void 0,void 0,(function*(){console.warn("controller change triggered",navigator.serviceWorker.controller),navigator.serviceWorker.controller&&(oi=navigator.serviceWorker.controller,console.warn("Service worker has been activated; controller change"),yield mi())})))),(e.installing||e.waiting||e.active)&&e.addEventListener("statechange",(e=>ii(this,void 0,void 0,(function*(){var t;"activating"===(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.state)&&(oi=navigator.serviceWorker.controller,console.warn("Service Worker is activating statechange"),yield mi())})))),e.active?(console.log("active sw"),oi=e.active,yield mi(),vi(),t()):setTimeout((()=>{c||o("Not Completed Initialization")}),1e4)})))).catch((e=>ii(this,void 0,void 0,(function*(){yield fi(),o(e),console.error("Service Worker registration failed:",e),(0,u.ey)(n,"handleRegisterServiceWorker",e)}))))}))}))}(s)}catch(e){yield fi(),console.error("Unable to start service worker",e)}else yield fi(),console.warn("Service Worker not activated");return!0}catch(e){yield fi(),console.warn("Cannot initialize the system",e)}}))}function hi(e,t){return ii(this,arguments,void 0,(function*(e,t,n=0){let o=!1;const i=Math.random().toString(36).substring(2);t.messageId=i,t.TABID=ri;const r=JSON.parse(JSON.stringify(t));let c;return"checkProcess"!=e&&0==n&&(c=setInterval((()=>ii(this,void 0,void 0,(function*(){if(console.log("process took more than one second",i,e,o),!o&&!(yield function(e,t){return ii(this,void 0,void 0,(function*(){var n;try{const o=yield hi("checkProcess",{checkMessageId:e});if(console.log("check interval data res for type ",t,e,o.data),null===(n=null==o?void 0:o.data)||void 0===n?void 0:n.processing)return!0}catch(n){return console.error("error on checing executing process",t,e,n),!1}}))}(i,e))&&(clearInterval(c),!o)){if(console.log("Failed to handle type "+e+" message not found "+i,"retrying: ",0==n,e),0==n&&"checkProcess"!=e)return console.log("retrying ",e,i),yield hi(e,t,n+1);console.log("Failed to handle type "+e+" "+i)}}))),2e3)),new Promise(((n,s)=>{if(navigator.serviceWorker.controller||oi||console.log("will go to queue",navigator.serviceWorker.controller,oi,e),navigator.serviceWorker.controller||oi){const a=r=>{var l,d,h,p,f,y;(null===(l=null==r?void 0:r.data)||void 0===l?void 0:l.messageId)==i&&(o=!0,clearInterval(c),r.data.success||(401==(null===(d=null==r?void 0:r.data)||void 0===d?void 0:d.status)?s((0,u.ry)(new Response("Unauthorized",{status:401,statusText:null===(h=null==r?void 0:r.data)||void 0===h?void 0:h.statusText}))):500==(null===(p=null==r?void 0:r.data)||void 0===p?void 0:p.status)?s((0,u.Mb)(new Response("Internal Server Error",{status:500,statusText:null===(f=null==r?void 0:r.data)||void 0===f?void 0:f.statusText}))):(console.error("Error in the response from worker:",r),s(`Failed to handle action ${e} ${JSON.stringify(t)}, Response: ${JSON.stringify(r.data)}`))),(null===(y=r.data)||void 0===y?void 0:y.actions)&&(t.actions=JSON.parse(JSON.stringify(r.data.actions))),n(r.data),navigator.serviceWorker.removeEventListener("message",a))};if(navigator.serviceWorker.addEventListener("message",a),navigator.serviceWorker.controller)"checkProcess"!=e&&console.log("sent to sw",e,i),navigator.serviceWorker.controller.postMessage({type:e,payload:r});else if(oi){console.warn(`controller not found but serviceWorker is available. messageId: ${i}, type: ${e}`);try{oi.postMessage({type:e,payload:r})}catch(t){console.log("Retrying again on catch service worker",t),oi.postMessage({type:e,payload:r})}}else console.warn(`Service Worker hasn't loaded yet. messageId: ${i}, type: ${e}`),console.info("ready",navigator.serviceWorker.ready),setTimeout((()=>{console.warn(`Re-Trying after certain time. messageId: ${i}, type: ${e}`),oi?(console.info("This is triggered "),null==oi||oi.postMessage({type:e,payload:t})):(console.log("not ready",e),clearInterval(c),s("Service worker not ready"))}),3e4);setTimeout((()=>{clearInterval(c),s(`No response from service worker after timeout: ${e}`),navigator.serviceWorker.removeEventListener("message",a)}),21e4)}else si.push({message:{type:e,payload:r}}),console.log("Message Queued",e,t),console.log(navigator.serviceWorker.controller,oi,e),"init"==e&&(clearInterval(c),n(null))}))}))}const pi={GetLinkListener:e=>ii(void 0,void 0,void 0,(function*(){const t=ci.find((t=>t.listenerId==e.listenerId));return null==t||t.callback(e.data),{success:!0}})),dispatchEvent:e=>ii(void 0,void 0,void 0,(function*(){if(oi){let t=new CustomEvent(e.id||"",e.data);dispatchEvent(t)}return{success:!0}})),checkInit:e=>ii(void 0,void 0,void 0,(function*(){return console.log("service worker init 0"),navigator.serviceWorker.controller&&(console.log("service worker init 1"),oi=navigator.serviceWorker.controller),yield mi(),{success:!0}}))};function fi(){return ii(this,void 0,void 0,(function*(){yield(0,po.A)();const e=(new Date).getTime();yield(0,i.A)().then((()=>{let t=(new Date).getTime()-e;console.log("The time taken to prepare concept  data is  ",t)})).catch((e=>{throw e})),yield(0,ho.Ay)().then((()=>{let t=(new Date).getTime()-e;console.log("The time taken to prepare local concept  ",t)})).catch((e=>{throw e})),yield(0,uo.p)().then((()=>{r.B.isLocalConnectionLoaded=!0})).catch((e=>{throw e})),yield(0,ho.xd)().catch((e=>{throw console.log("This is the error in populating binary tree"),e})),yield(0,uo.a)().then((()=>{r.B.isConnectionLoaded=!0,r.B.isConnectionTypeLoaded=!0;let t=(new Date).getTime()-e;console.log("The time taken to prepare connections  ",t)})).catch((e=>{throw e}))}))}function yi(e,t={}){if(oi||"undefined"!=typeof window){let n=new CustomEvent(`${e}`,t);dispatchEvent(n)}else fo.x.postMessage({type:"dispatchEvent",payload:{id:e,data:t}})}function vi(){return ii(this,void 0,void 0,(function*(){console.log("message queue",si);const e=si.find((e=>{var t;return"init"==(null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.type)}));if(e){console.log("Processing Init Queue poped",null==e?void 0:e.type,e);const t=si.indexOf(e);t>-1&&si.splice(t,1),yield hi(null==e?void 0:e.type,null==e?void 0:e.payload)}for(console.log("message queue while",si);si.length>0;){const{message:e,resolve:t,reject:n}=si.shift();console.log("Queue poped",e.type,e),yield hi(e.type,e.payload)}}))}const gi=e=>{if(e instanceof j.z)throw console.error("FreeSchemaResponse Error",e),e;console.error("Service Worker Error",e)};function mi(){return ii(this,void 0,void 0,(function*(){yield hi("init",{url:l.B.BASE_URL,aiurl:l.B.AI_URL,accessToken:yt.b.BearerAccessToken,nodeUrl:l.B.NODE_URL,enableAi:!1,applicationName:l.B.BASE_APPLICATION,flags:l.B.FLAGS})}))}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o=n(2830),i=n(9635),r=n(205),c=n(3278),s=n(5020),a=n(7887),l=n(7869),d=n(3075),u=n(2803),h=n(7139),p=n(5284),f=n(8939),y=n(6687),v=n(2013),g=n(1213),m=n(5328),C=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const T={GetConcept:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,h.r)(e.id)}})),GetTheConcept:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetTheConcept)(e.id,e.userId)}})),GetConceptBulk:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConceptBulk)(e.passedConcepts)}})),GetLink:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetLink)(e.id,e.linker,e.inpage,e.page)}})),GetRelation:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetRelation)(e.id,e.relation,e.inpage,e.page)}})),GetRelationRaw:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetRelationRaw)(e.id,e.relation,e.inpage,e.page)}})),GetComposition:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.Nj)(e.id)}})),GetCompositionList:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionList)(e.compositionName,e.userId,e.inpage,e.page)}})),GetCompositionListWithId:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionListWithId)(e.compositionName,e.userId,e.inpage,e.page)}})),GetCompositionById:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.hL)(e.id)}})),GetCompositionWithId:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.yz)(e.id)}})),GetCompositionListAllWithId:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionListAllWithId)(e.compositionName,e.userId,e.inpage,e.page)}})),GetConceptByCharacter:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConceptByCharacter)(e.characterValue)}})),GetConceptByCharacterUpdated:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,v.w)(e.characterValue)}})),GetConceptByCharacterAndType:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConceptByCharacterAndType)(e.characterValue,e.typeId)}})),GetCompositionFromConnectionsWithDataId:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,y.p8)(e.conceptIds,e.connectionIds)}})),GetCompositionFromConnectionsWithDataIdIndex:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,y.Nt)(e.conceptIds,e.connectionIds)}})),GetCompositionConnectionsBetweenTwoConcepts:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,u.x)(e.ofConceptId,e.toConcept,e.mainKey)}})),GetConnectionDataPrefetch:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,y.QL)(e.connectionIds)}})),GetCompositionWithIdFromMemory:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.RW)(e.id)}})),GetCompositionWithIdAndDateFromMemory:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.Ez)(e.id)}})),GetCompositionFromMemory:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.kx)(e.id)}})),GetCompositionFromMemoryNormal:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.XI)(e.id)}})),GetCompositionWithIdFromMemoryNew:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.$N)(e.id)}})),FindConnectionsOfCompositionsBulkInMemory:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,p.B)(e.composition_ids)}})),GetAllTheConnectionsByTypeAndOfTheConcept:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetAllTheConnectionsByTypeAndOfTheConcept)(e.id,e.linker,e.reverse)}})),GetCompositionFromMemoryWithConnections:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.JA)(e.id,e.connectionList)}})),GetCompositionFromConnectionsWithIndexFromConnections:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,y.hG)(e.conceptIds,e.connectionIds)}})),GetCompositionFromConnectionsWithDataIdFromConnections:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,y.km)(e.conceptIds,e.connectionIds)}})),GetTheConceptLocal:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,g.f)(e.id)}})),GetCompositionLocal:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionLocal)(e.id)}})),GetCompositionLocalWithId:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionLocalWithId)(e.id)}})),GetCompositionListLocal:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionListLocal)(e.compositionName,e.userId)}})),GetCompositionListLocalWithId:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionListLocalWithId)(e.compositionName,e.userId)}})),GetConceptByCharacterAndCategoryLocal:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConceptByCharacterAndCategoryLocal)(e.character)}})),ConceptsData__AddConcept:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConceptsData.AddConcept(e.concept)}})),ConceptsData__GetConcept:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConceptsData.GetConcept(e.id)}})),ConceptsData__GetConceptsByTypeIdAndUser:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConceptsData.GetConceptsByTypeIdAndUser(e.typeId,e.userId)}})),ConnectionData__GetConnectionByOfTheConceptAndType:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConnectionData.GetConnectionByOfTheConceptAndType(e.ofTheConceptId,e.typeId)}})),ConnectionData__GetConnection:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConnectionData.GetConnection(e.id)}})),ConnectionData__GetConnectionsOfCompositionLocal:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConnectionData.GetConnectionsOfCompositionLocal(e.id)}})),ConnectionData__GetConnectionsOfConcept:e=>C(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConnectionData.GetConnectionsOfConcept(e.id)}})),GetLinkListener:e=>C(void 0,void 0,void 0,(function*(){let t=!1;return new Promise(((n,o)=>{(0,m.d)(e.id,e.linker,e.inpage,e.page,e.format).subscribe((o=>{var r,c;t?(console.log("isSubscribed",t),n({success:!0,data:o}),t=!0):(console.log("is not isSubscribed",t),i.x.postMessage({type:"GetLinkListener",payload:{id:null===(r=null==e?void 0:e.listener)||void 0===r?void 0:r.listenerId,listenerId:null===(c=null==e?void 0:e.listener)||void 0===c?void 0:c.listenerId,data:o}}))})).catch((e=>{console.log("Error : ",e),o("Error Occured")}))}))}))};var I=n(7106),w=n(4310),k=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const N={SearchLinkMultipleAll:e=>k(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.SearchLinkMultipleAll)(e.searchQuery,e.token,e.caller,e.format)}})),RecursiveSearchApi:e=>k(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.RecursiveSearchApi)(e.composition,e.listLinkers,e.textSearch)}})),RecursiveSearchApiWithInternalConnections:e=>k(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.RecursiveSearchApiWithInternalConnections)(e.composition,e.listLinkers,e.textSearch)}})),RecursiveSearchApiRaw:e=>k(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.RecursiveSearchApiRaw)(e.composition,e.listLinkers,e.textSearch)}})),RecursiveSearchApiRawFullLinker:e=>k(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.RecursiveSearchApiRawFullLinker)(e.composition,e.fullLinkers,e.textSearch)}})),RecursiveSearchApiNewRawFullLinker:e=>k(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.RecursiveSearchApiNewRawFullLinker)(e.composition,e.fullLinkers,e.textSearch)}})),formatConnectionsDataId:e=>k(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,I.e$)(e.linkers,e.conceptIds,e.mainCompositionIds,e.reverse,e.countInfos,e.order)}})),formatConnectionsJustId:e=>k(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,I.y6)(e.linkers,e.conceptIds,e.mainCompositionIds,e.reverse,e.countInfos,e.order)}})),formatConnections:e=>k(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,I.b6)(e.linkers,e.conceptIds,e.mainCompositionIds,e.reverse,e.countInfos)}})),BuildWidgetFromId:e=>k(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,w.C)(e.id)}}))};var A=n(1218),L=n(3077),S=n(9975),G=n(5868),x=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const B={MakeTheInstanceConcept:e=>x(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.MakeTheInstanceConcept)(e.type,e.referent,e.composition,e.userId,e.passedAccessId,e.passedSessionId,e.referentId)}})),MakeTheConceptLocal:e=>x(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,S.A)(e.referent,e.typeCharacter,e.userId,e.categoryId,e.typeId,e.actions)}})),MakeTheTypeConcept:e=>x(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.MakeTheTypeConcept)(e.typeString,e.sessionId,e.sessionUserId,e.userId)}})),MakeTheTimestamp:e=>x(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.MakeTheTimestamp)(e.type,e.referent,e.userId,e.accessId,e.sessionInformationId)}})),CreateTheComposition:e=>x(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,A.A)(e.json,e.ofTheConceptId,e.ofTheConceptUserId,e.mainKey,e.userId,e.accessId,e.sessionInformationId)}})),MakeTheInstanceConceptLocal:e=>x(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,G.k)(e.type,e.referent,e.composition,e.userId,e.accessId,e.sessionInformationId,e.referentId,e.actions),actions:e.actions}})),MakeTheTypeConceptLocal:e=>x(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.MakeTheTypeConceptLocal)(e.typeString,e.sessionId,e.sessionUserId,e.userId,e.actions),actions:e.actions}})),CreateTheConceptLocal:e=>x(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,L.A)(e.referent,e.typecharacter,e.userId,e.categoryId,e.typeId,e.accessId,e.isComposition,e.referentId,e.actions),actions:e.actions}})),CreateTheCompositionLocal:e=>x(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.CreateTheCompositionLocal)(e.json,e.ofTheConceptId,e.ofTheConceptUserId,e.mainKey,e.userId,e.accessId,e.sessionInformationId,e.automaticSync,e.actions),actions:e.actions}}))};var R=n(3729),b=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const E={UpdateComposition:e=>b(void 0,void 0,void 0,(function*(){return yield(0,o.UpdateComposition)(e.patcherStructure),{success:!0}})),UpdateCompositionLocal:e=>b(void 0,void 0,void 0,(function*(){return yield(0,R.D)(e.patcherStructure,e.actions),{success:!0}}))};var U=n(8095),D=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const F={GetConnectionById:e=>D(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConnectionById)(e.id)}})),GetConnectionBulk:e=>D(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConnectionBulk)(e.connectionIds)}})),GetConnectionOfTheConcept:e=>D(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConnectionOfTheConcept)(e.typeId,e.ofTheConceptId,e.userId,e.inpage,e.page)}})),GetAllConnectionsOfCompositionBulk:e=>D(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetAllConnectionsOfCompositionBulk)(e.composition_ids)}})),GetConnectionBetweenTwoConceptsLinker:e=>D(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConnectionBetweenTwoConceptsLinker)(e.ofTheConcept,e.toTheConcept,e.linker,e.fullLinker,e.forward)}})),CreateConnectionBetweenTwoConcepts:e=>D(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.CreateConnectionBetweenTwoConcepts)(e.ofTheConcept,e.toTheConcept,e.linker,e.both)}})),CreateConnectionBetweenTwoConceptsLocal:e=>D(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,U.h)(e.ofTheConcept,e.toTheConcept,e.linker,e.both,e.actions),actions:e.actions}})),CreateTheConnectionLocal:e=>D(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.CreateTheConnectionLocal)(e.ofTheConceptId,e.toTheConceptId,e.typeId,e.orderId,e.typeString,e.userId,e.actions),actions:e.actions}}))};var _=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const W={DeleteConceptById:e=>_(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.DeleteConceptById)(e.id)}})),DeleteConnectionById:e=>_(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.DeleteConnectionById)(e.id)}})),DeleteUser:e=>_(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.DeleteUser)(e.id)}})),DeleteConnectionByType:e=>_(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.DeleteConnectionByType)(e.id,e.linker)}})),DeleteConceptLocal:e=>_(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.DeleteConceptLocal)(e.id)}}))};var O=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const V={SyncData__SyncDataOnline:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.SyncData.SyncDataOnline()}})),LocalSyncData__SyncDataOnline:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.LocalSyncData.SyncDataOnline(e.transactionId)}})),LocalSyncData__initializeTransaction:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.LocalSyncData.initializeTransaction(e.transactionId)}})),LocalSyncData__markTransactionActions:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.LocalSyncData.markTransactionActions(e.transactionId,e.actions),actions:e.actions}})),LocalSyncData__rollbackTransaction:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.LocalSyncData.rollbackTransaction(e.transactionId,e.actions),actions:e.actions}}))};var M=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};let P=!1,j=new Map,H=!1,$=[];const J=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({checkProcess:e=>M(void 0,void 0,void 0,(function*(){return(null==e?void 0:e.checkMessageId)&&$.includes(null==e?void 0:e.checkMessageId)?{success:!0,data:{processing:!0},name:"init"}:{success:!0,data:{processing:!1},name:"init"}})),init:e=>M(void 0,void 0,void 0,(function*(){return P?(console.warn("Already Initialized"),{success:!0,name:"init"}):(console.log("init has started"),P=!0,console.log("init has set value"),console.log("Payload log in service worker : ",e),yield function(){return M(this,arguments,void 0,(function*(e="",t="",n="",i="",u=!0,h="",p){var f,y;o.BaseUrl.BASE_URL=e,o.BaseUrl.AI_URL=t,o.BaseUrl.NODE_URL=i,o.BaseUrl.BASE_APPLICATION=h,c.b.BearerAccessToken=n;let v=Math.floor(1e8*Math.random());if(console.log("Flags came in init of service worker is ",p),o.BaseUrl.setRandomizer(v),o.BaseUrl.FLAGS=p,null===(f=o.BaseUrl.FLAGS)||void 0===f?void 0:f.isTest)return r.B.isDataLoaded=!0,r.B.isCharacterLoaded=!0,r.B.isTypeLoaded=!0,r.B.isLocalDataLoaded=!0,r.B.isLocalTypeLoaded=!0,r.B.isLocalCharacterLoaded=!0,r.B.isConnectionLoaded=!0,r.B.isConnectionTypeLoaded=!0,r.B.isLocalConnectionLoaded=!0,!0;console.log("This is the base url",o.BaseUrl.BASE_URL,v),console.log("service worker BaseUrl.FLAGS is ",o.BaseUrl.FLAGS),(null===(y=o.BaseUrl.FLAGS)||void 0===y?void 0:y.accessTracker)&&(console.log("From service worker, flag of Access Tracker."),o.AccessTracker.activateStatus=!0,console.log("Access Tracker Activation status from service worker",o.AccessTracker.activateStatus)),yield(0,l.A)();const g=(new Date).getTime();yield(0,s.A)().then((()=>{let e=(new Date).getTime()-g;console.log("The time taken to prepare concept  data is  ",e)})).catch((e=>{throw e})),yield(0,d.Ay)().then((()=>{let e=(new Date).getTime()-g;console.log("The time taken to prepare local concept  ",e)})).catch((e=>{throw e})),yield(0,a.p)().then((()=>{r.B.isLocalConnectionLoaded=!0})).catch((e=>{throw e})),yield(0,d.xd)(),yield(0,a.a)().then((()=>{r.B.isConnectionLoaded=!0,r.B.isConnectionTypeLoaded=!0;let e=(new Date).getTime()-g;console.log("The time taken to prepare connections  ",e)})).catch((e=>{throw e}))}))}(null==e?void 0:e.url,null==e?void 0:e.aiurl,null==e?void 0:e.accessToken,null==e?void 0:e.nodeUrl,null==e?void 0:e.enableAi,null==e?void 0:e.applicationName,null==e?void 0:e.flags),console.log("init has completed"),{success:!0,data:void 0,name:"init"})})),updateAccessToken:e=>M(void 0,void 0,void 0,(function*(){return yield(0,o.updateAccessToken)(e.accessToken,e.session),{success:!0,name:"updateAccessToken"}}))},T),N),B),E),F),W),V),z=()=>!!P||(i.x.postMessage({type:"checkInit",payload:{}}),!1);var q=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};self.addEventListener("install",(e=>{console.log("Service Worker installing... sw"),e.waitUntil(self.skipWaiting())})),self.addEventListener("activate",(e=>q(void 0,void 0,void 0,(function*(){yield(0,o.setHasActivatedSW)(!0),console.log("Service Worker activating... sw"),e.waitUntil(new Promise(((e,t)=>{try{self.clients.claim(),console.log("claimed"),z(),e(void 0)}catch(e){console.error("Error during service worker activation:",e),t(e)}})))})))),self.addEventListener("fetch",(e=>{e.clientId||e.respondWith(Q(e))})),self.addEventListener("message",(e=>{!function(e){M(this,void 0,void 0,(function*(){var t,n;let i={success:!1,data:void 0};const{type:r,payload:c}=e.data,s=c.TABID;let a=!1;try{if(!r||!c.TABID)return;$.push(c.messageId),"init"==r||z()||(console.warn("Message received before sw initialization",r,c.messageId),yield new Promise((e=>{console.log("is it stuck here???? type",r,c.messageId);const t=setInterval((()=>{console.log("Interval check 0",P,r,c.messageId),P?(console.log("Interval check 2",P,r,c.messageId),console.log(n,t),clearInterval(t),clearTimeout(n),e(void 0)):console.warn("Watring for init 1:",r)}),200),n=setTimeout((()=>{console.warn("Tried waiting for init but couldn't complete in time: ",r,c.messageId),clearInterval(t),e(void 0)}),9e4)})),console.log("After timeout promise",r,c.messageId,P),P||(console.log("wait failed",P,c.messageId,r),$=yield Promise.all($.filter((e=>e!=c.messageId))),e.source.postMessage(i)),console.log("After timeout promise nice",r,P)),j.has(s)||j.set(s,{concepts:[],connections:[]});let l=j.get(s);if(Array.isArray(null===(t=null==c?void 0:c.actions)||void 0===t?void 0:t.concepts)&&Array.isArray(null===(n=null==c?void 0:c.actions)||void 0===n?void 0:n.connections)||(c.actions={concepts:[],connections:[]},a=!0),"LocalSyncData__SyncDataOnline"==r&&!c.transactionId&&l){const e=o.LocalSyncData.SyncDataOnline(void 0,JSON.parse(JSON.stringify(l)));j.delete(s),l=void 0,console.log("Syncing the tab here",r),i={success:!0,data:yield e,actions:{concepts:[],connections:[]}}}else J[r]?i=yield J[r](c):console.warn(`Unable to handle "${r}" case in service worker`);if(i.messageId=c.messageId,H&&console.warn("Race condition has been met",r),H=!0,l=j.get(s),i.actions&&l){let e={concepts:[...l.concepts,...i.actions.concepts],connections:[...l.connections,...i.actions.connections]};const[t,n]=yield Promise.all([Promise.all(Array.from(new Map(e.concepts.map((e=>[`${e.id}-${e.ghostId}`,e]))).values())),Promise.all(Array.from(new Map(e.connections.map((e=>[`${e.id}-${e.ghostId}`,e]))).values()))]);j.set(s,JSON.parse(JSON.stringify({concepts:t,connections:n})))}H=!1,a&&delete i.actions,$=yield Promise.all($.filter((e=>e!=c.messageId))),e.source.postMessage(i)}catch(t){console.error("Service worker Message Handle Error: ",r,t),401!=(null==t?void 0:t.status)&&500!=(null==t?void 0:t.status)||(i={success:!1,data:{status:t.status,statusText:null==t?void 0:t.url},messageId:c.messageId}),$=yield Promise.all($.filter((e=>e!=c.messageId))),e.source.postMessage(i)}}))}(e)}));const Q=e=>q(void 0,void 0,void 0,(function*(){try{const t=yield fetch(e.request);if(401===t.status){const n=Math.random().toString(36).substring(2);return e.waitUntil(e.source.postMessage({type:"API_401",messageId:n,message:"Unauthorized",payload:{method:e.request.method,url:e.request.url,headers:Array.from(e.request.headers.entries()),body:yield e.request.clone().json()}})),yield new Promise((e=>{console.log("Re resolving 401",t.url),setTimeout((()=>e(t)),6e4),navigator.serviceWorker.addEventListener("message",(o=>{var i,r,c;o.data&&(null===(i=o.data)||void 0===i?void 0:i.messageId)==n&&"API_RESPONSE"===(null===(r=o.data)||void 0===r?void 0:r.type)&&((null===(c=null==o?void 0:o.data)||void 0===c?void 0:c.response)?e(o.data.response):(console.log("Unable to resolve re 401",t.url),e(t)))}))}))}return t}catch(e){throw console.error("Error occured during 401 intercepting",e),e}}));